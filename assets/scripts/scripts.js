"use strict";angular.module("zupPainelApp",["ui.router","restangular","ngCookies","ngAnimate","ngSanitize","ui.bootstrap","ui.autocomplete","ui.select2","ui.select","ui.mask","infinite-scroll","angularFileUpload","colorpicker.module","frapontillo.bootstrap-switch","ngStorage","ngRaven","monospaced.elastic","AuthServiceModule","UserServiceModule","FullResponseRestangularServiceModule","ErrorServiceModule","NavItemComponentModule","DetectScrollTopComponentModule","config","IndexModule","UserModule","ReportsModule","ItemsModule","ConfigModule","UsersModule","GroupsModule","HelpModule","FlowsModule","CasesModule"]),angular.module("ngLocale",[],["$provide",function(a){var b={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};a.value("$locale",{DATETIME_FORMATS:{AMPMS:["AM","PM"],DAY:["domingo","segunda-feira","terça-feira","quarta-feira","quinta-feira","sexta-feira","sábado"],MONTH:["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],SHORTDAY:["dom","seg","ter","qua","qui","sex","sáb"],SHORTMONTH:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],fullDate:"EEEE, d 'de' MMMM 'de' y",longDate:"d 'de' MMMM 'de' y",medium:"dd/MM/yyyy HH:mm:ss",mediumDate:"dd/MM/yyyy",mediumTime:"HH:mm:ss","short":"dd/MM/yy HH:mm",shortDate:"dd/MM/yy",shortTime:"HH:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"R$",DECIMAL_SEP:",",GROUP_SEP:".",PATTERNS:[{gSize:3,lgSize:3,macFrac:0,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,macFrac:0,maxFrac:2,minFrac:2,minInt:1,negPre:"(¤",negSuf:")",posPre:"¤",posSuf:""}]},id:"pt-br",pluralCat:function(a){return 1==a?b.ONE:b.OTHER}})}]),angular.module("zupPainelApp").config(["$urlRouterProvider","RestangularProvider","ENV","uiSelectConfig","$provide",function(a,b,c,d,e){a.otherwise("/"),b.setBaseUrl(c.apiEndpoint),b.setFullResponse(!0),d.theme="bootstrap",$.fn.bootstrapSwitch.defaults.onText="Sim",$.fn.bootstrapSwitch.defaults.offText="Não",e.decorator("ngModelDirective",["$delegate",function(a){var b=a[0],c=b.controller;return b.controller=["$scope","$element","$attrs","$injector",function(a,b,d,e){var f=e.get("$interpolate");d.$set("name",f(d.name||"")(a)),e.invoke(c,this,{$scope:a,$element:b,$attrs:d})}],a}]),e.decorator("formDirective",["$delegate",function(a){var b=a[0],c=b.controller;return b.controller=["$scope","$element","$attrs","$injector",function(a,b,d,e){var f=e.get("$interpolate");d.$set("name",f(d.name||d.ngForm||"")(a)),e.invoke(c,this,{$scope:a,$element:b,$attrs:d})}],a}])}]).run(["Restangular","Auth","$rootScope","$timeout","Error","$http","FullResponseRestangular","ENV",function(a,b,c,d,e,f,g,h){function i(a){var b=/^\)\]\}',?\n/;if("string"==typeof a){a=a.replace(b,"");try{a=JSON.parse(a)}catch(c){return a}}return a}a.setDefaultHeaders({"X-App-Token":b.getToken()}),g.setDefaultHeaders({"X-App-Token":b.getToken()}),c.flowsEnabled="true"===h.flowsEnabled||"TRUE"===h.flowsEnabled,c.mapDebugEnabled="true"===h.mapDebug||"TRUE"===h.mapDebug,a.addResponseInterceptor(function(a,b,c){if("undefined"!=typeof a[c])return a[c];for(var d in a)if("object"==typeof a[d])return a[d];for(var e in a)return a[e];return a}),f.defaults.transformResponse=[i],a.setErrorInterceptor(function(a){return("undefined"==typeof a.config.treatingErrors||a.config.treatingErrors===!1)&&e.show(a),!0}),c.$on("$stateChangeStart",function(a,b,d,e){0!==e.name.length&&(c.resolvingRoute=!0,c.uiHasScroll=!1,c.uiDebugMap=!1)}),c.$on("$stateChangeSuccess",function(a,b,e,f){0===f.name.length&&(c.hideInitialLoading=!0),d(function(){c.resolvingRoute=!1,c.resolvingRequest=!1},150)}),c.glyphicons={"exclamation-sign":"glyphicon-exclamation-sign",ok:"glyphicon-ok"},c.showMessage=function(a,b,e,f){c.systemMessage={icon:a,text:b,messageClass:e},c.showSystemMessage=!0,d(function(){c.showSystemMessage=!1},3500),f===!0&&(c.scrollTop=!0)},c.logoImg=h.logoImgUrl.length>0?h.logoImgUrl:"assets/images/logos/logo-zup.png"}]),angular.module("AuthServiceModule",[]).factory("Auth",["$q","Restangular","FullResponseRestangular","$cookies","$rootScope",function(a,b,c,d,e){var f=null;return{check:function(){var c=a.defer(),d=this.getToken();if(null!==d&&null===f){var e=b.one("me").get(),g=this;e.then(function(a){g.saveUser(a.data),c.resolve(f)},function(){c.reject(),g.clearToken()})}else null!==d&&null!==f?c.resolve(f):(c.reject(),this.clearToken());return c.promise},getToken:function(){var a=d.token;return"undefined"==typeof a?null:a},saveToken:function(a){d.token=a},clearToken:function(){delete d.token},clearUser:function(){f=null,e.user=null},saveUser:function(a){f=a},isLogged:function(){return null!==f&&null!==this.getToken()},login:function(d,e){c.setDefaultHeaders({"X-App-Token":this.getToken()});var f=a.defer(),g=c.one("authenticate").post(null,{email:d,password:e}),h=this;return g.then(function(a){h.saveUser(a.data.user),h.saveToken(a.data.token),b.setDefaultHeaders({"X-App-Token":a.data.token}),c.setDefaultHeaders({"X-App-Token":a.data.token}),f.resolve()},function(){f.reject()}),f.promise},logout:function(){this.clearToken()}}}]),angular.module("UserServiceModule",[]).service("User",["$q","Auth","$rootScope","$state",function(a,b,c,d){return function(e){e||(e={permissions:[]});var f=a.defer();return b.check().then(function(a){f.resolve(a),c.me=a,c.hasPermission=function(b,c){for(var d in a.permissions)if(d===b){if("boolean"==typeof a.permissions[d])return a.permissions[d]===!0;if("object"==typeof a.permissions[d]){if("undefined"==typeof c)return 0!==a.permissions[d].length;for(var e=a.permissions[d].length-1;e>=0;e--)if(c==a.permissions[d][e])return!0}}return!1},c.hasAnyPermission=function(a){for(var b=a.length-1;b>=0;b--)if(c.hasPermission(a[b]))return!0;return!1},c.hasPermission("panel_access")||d.go("user.unauthorized")},function(){f.resolve(null),-1!==e.permissions.indexOf("isLogged")&&d.go("user.login")}),f.promise}}]),angular.module("AdvancedFiltersServiceModule",["AdvancedFiltersQueryModalControllerModule","AdvancedFiltersCategoryModalControllerModule","AdvancedFiltersStatusModalControllerModule","AdvancedFiltersAuthorModalControllerModule","AdvancedFiltersPeriodModalControllerModule","AdvancedFiltersAreaModalControllerModule","AdvancedFiltersFieldsModalControllerModule","AdvancedFiltersShareModalControllerModule","ReportsCategoriesServiceModule","InventoriesCategoriesServiceModule"]).factory("AdvancedFilters",["$modal","Restangular","$q","$location","$rootScope","ReportsCategoriesService","InventoriesCategoriesService",function(a,b,c,d,e,f,g){var h=function(a){var b;return b="items"===a?g.loadedBasicInfo?_.values(g.categories):g.fetchAllBasicInfo():f.loadedBasicInfo?_.values(f.categories):f.fetchAllBasicInfo()};return{query:function(b){a.open({templateUrl:"modals/advanced-filters/query/advanced-filters-query.template.html",windowClass:"filterQueryModal",resolve:{activeAdvancedFilters:function(){return b}},controller:"AdvancedFiltersQueryModalController"})},category:function(b,c){e.resolvingRequest=!0,a.open({templateUrl:"modals/advanced-filters/category/advanced-filters-category.template.html",windowClass:"filterCategoriesModal",resolve:{categoriesResponse:function(){return h(c)},activeAdvancedFilters:function(){return b}},controller:"AdvancedFiltersCategoryModalController"})},status:function(b,c){e.resolvingRequest=!0,a.open({templateUrl:"modals/advanced-filters/status/advanced-filters-status.template.html",windowClass:"filterStatusesModal",resolve:{categoriesResponse:function(){return h(c)},activeAdvancedFilters:function(){return b}},controller:"AdvancedFiltersStatusModalController"})},author:function(b){a.open({templateUrl:"modals/advanced-filters/author/advanced-filters-author.template.html",windowClass:"filterAuthorModal",resolve:{activeAdvancedFilters:function(){return b}},controller:"AdvancedFiltersAuthorModalController"})},period:function(b){a.open({templateUrl:"modals/advanced-filters/period/advanced-filters-period.template.html",windowClass:"filterPeriodModal",resolve:{activeAdvancedFilters:function(){return b}},controller:"AdvancedFiltersPeriodModalController"})},area:function(b){return a.open({templateUrl:"modals/advanced-filters/area/advanced-filters-area.template.html",windowClass:"filterAreaModal",resolve:{activeAdvancedFilters:function(){return b}},controller:"AdvancedFiltersAreaModalController"})},fields:function(b){e.resolvingRequest=!0,a.open({templateUrl:"modals/advanced-filters/fields/advanced-filters-fields.template.html",windowClass:"fieldsCategoriesModal",resolve:{categoriesResponse:["Restangular",function(a){return a.one("inventory").all("categories").getList({display_type:"full"})}],activeAdvancedFilters:function(){return b}},controller:"AdvancedFiltersFieldsModalController"})},share:function(){a.open({templateUrl:"modals/advanced-filters/share/advanced-filters-share.template.html",windowClass:"shareModal",resolve:{url:function(){var a=c.defer(),b=gapi.client.urlshortener.url.insert({resource:{longUrl:d.absUrl()}});return b.execute(function(b){a.resolve(b.id)}),a.promise}},controller:"AdvancedFiltersShareModalController"})}}}]),angular.module("FullResponseRestangularServiceModule",[]).factory("FullResponseRestangular",["Restangular",function(a){return a.withConfig(function(a){a.setFullResponse(!0)})}]),angular.module("ErrorServiceModule",["ErrorModalControllerModule"]).factory("Error",["$modal",function(a){return{show:function(b){a.open({templateUrl:"modals/error/error.template.html",resolve:{response:function(){return b}},controller:"ErrorModalController"})}}}]),angular.module("ReportsCategoriesServiceModule",[]).factory("ReportsCategoriesService",["$rootScope","FullResponseRestangular",function(a,b){var c={};c.categories={},c.categoriesStatuses={},c.loadedBasicInfo=!1;var d=function(b){_.each(b.data.categories,function(a){_.each(a.subcategories,function(a){c.categories[a.id]=a}),c.categories[a.id]=a,_.each(a.statuses,function(a){c.categoriesStatuses[a.id]=a})}),a.$emit("reportsCategoriesFetched",c.categories)};return c.fetchAllBasicInfo=function(){var a=b.all("reports").all("categories"),e={};e.display_type="full",e.subcategories_flat=!0,e.return_fields=["id","title","statuses.id","statuses.color","statuses.title","marker.retina.web","pin"].join();var f=a.customGET(null,e);return f.then(function(a){c.loadedBasicInfo=!0,d(a)}),f},c}]),angular.module("ReportsItemsServiceModule",["ReportsCategoriesServiceModule"]).factory("ReportsItemsService",["$q","$rootScope","FullResponseRestangular","ReportsCategoriesService",function(a,b,c,d){var e={},f=0;e.reports={},e.total=0,e.clusters=[],e.resetCache=function(){e.reports={},e.clusters=[],e.total=0,f=0},e.resetItemsAndClusters=function(){f=0,e.reports={},e.clusters=[]},e.fetchAll=function(g){g=g||{};var i=c.one("search").all("reports").all("items");g.display_type="full",g.return_fields=["id","protocol","address","category_id","status_id","created_at","overdue","user.name","user.id"].join();var j=d.fetchAllBasicInfo(),k=i.customGET(null,g),l=a.defer();return b.$emit("reportsItemsFetching"),k.then(function(a){_.each(a.data.reports,function(a){"undefined"==typeof e.reports[a.id]&&(a.order=f++),e.reports[a.id]=a}),e.total=parseInt(a.headers().total,10),_.size(d.categories)<1?j.then(function(){h(),b.$emit("reportsItemsFetched",e.reports),l.resolve(e.reports)}):(h(),b.$emit("reportsItemsFetched",e.reports),l.resolve(e.reports))}),l.promise},e.fetchClustered=function(g){var j=c.one("search").all("reports").all("items");g.display_type="full",g.return_fields=["id","protocol","address","category_id","status_id","created_at","overdue","position","user.name","user.id"].join();var k=d.fetchAllBasicInfo(),l=j.customGET(null,g),m=a.defer();return b.$emit("reportsItemsFetching"),l.then(function(a){e.total=parseInt(a.headers().total,10),_.each(a.data.reports,function(a){"undefined"==typeof e.reports[a.id]&&(a.order=f++),e.reports[a.id]=a}),e.clusters=a.data.clusters,_.size(d.categories)<1?k.then(function(){i(),h(),b.$emit("reportsItemsFetched",e.reports),m.resolve(e)}):(i(),h(),b.$emit("reportsItemsFetched",e.reports),m.resolve(e))}),m.promise},e.remove=function(b){var d=c.one("reports").one("items",b).remove(),f=a.defer();return d.then(function(){delete e.reports[b],f.resolve()}),f.promise};var g=function(a){return _.each(a,function(a){a.category=d.categories[a.category_id],"undefined"==typeof a.category&&console.log("Report with unknown category",a),a.status=d.categoriesStatuses[a.status_id]})},h=function(){g(e.reports)},i=function(){g(e.clusters)};return e}]),angular.module("InventoriesCategoriesServiceModule",[]).factory("InventoriesCategoriesService",["$rootScope","FullResponseRestangular",function(a,b){var c={};c.categories={},c.categoriesStatuses={},c.loadedBasicInfo=!1;var d=function(b){_.each(b.data.categories,function(a){_.each(a.subcategories,function(a){c.categories[a.id]=a}),c.categories[a.id]=a,_.each(a.statuses,function(a){c.categoriesStatuses[a.id]=a})}),a.$emit("inventoriesCategoriesFetched",c.categories)};return c.fetchAllBasicInfo=function(){var a=b.all("inventory").all("categories"),e={};e.display_type="full",e.return_fields=["id","title","statuses.id","statuses.color","statuses.title","marker.retina.web","pin","plot_format","color"].join();var f=a.customGET(null,e);return f.then(function(a){c.loadedBasicInfo=!0,d(a)}),f},c}]),angular.module("InventoriesItemsServiceModule",["InventoriesCategoriesServiceModule"]).factory("InventoriesItemsService",["$q","$rootScope","FullResponseRestangular","InventoriesCategoriesService",function(a,b,c,d){var e={},f=0;e.items={},e.total=0,e.clusters=[],e.resetCache=function(){e.items={},e.clusters=[],e.total=0,f=0},e.resetItemsAndClusters=function(){f=0,e.items={},e.clusters=[]},e.fetchAll=function(g){g=g||{};var i=c.one("search").all("inventory").all("items");g.display_type="full",g.return_fields=["id","title","address","created_at","updated_at","inventory_status_id","inventory_category_id","user.name","user.id"].join();var j=d.fetchAllBasicInfo(),k=i.customGET(null,g),l=a.defer();return b.$emit("inventoriesItemsFetching"),k.then(function(a){_.each(a.data.items,function(a){"undefined"==typeof e.items[a.id]&&(a.order=f++),e.items[a.id]=a}),e.total=parseInt(a.headers().total,10),_.size(d.categories)<1?j.then(function(){h(),b.$emit("inventoriesItemsFetched",e.items),l.resolve(e.items)}):(h(),b.$emit("inventoriesItemsFetched",e.items),l.resolve(e.items))}),l.promise},e.fetchClustered=function(g){var j=c.one("search").all("inventory").all("items");g.return_fields=["id","title","address","created_at","updated_at","inventory_status_id","position","inventory_category_id","user.name","user.id"].join();var k=d.fetchAllBasicInfo(),l=j.customGET(null,g),m=a.defer();return b.$emit("inventoriesItemsFetching"),l.then(function(a){e.total=parseInt(a.headers().total,10),_.each(a.data.items,function(a){"undefined"==typeof e.items[a.id]&&(a.order=f++),e.items[a.id]=a}),e.clusters=a.data.clusters,_.size(d.categories)<1?k.then(function(){i(),h(),b.$emit("inventoriesItemsFetched",e.items),m.resolve(e)}):(i(),h(),b.$emit("inventoriesItemsFetched",e.items),m.resolve(e))}),m.promise},e.remove=function(b,d){var f=c.one("inventory").one("categories",d).one("items",b).remove(),g=a.defer();return f.then(function(){delete e.items[b],g.resolve()}),g.promise};var g=function(a){return _.each(a,function(a){a.category=d.categories[a.inventory_category_id]||d.categories[a.category_id],"undefined"==typeof a.category&&console.log("Report with unknown category",a),a.status=d.categoriesStatuses[a.inventory_status_id]})},h=function(){g(e.items)},i=function(){g(e.clusters)};return e}]),angular.module("GoogleMapServiceModule",[]).factory("GoogleMapService",["ENV","$compile","$rootScope",function(a,b,c){var d={styles:[{},{featureType:"poi.business",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.government",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.medical",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.school",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.sports_complex",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"off"},{saturation:-100},{lightness:42}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{saturation:-100},{lightness:47}]},{featureType:"landscape",stylers:[{lightness:82},{saturation:-100}]},{featureType:"water",stylers:[{hue:"#00b2ff"},{saturation:-21},{lightness:-4}]},{featureType:"poi",stylers:[{lightness:19},{weight:.1},{saturation:-22}]},{elementType:"geometry.fill",stylers:[{visibility:"on"},{lightness:18}]},{elementType:"labels.text",stylers:[{saturation:-100},{lightness:28}]},{featureType:"poi.attraction",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{saturation:12},{lightness:25}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.text",stylers:[{lightness:30}]},{featureType:"landscape.man_made",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{saturation:-100},{lightness:56}]},{featureType:"road.local",elementType:"geometry.fill",stylers:[{lightness:62}]},{featureType:"landscape.man_made",elementType:"geometry",stylers:[{visibility:"off"}]}],map:{zoom:null,mapTypeControl:!1,panControl:!0,panControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT},zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT},scaleControl:!0,scaleControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT},streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT}}},e=function(a,b,c,e,f){d.map.zoom=e;var g=new google.maps.LatLng(b,c),h=new google.maps.StyledMapType(d.styles,{name:"zup"});this.itemsAreReports=a,this.map=new google.maps.Map(f,d.map),this.map.mapTypes.set("zup",h),this.map.setMapTypeId("zup"),this.map.setCenter(g),this.currentMarkers={},this.infoWindow=new google.maps.InfoWindow,this.activeFilterAreas=[]};e.prototype.getDistance=function(){var a=this.map.getBounds(),b=a.getCenter(),c=a.getNorthEast();return google.maps.geometry.spherical.computeDistanceBetween(b,c)},e.prototype.clearMarkers=function(){_.each(this.currentMarkers,function(a){a.setMap(null)}),this.currentMarkers={}},e.prototype.createMarker=function(a,b,c,d,e){var f;if(_.isNull(b))f='<div class="marker">';else{var g=b.isPin?"pin":"";f='<div class="marker '+g+'" style="background-image: url('+b.url+')">'}d&&(f+='<span style="background-color: '+c+';">'+d+"</span>"),f+="</div>";var h=new RichMarker({position:a,map:this.map,draggable:!1,shadow:!1,content:f,extraData:e,isReport:this.itemsAreReports,infoWindow:this.infoWindow});return _.isUndefined(e)||google.maps.event.addListener(h,"click",this.displayInfoWindow),h},e.prototype.displayInfoWindow=function(){var a;a=this.isReport?'<div class="pinTooltip"><h1>{{ item.category.title }}</h1><p>Enviado em {{ item.created_at | date: \'dd/MM/yy HH:mm\'}}</p><a href="#/reports/{{ item.id }}">Ver detalhes</a></div>':'<div class="pinTooltip"><h1>{{ item.title }}</h1><p>Criado em {{ item.created_at | date: \'dd/MM/yy HH:mm\'}}</p><a href="#/items/{{ item.id }}">Ver detalhes</a></div>';var d=c.$new(!0);d.category=this.extraData.category,d.item=this.extraData.item;var e=b(a)(d);d.$apply(),this.infoWindow.setContent(e[0]),this.infoWindow.open(this.map,this)},e.prototype.createClusterMarker=function(a){var b=new google.maps.LatLng(a.position[0],a.position[1]);return this.createMarker(b,null,a.category.color,a.count)},e.prototype.createItemMarker=function(a){var b={};this.itemsAreReports||"pin"!==a.category.plot_format?(b.url=a.category.marker.retina.web,b.isPin=!1):(b.url=a.category.pin.retina.web,b.isPin=!0);var c=new google.maps.LatLng(a.position.latitude,a.position.longitude),d=this.createMarker(c,b,!1,!1,{category:a.category,item:a});return d},e.prototype.processMarkers=function(a,b){var c={},d=this;_.each(a,function(a){if(_.isUndefined(a.category)||!a.category)return!1;var b=a.position[0].toString()+a.position[1]+a.count+a.category_id;d.currentMarkers[b]?(c[b]=d.currentMarkers[b],delete d.currentMarkers[b]):(c[b]=d.createClusterMarker(a),c[b].setMap(d.map),c[b].setVisible(!0))}),_.each(b,function(a){d.currentMarkers[a.id]?(c[a.id]=d.currentMarkers[a.id],delete d.currentMarkers[a.id]):(c[a.id]=d.createItemMarker(a),c[a.id].setMap(d.map),c[a.id].setVisible(!0))}),_.each(this.currentMarkers,function(a){a.setMap(null)}),this.currentMarkers=c},e.prototype.isMarkerInsideBounds=function(a){return this.map.getBounds().contains(a.getPosition())},e.prototype.hideOutOfBoundsMarkers=function(){var a=this;_.each(this.currentMarkers,function(b){b.setVisible(a.isMarkerInsideBounds(b)?!0:!1)})},e.prototype.getMap=function(){return this.map},e.prototype.getZoom=function(){return this.map.getZoom()},e.prototype.getCenter=function(){return this.map.getCenter()},e.prototype.createCircle=function(a,b,c){var d={fillColor:"#6FCCEF",map:this.map,center:a,radius:b,originalDistance:b,strokeWeight:0,zIndex:1};c&&(d.fillColor="#37A6CF",d.strokeWeight=1,d.strokeColor="#37A6CF",d.zIndex=1);var e=new google.maps.Circle(d);return e},e.prototype.clearCircles=function(){for(var a=this.activeFilterAreas.length-1;a>=0;a--)this.activeFilterAreas[a].inner.setMap(null),this.activeFilterAreas[a].outer.setMap(null);this.activeFilterAreas[a]=[]};var f=function(a,b){var c=Math.pow(2,21-b.getZoom());return a+1128.49722*c*.0027};return e.prototype.processAreaFilters=function(a){this.clearCircles();for(var b=a.length-1;b>=0;b--){var c=a[b],d=new google.maps.LatLng(c.latitude,c.longitude),e=this.createCircle(d,c.distance,!0),g=this.createCircle(d,f(c.distance,this));this.activeFilterAreas.push({inner:e,outer:g})}},e.prototype.changeFilterOuterCircles=function(){for(var a=this.activeFilterAreas.length-1;a>=0;a--){var b=f(this.activeFilterAreas[a].outer.originalDistance,this);console.log("original -> ",this.activeFilterAreas[a].outer.originalDistance," new radius -> ",b,"zoom -> ",this.getZoom()),this.activeFilterAreas[a].outer.set("radius",b)}},e}]),angular.module("UserModule",["UserLoginModule","UserLogoutModule","UserUnauthorizedModule"]).config(["$stateProvider",function(a){a.state("user",{"abstract":!0,url:"/user",template:""})}]),angular.module("UserLoginModule",["UserLoginControllerModule"]).config(["$stateProvider",function(a){a.state("user.login",{url:"/login",views:{"@":{templateUrl:"routes/user/login/user-login.template.html",controller:"UserLoginController",controllerAs:"ctrl"}}})}]),angular.module("UserLoginControllerModule",["UserPasswordRecoverModalControllerModule"]).controller("UserLoginController",["$scope","$rootScope","$state","Auth","$modal",function(a,b,c,d,e){var f=a.logoImg;a.blueLogoImg=f.substring(0,f.lastIndexOf("."))+"-blue"+f.substring(f.lastIndexOf(".")),a.login=function(){return a.loginError=!1,a.processingRequest=!0,d.login(a.email,a.password).then(function(){c.go("reports.list")},function(){a.loginError=!0,a.processingRequest=!1}),!1},a.recoverPassword=function(){e.open({templateUrl:"modals/user/password-recovery/user-password-recovery.template.html",windowClass:"removeModal",controller:"UserPasswordRecoveryModalController"})}}]),angular.module("UserLogoutModule",["UserLogoutControllerModule"]).config(["$stateProvider",function(a){a.state("user.logout",{url:"/logout",views:{"@":{template:"",controller:"UserLogoutController",controllerAs:"ctrl"}}})}]),angular.module("UserLogoutControllerModule",[]).controller("UserLogoutController",["$state","Auth",function(a,b){b.logout(),a.go("user.login")}]),angular.module("UserUnauthorizedModule",["UserUnauthorizedControllerModule"]).config(["$stateProvider",function(a){a.state("user.unauthorized",{url:"/unauthorized",views:{"@":{templateUrl:"routes/user/unauthorized/user-unauthorized.template.html",controller:"UserUnauthorizedController",controllerAs:"ctrl"}}})}]),angular.module("UserUnauthorizedControllerModule",[]).controller("UserUnauthorizedController",["$rootScope","Auth",function(a,b){!_.isUndefined(a.hasPermission)&&a.hasPermission("panel_access")&&$state.go("/"),b.clearToken(),b.clearUser()}]),angular.module("IndexModule",["IndexControllerModule"]).config(["$stateProvider",function(a){a.state("home",{url:"/",template:"",resolve:{User:["User",function(a){return a()}]},controller:"IndexController"})}]),angular.module("IndexControllerModule",[]).controller("IndexController",["User","$state","$rootScope",function(a,b,c){b.go(a?c.hasAnyPermission(["inventories_full_access","inventories_categories_edit","inventories_items_read_only","inventories_items_delete","inventories_items_edit","inventories_items_create"])?"items.list":"reports.list":"user.login")}]),angular.module("ReportsModule",["ReportsIndexModule","ReportsShowModule","ReportsAddModule","ReportsCategoriesIndexModule","ReportsCategoriesEditModule"]).config(["$stateProvider",function(a){a.state("reports",{"abstract":!0,url:"/reports",templateUrl:"routes/reports/reports.template.html",resolve:{User:["User",function(a){return a({permissions:["isLogged"]})}]}})}]),angular.module("ReportsIndexModule",["ReportsIndexControllerModule","ReportsIndexMapModule","StyleResultsTableComponentModule"]).config(["$stateProvider",function(a){a.state("reports.list",{url:"",views:{"":{templateUrl:"routes/reports/index/reports-index.template.html",controller:"ReportsIndexController",controllerAs:"ctrl",resolve:{isMap:function(){return!1}}}}})}]),angular.module("ReportsIndexControllerModule",["ReportsDestroyModalControllerModule","OnFocusComponentModule","OnBlurComponentModule","AdvancedFiltersServiceModule","ReportsItemsServiceModule","angular-toArrayFilter"]).controller("ReportsIndexController",["$rootScope","$scope","Restangular","$modal","$q","isMap","AdvancedFilters","$location","$window","$cookies","ReportsItemsService",function(a,b,c,d,e,f,g,h,i,j,k){b.loading=!0,a.uiHasScroll=!0,a.hasMap=f;var l=1,m=15;b.loadingPagination=!1,b.filtersHash=null,b.categories={},b.categoriesStatuses={},b.total=0;var n=function(){b.selectedCategories=[],b.selectedStatuses=[],b.selectedUsers=[],b.beginDate=null,b.endDate=null,b.searchText=null,b.overdueOnly=null,b.assignedToMyGroup=null,b.assignedToMe=null,b.position=null,b.selectedAreas=[],b.zoom=null,b.clusterize=null};n(),b.sort={column:"created_at",descending:!0},b.changeSorting=function(a){var c=b.sort;c.column===a?c.descending=!c.descending:(c.column=a,c.descending=!1),k.resetCache(),b.reload()},b.selectedCls=function(a){return a===b.sort.column&&"sort-"+b.sort.descending},b.availableFilters=[{name:"Protocolo ou endereço contém...",action:"query"},{name:"Com as categorias...",action:"category"},{name:"Com os estados...",action:"status"},{name:"Criado pelos munícipes...",action:"author"},{name:"Por período...",action:"date"},{name:"Por perímetro...",action:"area"},{name:"Apenas relatos atrasados...",action:"overdueOnly"},{name:"Associados ao meu grupo...",action:"assignedToMyGroup"},{name:"Associados à mim...",action:"assignedToMe"}],b.activeAdvancedFilters=[],"undefined"!=typeof j.reportsFiltersHash&&(b.activeAdvancedFilters=JSON.parse(i.atob(j.reportsFiltersHash))),"undefined"!=typeof h.search().filters&&(b.filtersHash=h.search().filters,b.activeAdvancedFilters=JSON.parse(i.atob(b.filtersHash)));var o=function(a,b){-1===a.indexOf(b)&&a.push(b)};b.$watch("activeAdvancedFilters",function(){n(),0!==b.activeAdvancedFilters.length?(b.filtersHash=i.btoa(JSON.stringify(b.activeAdvancedFilters)),h.search("filters",b.filtersHash),j.reportsFiltersHash=b.filtersHash):(b.filtersHash=null,h.search("filters",null),delete j.reportsFiltersHash);for(var a=b.activeAdvancedFilters.length-1;a>=0;a--){var c=b.activeAdvancedFilters[a];"query"===c.type&&(b.searchText=c.value),"categories"===c.type&&o(b.selectedCategories,c.value),"statuses"===c.type&&o(b.selectedStatuses,c.value),"authors"===c.type&&o(b.selectedUsers,c.value),"beginDate"===c.type&&(b.beginDate=c.value),"endDate"===c.type&&(b.endDate=c.value),"area"===c.type&&o(b.selectedAreas,c.value),"overdueOnly"===c.type&&(b.overdueOnly=!0),"assignedToMyGroup"===c.type&&(b.assignedToMyGroup=!0),"assignedToMe"===c.type&&(b.assignedToMe=!0)}q()},!0),b.generateReportsFetchingOptions=function(){var a={};if(b.position||(a.page=l,a.per_page=m),null!==b.searchText&&(a.query=b.searchText),0!==b.selectedCategories.length&&(a.reports_categories_ids=b.selectedCategories.join()),0!==b.selectedStatuses.length&&(a.statuses_ids=b.selectedStatuses.join()),0!==b.selectedUsers.length&&(a.users_ids=b.selectedUsers.join()),null!==b.beginDate&&(a.begin_date=b.beginDate),null!==b.endDate&&(a.end_date=b.endDate),""!==b.sort.column&&(a.sort=b.sort.column,a.order=b.sort.descending?"desc":"asc"),0===b.selectedAreas.length&&null!==b.position)a["position[latitude]"]=b.position.latitude,a["position[longitude]"]=b.position.longitude,a["position[distance]"]=b.position.distance;else if(0!==b.selectedAreas.length)for(var c=b.selectedAreas.length-1;c>=0;c--){var d="position["+c+"][latitude]",e="position["+c+"][longitude]",f="position["+c+"][distance]";a[d]=b.selectedAreas[c].latitude,a[e]=b.selectedAreas[c].longitude,a[f]=b.selectedAreas[c].distance}return null!==b.zoom&&(a.zoom=b.zoom),null!==b.clusterize&&(a.clusterize=!0),null!==b.overdueOnly&&(a.overdue=b.overdueOnly),null!==b.assignedToMyGroup&&(a.assigned_to_my_group=b.assignedToMyGroup),null!==b.assignedToMe&&(a.assigned_to_me=b.assignedToMe),a};var p=b.getData=function(a,c){if(b.loadingPagination===!1){b.loadingPagination=!0,"undefined"!=typeof c&&(b.position=c.position,b.zoom=c.zoom,b.clusterize=c.clusterize);var d=k.fetchAll(b.generateReportsFetchingOptions());return d.then(function(a){l++,b.reports=a;var c=Math.ceil(b.total/m);b.loadingPagination=l===c+1?null:!1,b.loading=!1}),d}};a.$on("reportsItemsFetching",function(){f&&(b.loading=!0)}),a.$on("reportsItemsFetched",function(){b.total=k.total,b.loading=!1});var q=b.reload=function(a){f?b.$broadcast("mapRefreshRequested",!0):(k.resetCache(),l=1,b.loadingPagination=!1,a===!0&&(b.reloading=!0),b.loadingContent=!0,b.reports=[],p().then(function(c){b.loadingContent=!1,b.reports=c,a===!0&&(b.reloading=!1)}))};b.reloadMap=function(){a.$emit("mapRefreshRequested")},b.removeFilter=function(a){b.activeAdvancedFilters.splice(b.activeAdvancedFilters.indexOf(a),1)},b.resetFilters=function(){b.activeAdvancedFilters=[],f&&b.$broadcast("mapRefreshRequested",!0)},b.loadFilter=function(a){if("query"===a&&g.query(b.activeAdvancedFilters),"category"===a&&g.category(b.activeAdvancedFilters,"reports"),"status"===a&&g.status(b.activeAdvancedFilters,"reports"),"author"===a&&g.author(b.activeAdvancedFilters),"date"===a&&g.period(b.activeAdvancedFilters),"area"===a&&g.area(b.activeAdvancedFilters),"overdueOnly"===a){var c={title:"Atraso",type:"overdueOnly",desc:"Apenas relatos atrasados"};b.activeAdvancedFilters.push(c)}if("assignedToMyGroup"===a){var c={title:"Relatos associados",type:"assignedToMyGroup",desc:"Ao meu grupo"};b.activeAdvancedFilters.push(c)}if("assignedToMe"===a){var c={title:"Atraso",type:"assignedToMe",desc:"À mim"};b.activeAdvancedFilters.push(c)}},b.search=function(a){b.searchText=a,q()},b.share=function(){g.share()},b.changeToMap=function(){h.url(null!==b.filtersHash?"/reports/map?filters="+b.filtersHash:"/reports/map")},b.changeToList=function(){h.url(null!==b.filtersHash?"/reports?filters="+b.filtersHash:"/reports")},b.deleteReport=function(a){d.open({templateUrl:"modals/reports/destroy/reports-destroy.template.html",windowClass:"removeModal",resolve:{removeReportFromList:function(){return function(a){b.total--,b.reports.splice(b.reports.indexOf(a),1)}},report:function(){return a}},controller:"ReportsDestroyModalController"})},b.editReportStatus=function(a,b){d.open({
templateUrl:"modals/reports/edit-status/reports-edit-status.template.html",windowClass:"editStatusModal",resolve:{report:function(){return a},category:function(){return b}},controller:"ReportsEditStatusModalController"})}}]),angular.module("ReportsIndexMapModule",["StyleMapComponentModule","MapComponentModule"]).config(["$stateProvider",function(a){a.state("reports.list.map",{url:"/map",views:{"@reports":{templateUrl:"routes/reports/index/map/reports-index-map.template.html",controller:"ReportsIndexController",controllerAs:"ctrl",resolve:{isMap:function(){return!0}}}}})}]),angular.module("ReportsShowModule",["ReportsShowControllerModule"]).config(["$stateProvider",function(a){a.state("reports.show",{url:"/{id:[0-9]{1,9}}",resolve:{reportResponse:["Restangular","$stateParams",function(a,b){return a.one("reports").one("items",b.id).get()}],feedbackResponse:["Restangular","$stateParams",function(a,b){return a.one("reports",b.id).one("feedback").get()}],categoriesResponse:["Restangular","$stateParams",function(a){return a.one("reports").all("categories").getList({display_type:"full"})}],commentsResponse:["Restangular","$stateParams",function(a,b){return a.one("reports",b.id).all("comments").getList()}],reportHistoryResponse:["Restangular","$stateParams",function(a,b){return a.one("reports").one("items",b.id).one("history").getList()}]},views:{"":{templateUrl:"routes/reports/show/reports-show.template.html",controller:"ReportsShowController",controllerAs:"ctrl"}}})}]),angular.module("ReportsShowControllerModule",["MapShowReportComponentModule","ReportsEditStatusModalControllerModule","ReportsEditDescriptionModalControllerModule","ReportsEditCategoryModalControllerModule","ReportsSelectAddressModalControllerModule","ReportsForwardModalControllerModule","ReportsSelectUserModalControllerModule","duScroll"]).value("duScrollOffset",200).controller("ReportsShowController",["$scope","Restangular","$q","$modal","reportResponse","feedbackResponse","categoriesResponse","commentsResponse","$rootScope","reportHistoryResponse",function(a,b,c,d,e,f,g,h,i,j){a.report=e.data,a.report.status_id=a.report.status.id,a.feedback=f.data,a.comments=h.data;var k=g.data,l=function(){for(var b=k.length-1;b>=0;b--){if(k[b].id===a.report.category.id)return a.category=k[b];if(0!==k[b].subcategories.length)for(var c=k[b].subcategories.length-1;c>=0;c--)if(k[b].subcategories[c].id===a.report.category.id)return a.category=k[b].subcategories[c]}};l(),a.images=[];for(var m=a.report.images.length-1;m>=0;m--)a.images.push({versions:a.report.images[m]});a.newUserResponse={message:null,privateComment:!1,typing:!1},a.newSystemComment={message:null,typing:!1},a.filterByUserMessages=function(a){return 0===a.visibility||1===a.visibility};var n=function(c,d){return b.one("reports",a.report.id).customPOST({message:c,visibility:d},"comments")};a.submitUserResponse=function(){a.processingComment=!0;var b=0;a.newUserResponse.privateComment&&(b=1);var c=n(a.newUserResponse.message,b);c.then(function(b){a.newUserResponse.message=null,a.processingComment=!1,a.comments.push(b.data)})},a.submitSystemComment=function(){a.processingSystemComment=!0;var b=n(a.newSystemComment.message,2);b.then(function(b){a.processingSystemComment=!1,a.newSystemComment.message=null,a.comments.push(b.data)})},a.editCategory=function(){i.resolvingRequest=!0,d.open({templateUrl:"modals/reports/edit-category/reports-edit-category.template.html",windowClass:"report-edit-category-modal",resolve:{report:function(){return a.report},category:function(){return a.category},categories:function(){return b.all("reports").all("categories").getList({display_type:"full"})}},controller:"ReportsEditCategoryModalController"})},a.editReportStatus=function(a,b){d.open({templateUrl:"modals/reports/edit-status/reports-edit-status.template.html",windowClass:"editStatusModal",resolve:{report:function(){return a},category:function(){return b}},controller:"ReportsEditStatusModalController"})},a.editAddress=function(){var b=d.open({templateUrl:"modals/reports/select-address/reports-select-address.template.html",windowClass:"mapModal",resolve:{category:function(){return a.category},report:function(){return a.report}},controller:"ReportsSelectAddressModalController"});b.opened.then(function(){setTimeout(function(){i.selectLatLngMap.start()},80)})},a.editDescription=function(){d.open({templateUrl:"modals/reports/edit-description/reports-edit-description.template.html",windowClass:"editReportModal",resolve:{report:function(){return a.report}},controller:"ReportsEditDescriptionModalController"})},a.forwardReport=function(){i.resolvingRequest=!0,d.open({templateUrl:"modals/reports/forward/reports-forward.template.html",windowClass:"reports-forward-modal",resolve:{report:function(){return a.report},category:function(){return a.category},groupsResponse:function(){return b.all("groups").getList()}},controller:"ReportsForwardModalController"})},a.assignReport=function(){d.open({templateUrl:"modals/reports/select-user/reports-select-user.template.html",windowClass:"modal-reports-select-user",resolve:{setUser:["Restangular","$state","$rootScope",function(b,c,d){return function(e){d.resolvingRequest=!0;var f=b.one("reports",a.category.id).one("items",a.report.id).one("assign").customPUT({user_id:e.id});f.then(function(){d.resolvingRequest=!1,a.showMessage("ok","O usuário responsável foi alterado com sucesso.","success",!0),c.go(c.current,{},{reload:!0})})}}],filterByGroup:function(){return a.report.assigned_group.id}},controller:"ReportsSelectUserModalController"})},a.refreshHistory=function(){var c={},d=a.selectedFilters();0!==d.length&&(c.kind=d.join()),a.historyFilterBeginDate&&(c["created_at[begin]"]=a.historyFilterBeginDate),a.historyFilterEndDate&&(c["created_at[end]"]=a.historyFilterEndDate),a.loadingHistoryLogs=!0;var e=b.one("reports").one("items",a.report.id).one("history").getList(null,c);e.then(function(b){a.historyLogs=b.data,a.loadingHistoryLogs=!1})},a.historyOptions={type:void 0},a.availableHistoryFilters=[{type:"category",name:"Categoria",selected:!0},{type:"status",name:"Estados",selected:!0}],a.availableHistoryDateFilters=[{name:"Hoje",beginDate:moment().startOf("day").format(),endDate:moment().endOf("day").format(),selected:!1},{name:"Ontem",beginDate:moment().subtract(1,"days").startOf("day").format(),endDate:moment().subtract(1,"days").endOf("day").format(),selected:!1},{name:"Este mês",beginDate:moment().startOf("month").format(),endDate:moment().subtract(1,"days").endOf("day").format(),selected:!1},{name:"Mês passado",beginDate:moment().subtract(1,"months").startOf("month").format(),endDate:moment().subtract(1,"months").subtract(1,"days").endOf("day").format(),selected:!1},{name:"Todos",beginDate:null,endDate:null,selected:!0}],a.selectedFilters=function(){var b=[];return _.each(a.availableHistoryFilters,function(a){a.selected&&b.push(a.type)}),b},a.toggleOption=function(b){b.selected=!b.selected,a.refreshHistory()},a.resetHistoryFilters=function(){_.each(a.availableHistoryFilters,function(a){a.selected=!0}),a.refreshHistory()},a.showCustomDateFields=function(){_.each(a.availableHistoryDateFilters,function(a){a.selected=!1}),a.showCustomDateHelper=!0},a.selectDateFilter=function(b){_.each(a.availableHistoryDateFilters,function(a){a.selected=!1}),b.selected=!b.selected,a.historyFilterBeginDate=b.beginDate,a.historyFilterEndDate=b.endDate,a.showCustomDateHelper=!1,a.refreshHistory()},a.historyLogs=j.data}]),angular.module("ReportsAddModule",["ReportsAddControllerModule"]).config(["$stateProvider",function(a){a.state("reports.add",{url:"/add",views:{"":{templateUrl:"routes/reports/add/reports-add.template.html",controller:"ReportsAddController",controllerAs:"ctrl",resolve:{inventoriesCategoriesResponse:["Restangular","$stateParams",function(a){return a.all("inventory").all("categories").getList({display_type:"full",return_fields:["id","title","pin","marker"].join()})}],reportCategoriesResponse:["Restangular","$stateParams",function(a){return a.all("reports").all("categories").getList({display_type:"full",subcategories_flat:!0})}]}}}})}]),angular.module("ReportsAddControllerModule",["ReportsSelectUserModalControllerModule","ReportsCreateUserModalControllerModule","ReportSearchMapComponentModule","MapNewReportComponentModule","NgThumbComponentModule"]).controller("ReportsAddController",["$scope","$rootScope","Restangular","$q","$modal","$state","FileUploader","reportCategoriesResponse","inventoriesCategoriesResponse",function(a,b,c,d,e,f,g,h,i){var j=h.data;a.categories=j,a.subCategories=function(a){return null==a.parent_id?"Categorias principais":null!==a.parent_id?"Subcategorias":void 0},a.inventoryCategories=i.data,a.uploader=new g,a.selectedCategory=null,a.uploader.filters.push({name:"onlyImages",fn:function(b){var c=a.uploader.isHTML5?b.type:"/"+b.value.slice(b.value.lastIndexOf(".")+1);return c="|"+c.toLowerCase().slice(c.lastIndexOf("/")+1)+"|",-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(c)}}),a.getInventoryCategory=function(b){for(var c=a.inventoryCategories.length-1;c>=0;c--)if(a.inventoryCategories[c].id===b)return a.inventoryCategories[c];return null},a.$watch("selectedCategory",function(b,c){if(b!==c)for(var d=a.categories.length-1;d>=0;d--){if(a.categories[d].id===parseInt(a.selectedCategory))return a.categoryData=a.categories[d];if(0!==a.categories[d].subcategories.length)for(var e=a.categories[d].subcategories.length-1;e>=0;e--)if(a.categories[d].subcategories[e].id===parseInt(a.selectedCategory))return a.categoryData=a.categories[d].subcategories[e]}}),a.selectUser=function(){e.open({templateUrl:"modals/reports/select-user/reports-select-user.template.html",windowClass:"modal-reports-select-user",resolve:{setUser:function(){return function(b){a.user=b}},filterByGroup:function(){return null}},controller:"ReportsSelectUserModalController"})},a.registerUser=function(){e.open({templateUrl:"modals/reports/create-user/reports-create-user.template.html",windowClass:"modal-reports-create-user",resolve:{setUser:function(){return function(b){a.user=b}}},controller:"ReportsCreateUserModalController"})};var k=function(a){var b=d.defer(),c=new FileReader;return c.addEventListener("load",function(a){var c=a.target;b.resolve(c.result.replace(/^data:image\/[^;]+;base64,/,""))}),c.readAsDataURL(a),b.promise};a.send=function(){b.resolvingRequest=!0;for(var e=[],g=a.uploader.queue.length-1;g>=0;g--)e.push(k(a.uploader.queue[g]._file));d.all(e).then(function(b){var d={latitude:a.lat,longitude:a.lng,inventory_item_id:a.itemId,description:a.description,address:a.formattedAddress,reference:a.reference,images:b};a.user&&(d.user_id=a.user.id);var e=c.one("reports",a.selectedCategory).customPOST(d,"items");e.then(function(b){a.showMessage("ok","O relato foi criado com sucesso.","success",!0),f.go("reports.show",{id:b.data.id})})})}}]),angular.module("ReportsCategoriesIndexModule",["ReportsCategoriesIndexControllerModule"]).config(["$stateProvider",function(a){a.state("reports.categories",{url:"/categories",views:{"":{templateUrl:"routes/reports/categories/index/reports-categories-index.template.html",controller:"ReportsCategoriesIndexController",controllerAs:"ctrl"}}})}]),angular.module("ReportsCategoriesIndexControllerModule",["ReportsCategoriesDestroyModalControllerModule"]).controller("ReportsCategoriesIndexController",["$scope","Restangular","$modal",function(a,b,c){a.loading=!0;var d=b.one("reports").all("categories").getList({subcategories_flat:!0,return_fields:["id","title","parent_id","icon"].join()});d.then(function(c){var d=b.stripRestangular(c.data);_.each(d,function(a){if(null!==a.parent_id){var b=d.indexOf(_.findWhere(d,{id:a.parent_id}));if(-1===b)return!1;var c=d.indexOf(a);_.isUndefined(d[b].subcategories)?d[b].subcategories=[a]:d[b].subcategories.push(a),d[c]=void 0}}),d=_.without(d,void 0),a.categories=d,a.loading=!1}),a.deleteCategory=function(b){c.open({templateUrl:"modals/reports/categories/destroy/reports-categories-destroy.template.html",windowClass:"removeModal",resolve:{destroyCategory:function(){return function(b){a.categories.splice(a.categories.indexOf(b),1)}},category:function(){return b}},controller:"ReportsCategoriesDestroyModalController"})}}]),angular.module("ReportsCategoriesEditModule",["ReportsCategoriesEditControllerModule"]).config(["$stateProvider",function(a){a.state("reports.categories.edit",{url:"/{id:[0-9]{1,4}}/edit",views:{"@reports":{templateUrl:"routes/reports/categories/edit/reports-categories-edit.template.html",controller:"ReportsCategoriesEditController",controllerAs:"ctrl",resolve:{reportCategoriesResponse:["Restangular",function(a){return a.all("reports").all("categories").getList({display_type:"full"})}],groupsResponse:["Restangular",function(a){return a.all("groups").getList()}]}}}}).state("reports.categories.add",{url:"/add",views:{"@reports":{templateUrl:"routes/reports/categories/edit/reports-categories-edit.template.html",controller:"ReportsCategoriesEditController",controllerAs:"ctrl",resolve:{reportCategoriesResponse:["Restangular",function(a){return a.all("reports").all("categories").getList()}],groupsResponse:["Restangular",function(a){return a.all("groups").getList()}]}}}})}]),angular.module("ReportsCategoriesEditControllerModule",["FormatErrorsHelperModule","NgThumbComponentModule","ReportsCategoriesManageStatusesModalControllerModule"]).controller("ReportsCategoriesEditController",["$scope","$rootScope","$stateParams","Restangular","FileUploader","$q","$location","$modal","$document","reportCategoriesResponse","groupsResponse","Error",function(a,b,c,d,e,f,g,h,i,j,k,l){var m=a.updating=!1,n=c.id;"undefined"!=typeof n&&(m=!0,a.updating=!0),a.mainColors=["#59B1DF","#7DDCE2","#64D2AF","#5CB466","#99C450","#EACD31","#F3AC2E","#F18058","#EF4D3E","#E984FC","#A37FE1","#7A7AF2"],a.alternativeColors=["#4383A6","#5CAFB5","#4D9F88","#3E7148","#73943D","#AC9827","#B78226","#C45C35","#A23463","#A938BE","#7340C1","#5051BB","#28344E","#465366","#677B86","#8195A0","#A0B2BCv","#B9CDD8"],a.loading=!0,a.defaultResolutionTimeSelection=60,a.defaultUserResponseTimeSelection=60;var o=86400,p=3600,q=60,r=function(a){return a%o==0?o:a%p==0?p:q};a.reportCategories=j.data,a.groups=k.data;var s,t=d.one("inventory").all("categories").getList();if(m){s=a.category={};var u=d.one("reports").one("categories",n).get();f.all([t,u]).then(function(b){if(a.categories=b[0].data,s.title=b[1].data.title,s.color=b[1].data.color,s.confidential=b[1].data.confidential,s.parent_id=b[1].data.parent_id,s.allows_arbitrary_position=b[1].data.allows_arbitrary_position,s.statuses=b[1].data.statuses,s.private_resolution_time=b[1].data.private_resolution_time,s.resolution_time_enabled=b[1].data.resolution_time_enabled,s.comment_required_when_forwarding=b[1].data.comment_required_when_forwarding,s.comment_required_when_updating_status=b[1].data.comment_required_when_updating_status,s.solver_groups_ids=b[1].data.solver_groups_ids,s.default_solver_group_id=b[1].data.default_solver_group_id,null!==b[1].data.user_response_time&&(a.enabledUserResponseTime=!0,s.user_response_time=b[1].data.user_response_time,a.defaultUserResponseTimeSelection=r(s.user_response_time),a.preferedUserResponseTime=s.user_response_time/a.defaultUserResponseTimeSelection),null!==b[1].data.resolution_time&&(s.resolution_time=b[1].data.resolution_time,a.defaultResolutionTimeSelection=r(s.resolution_time),a.preferedResolutionTime=s.resolution_time/a.defaultResolutionTimeSelection),s.inventory_categories=[],"object"==typeof b[1].data.inventory_categories&&0!==b[1].data.inventory_categories.length)for(var c=b[1].data.inventory_categories.length-1;c>=0;c--)s.inventory_categories.push(b[1].data.inventory_categories[c].id);a.icon=b[1].data.original_icon,a.loading=!1})}else t.then(function(b){a.categories=b.data,a.loading=!1}),a.enabledUserResponseTime=!1,s=a.category={marker:"R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",inventory_categories:[],allows_arbitrary_position:!0,color:"#2AB4DC",solver_groups_ids:[],default_solver_group_id:null,statuses:[{title:"Em andamento",color:"#f8b01d",initial:!1,"final":!1,active:!0,created_at:"2014-03-05T01: 12: 34.181-03: 00",updated_at:"2014-03-05T01: 12: 34.181-03: 00","private":!1},{title:"Resolvidas",color:"#78c953",initial:!1,"final":!0,active:!0,created_at:"2014-03-05T01: 12: 34.195-03: 00",updated_at:"2014-03-05T01: 12: 34.195-03: 00","private":!1},{title:"Não resolvidas",color:"#999999",initial:!1,"final":!0,active:!0,created_at:"2014-03-05T01: 12: 34.200-03: 00",updated_at:"2014-03-05T01: 12: 34.200-03: 00","private":!1},{title:"Em aberto",color:"#ff0000",initial:!0,"final":!1,active:!0,created_at:"2014-03-17T22: 52: 50.365-03: 00",updated_at:"2014-03-17T22: 52: 50.365-03: 00","private":!1}]};var v=a.uploader=new e;v.filters.push({name:"onlyImages",fn:function(a){var b=v.isHTML5?a.type:"/"+a.value.slice(a.value.lastIndexOf(".")+1);return b="|"+b.toLowerCase().slice(b.lastIndexOf("/")+1)+"|",-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(b)}}),a.pickColor=function(b){a.category.color=b},a.pickIcon=function(b){a.selectedIcon=b,v.queue=[]},a.filterByIds=function(a){return~s.solver_groups_ids.indexOf(a.id)?!0:!1},a.categoriesAutocomplete={options:{source:function(a,b){var c=d.one("search").one("inventory").all("categories").getList({title:a.term});c.then(function(a){b($.map(a.data,function(a){return{label:a.title,value:a.title,id:a.id}}))})},select:function(b,c){a.addCategory(c.item.id)},messages:{noResults:"",results:function(){}}}},a.addCategory=function(a){~s.inventory_categories.indexOf(a)||s.inventory_categories.push(a)},a.removeCategory=function(a){s.inventory_categories.splice(s.inventory_categories.indexOf(a),1)},a.manageStatuses=function(){h.open({templateUrl:"modals/reports/categories/manage-statuses/reports-categories-manage-statuses.template.html",windowClass:"manageStatuses",resolve:{category:function(){return a.category},updating:function(){return m},categoryId:function(){return n}},controller:"ReportsCategoriesManageStatusesModalController"})},a.$watch("preferedResolutionTime",function(){s.resolution_time=a.preferedResolutionTime*a.defaultResolutionTimeSelection}),a.changeDefaultResolutionTimeSelection=function(b){a.preferedResolutionTime=Math.round(s.resolution_time/b),a.defaultResolutionTimeSelection=b},a.$watch("preferedUserResponseTime",function(){s.user_response_time=a.preferedUserResponseTime*a.defaultUserResponseTimeSelection}),a.changeDefaultUserResponseTimeSelection=function(b){a.preferedUserResponseTime=Math.round(s.user_response_time/b),a.defaultUserResponseTimeSelection=b},a.send=function(){function c(a){var b=f.defer(),c=new FileReader;return c.addEventListener("load",function(a){var c=a.target,d=c.result.replace(/^data:image\/[^;]+;base64,/,"");b.resolve(d)}),c.readAsDataURL(a),b.promise}a.inputErrors=null,b.resolvingRequest=!0;var e=[];if(0==v.queue.length&&a.selectedIcon){var h=function(){var b=f.defer(),c=i[0].createElement("CANVAS"),d=c.getContext("2d"),e=new Image;return e.crossOrigin="Anonymous",e.onload=function(){c.height=e.height,c.width=e.width,d.drawImage(e,0,0);var a=c.toDataURL("image/png");b.resolve(a.replace(/^data:image\/[^;]+;base64,/,"")),c=null},e.src="assets/images/icons/"+a.selectedIcon+".png",b.promise}();e.push(h)}else for(var j=v.queue.length-1;j>=0;j--)e.push(c(v.queue[j]._file));f.all(e).then(function(c){var e=c[0],f=angular.copy(s),h=f.statuses;f.statuses={};for(var i=h.length-1;i>=0;i--)h[i].initial=h[i].initial.toString(),h[i]["final"]=h[i]["final"].toString(),h[i].active=h[i].active.toString(),h[i]["private"]=h[i]["private"].toString(),f.statuses[i]=h[i];if(f.resolution_time=f.resolution_time,f.user_response_time="undefined"!=typeof f.user_response_time&&"null"!==f.user_response_time&&1==a.enabledUserResponseTime?f.user_response_time:null,m){e&&(f.icon=e);var j=d.one("reports").one("categories",n).withHttpConfig({treatingErrors:!0}).customPUT(f);j.then(function(){a.showMessage("ok","A categoria de relato foi atualizada com sucesso","success",!0),b.resolvingRequest=!1},function(c){a.showMessage("exclamation-sign","A categoria de relato não pode ser salva","error",!0),"object"!=typeof c.data.error?l.show(c):a.inputErrors=c.data.error,b.resolvingRequest=!1})}else{f.icon=e,f.marker=e;var k=d.one("reports").withHttpConfig({treatingErrors:!0}).post("categories",f);k.then(function(){g.path("/reports/categories"),b.resolvingRequest=!1},function(c){a.showMessage("exclamation-sign","A categoria de relato não pode ser salva","error",!0),"object"!=typeof c.data.error?l.show(c):a.inputErrors=c.data.error,b.resolvingRequest=!1})}})}}]),angular.module("ItemsModule",["ItemsIndexModule","ItemsShowModule","ItemsEditModule","ItemsSelectCategoryModule","ItemsCategoriesIndexModule","ItemsCategoriesEditModule"]).config(["$stateProvider",function(a){a.state("items",{"abstract":!0,url:"/items",templateUrl:"routes/items/items.template.html",resolve:{User:["User",function(a){return a({permissions:["isLogged"]})}]}})}]),angular.module("ItemsIndexModule",["ItemsIndexControllerModule","ItemsIndexMapModule","StyleResultsTableComponentModule"]).config(["$stateProvider",function(a){a.state("items.list",{url:"",views:{"":{templateUrl:"routes/items/index/items-index.template.html",controller:"ItemsIndexController",controllerAs:"ctrl",resolve:{isMap:function(){return!1}}}}})}]),angular.module("ItemsIndexControllerModule",["AdvancedFiltersServiceModule","InventoriesItemsServiceModule","ItemsDestroyModalControllerModule","angular-toArrayFilter"]).controller("ItemsIndexController",["$scope","$rootScope","$modal","$q","isMap","AdvancedFilters","$location","$window","$cookies","InventoriesItemsService",function(a,b,c,d,e,f,g,h,i,j){a.loading=!0,b.uiHasScroll=!0,b.hasMap=e;var k=1,l=15;a.loadingPagination=!1,a.filtersHash=null,a.categories={},a.categoriesStatuses={},a.total=0;var m=function(){a.selectedCategories=[],a.selectedStatuses=[],a.selectedUsers=[],a.beginDate=null,a.endDate=null,a.searchText=null,a.fields=[],a.position=null,a.selectedAreas=[],a.zoom=null,a.clusterize=null};m(),a.sort={column:"created_at",descending:!0},a.changeSorting=function(b){var c=a.sort;c.column===b?c.descending=!c.descending:(c.column=b,c.descending=!1),j.resetCache(),a.reload()},a.selectedCls=function(b){return b===a.sort.column&&"sort-"+a.sort.descending},a.availableFilters=[{name:"Protocolo ou endereço contém...",action:"query"},{name:"Com as categorias...",action:"category"},{name:"Com os estados...",action:"status"},{name:"Por criador do item...",action:"author"},{name:"Por período...",action:"date"},{name:"Por perímetro...",action:"area"},{name:"Por campos...",action:"fields"}],a.activeAdvancedFilters=[],"undefined"!=typeof i.inventoryFiltersHash&&(a.activeAdvancedFilters=JSON.parse(h.atob(i.inventoryFiltersHash))),"undefined"!=typeof g.search().filters&&(a.filtersHash=g.search().filters,a.activeAdvancedFilters=JSON.parse(h.atob(a.filtersHash)));a.$watch("activeAdvancedFilters",function(){m(),0!==a.activeAdvancedFilters.length?(a.filtersHash=h.btoa(JSON.stringify(a.activeAdvancedFilters)),g.search("filters",a.filtersHash),i.inventoryFiltersHash=a.filtersHash):(a.filtersHash=null,g.search("filters",null),delete i.inventoryFiltersHash);for(var b=a.activeAdvancedFilters.length-1;b>=0;b--){var c=a.activeAdvancedFilters[b];"query"===c.type&&(a.searchText=c.value),"categories"===c.type&&a.selectedCategories.push(c.value),"statuses"===c.type&&a.selectedStatuses.push(c.value),"authors"===c.type&&a.selectedUsers.push(c.value),"fields"===c.type&&a.fields.push(c.value),"beginDate"===c.type&&(a.beginDate=c.value),"endDate"===c.type&&(a.endDate=c.value),"area"===c.type&&a.selectedAreas.push(c.value)}o()},!0),a.generateItemsFetchingOptions=function(){var b={};if(a.position||(b.page=k,b.per_page=l),null!==a.searchText&&(b.query=a.searchText),0!==a.selectedCategories.length&&(b.inventory_categories_ids=a.selectedCategories.join()),0!==a.selectedStatuses.length&&(b.inventory_statuses_ids=a.selectedStatuses.join()),0!==a.selectedUsers.length&&(b.users_ids=a.selectedUsers.join()),null!==a.beginDate&&(b["created_at[begin]"]=a.beginDate),null!==a.endDate&&(b["created_at[end]"]=a.endDate),""!==a.sort.column&&(b.sort=a.sort.column,b.order=a.sort.descending?"desc":"asc"),0!==a.fields.length){console.log(a.fields);for(var c=a.fields.length-1;c>=0;c--){var d="fields["+a.fields[c].id+"]["+a.fields[c].condition+"]";if(_.isArray(a.fields[c].value))for(var e=a.fields[c].value.length-1;e>=0;e--){var f=d+"["+e+"]";b[f]=a.fields[c].value[e]}else b[d]=a.fields[c].value}}if(0===a.selectedAreas.length&&null!==a.position)b["position[latitude]"]=a.position.latitude,b["position[longitude]"]=a.position.longitude,b["position[distance]"]=a.position.distance;else if(0!==a.selectedAreas.length)for(var g=a.selectedAreas.length-1;g>=0;g--){var h="position["+g+"][latitude]",i="position["+g+"][longitude]",j="position["+g+"][distance]";b[h]=a.selectedAreas[g].latitude,b[i]=a.selectedAreas[g].longitude,b[j]=a.selectedAreas[g].distance}return null!==a.zoom&&(b.zoom=a.zoom),null!==a.clusterize&&(b.clusterize=!0),b};var n=a.getData=function(b,c){if(a.loadingPagination===!1){a.loadingPagination=!0,"undefined"!=typeof c&&(a.position=c.position,a.zoom=c.zoom,a.clusterize=c.clusterize);var d=j.fetchAll(a.generateItemsFetchingOptions());return d.then(function(b){k++,a.items=b,a.total=j.total;var c=Math.ceil(a.total/l);a.loadingPagination=k===c+1?null:!1,a.loading=!1}),d}};b.$on("inventoriesItemsFetching",function(){e&&(a.loading=!0)}),b.$on("inventoriesItemsFetched",function(){a.total=j.total,a.loading=!1});var o=a.reload=function(b){e?a.$broadcast("mapRefreshRequested",!0):(j.resetCache(),k=1,a.loadingPagination=!1,b===!0&&(a.reloading=!0),a.loadingContent=!0,a.items=[],n().then(function(c){a.loadingContent=!1,a.items=c,b===!0&&(a.reloading=!1)}))};a.reloadMap=function(){b.$emit("mapRefreshRequested")},a.removeFilter=function(b){a.activeAdvancedFilters.splice(a.activeAdvancedFilters.indexOf(b),1)},a.resetFilters=function(){a.activeAdvancedFilters=[],e&&a.$broadcast("updateMap",!0)},a.loadFilter=function(b){"query"===b&&f.query(a.activeAdvancedFilters),"category"===b&&f.category(a.activeAdvancedFilters,"items"),"status"===b&&f.status(a.activeAdvancedFilters,"items"),"author"===b&&f.author(a.activeAdvancedFilters),"fields"===b&&f.fields(a.activeAdvancedFilters,"items"),"date"===b&&f.period(a.activeAdvancedFilters),"area"===b&&f.area(a.activeAdvancedFilters)},a.search=function(b){a.searchText=b,o()},a.share=function(){f.share()},a.changeToMap=function(){g.url(null!==a.filtersHash?"/inventories/map?filters="+a.filtersHash:"/inventories/map")},a.changeToList=function(){g.url(null!==a.filtersHash?"/inventories?filters="+a.filtersHash:"/inventories")},a.deleteItem=function(a,b){c.open({templateUrl:"modals/items/destroy/items-destroy.template.html",windowClass:"removeModal",resolve:{item:function(){return a},category:function(){return b}},controller:"ItemsDestroyModalController"})},a["export"]=function(){c.open({templateUrl:"views/inventories/export.html",windowClass:"filterCategoriesModal",resolve:{categories:function(){return a.categories}},controller:["$scope","$modalInstance","categories",function(a,b,c){a.categories=c,a.updateCategory=function(b){var c=a.categories.indexOf(b);a.categories[c].selected=a.categories[c].selected===!0?!1:!0},a.close=function(){b.close()}}]})}}]),angular.module("ItemsIndexMapModule",["StyleMapComponentModule","MapComponentModule"]).config(["$stateProvider",function(a){a.state("items.list.map",{url:"/map",views:{"@items":{templateUrl:"routes/items/index/map/items-index-map.template.html",controller:"ItemsIndexController",controllerAs:"ctrl",resolve:{isMap:function(){return!0}}}}})}]),angular.module("ItemsShowModule",["ItemsShowControllerModule"]).config(["$stateProvider",function(a){a.state("items.show",{url:"/{id:[0-9]{1,9}}",resolve:{itemResponse:["Restangular","$stateParams",function(a,b){return a.one("inventory").one("items",b.id).get()}],itemHistoryResponse:["Restangular","$stateParams",function(a,b){return a.one("inventory").one("items",b.id).one("history").getList()}]},views:{"":{templateUrl:"routes/items/show/items-show.template.html",controller:"ItemsShowController",controllerAs:"ctrl",resolve:{categoriesResponse:["Restangular",function(a){return a.one("inventory").one("categories").get({display_type:"full"})}]}}}})}]),angular.module("ItemsShowControllerModule",["MapShowItemComponentModule","MapViewStreetviewComponentModule","FieldHistoryModalControllerModule","GalleryComponentModule"]).controller("ItemsShowController",["$rootScope","$scope","Restangular","$q","$state","$modal","itemResponse","categoriesResponse","itemHistoryResponse",function(a,b,c,d,e,f,g,h,i){b.item=g.data;for(var j=h.data.length-1;j>=0;j--)h.data[j].id===b.item.inventory_category_id&&(b.category=h.data[j]);b.getDataByInventoryFieldId=function(a){for(var c=b.item.data.length-1;c>=0;c--)if("undefined"!=typeof b.item.data[c].field&&null!==b.item.data[c].field&&b.item.data[c].field.id===parseInt(a))return b.item.data[c].content;return null},b.getSelectedOptionsByFieldId=function(a){for(var c=b.item.data.length-1;c>=0;c--)if("undefined"!=typeof b.item.data[c].field&&null!==b.item.data[c].field&&b.item.data[c].field.id===parseInt(a))return b.item.data[c].selected_options;return null},b.editItemStatus=function(a,d){f.open({templateUrl:"modals/items/edit-status/items-edit-status.template.html",windowClass:"editStatusModal",resolve:{item:function(){return a},category:function(){return d},refreshItemHistory:function(){return b.refreshHistory}},controller:["$scope","$modalInstance","category","item","refreshItemHistory",function(a,b,d,e,f){a.category=d,a.item=angular.copy(e),a.changeStatus=function(b){a.item.inventory_status_id=b},a.save=function(){var d=c.all("inventory").one("categories",a.category.id).one("items",a.item.id).customPUT({inventory_status_id:a.item.inventory_status_id});d.then(function(){e.inventory_status_id=a.item.inventory_status_id,f(),b.close()})},a.close=function(){b.close()}}]})},b.deleteItem=function(a,b){f.open({templateUrl:"modals/items/destroy/items-destroy.template.html",windowClass:"removeModal",resolve:{removeItemFromList:function(){return!1},item:function(){return a},category:function(){return b}},controller:"ItemsDestroyModalController"})},b.showFieldHistory=function(c){a.resolvingRequest=!0,f.open({templateUrl:"modals/items/field-history/items-field-history.template.html",windowClass:"field-history-modal",resolve:{field:function(){return c},itemId:function(){return b.item.id},itemHistoryResponse:["Restangular","$stateParams",function(a){return a.one("inventory").one("items",b.item.id).one("history").getList(null,{object_id:c.id})}]},controller:"FieldHistoryModalController"})},b.refreshHistory=function(){var a={},d=b.selectedFilters();0!==d.length&&(a.kind=d.join()),b.historyFilterBeginDate&&(a["created_at[begin]"]=b.historyFilterBeginDate),b.historyFilterEndDate&&(a["created_at[end]"]=b.historyFilterEndDate),b.loadingHistoryLogs=!0;var e=c.one("inventory").one("items",b.item.id).one("history").getList(null,a);e.then(function(a){b.historyLogs=a.data,b.loadingHistoryLogs=!1})},b.historyOptions={type:void 0},b.availableHistoryFilters=[{type:"report",name:"Relatos",selected:!0},{type:"fields",name:"Campos",selected:!0},{type:"images",name:"Imagens",selected:!0},{type:"flow",name:"Fluxo",selected:!0},{type:"formula",name:"Fórmulas",selected:!0},{type:"status",name:"Estados",selected:!0}],b.availableHistoryDateFilters=[{name:"Hoje",beginDate:moment().startOf("day").format(),endDate:moment().endOf("day").format(),selected:!1},{name:"Ontem",beginDate:moment().subtract(1,"days").startOf("day").format(),endDate:moment().subtract(1,"days").endOf("day").format(),selected:!1},{name:"Este mês",beginDate:moment().startOf("month").format(),endDate:moment().subtract(1,"days").endOf("day").format(),selected:!1},{name:"Mês passado",beginDate:moment().subtract(1,"months").startOf("month").format(),endDate:moment().subtract(1,"months").subtract(1,"days").endOf("day").format(),
selected:!1},{name:"Todos",beginDate:null,endDate:null,selected:!0}],b.selectedFilters=function(){var a=[];return _.each(b.availableHistoryFilters,function(b){b.selected&&a.push(b.type)}),a},b.toggleOption=function(a){a.selected=!a.selected,b.refreshHistory()},b.resetHistoryFilters=function(){_.each(b.availableHistoryFilters,function(a){a.selected=!0}),b.refreshHistory()},b.showCustomDateFields=function(){_.each(b.availableHistoryDateFilters,function(a){a.selected=!1}),b.showCustomDateHelper=!0},b.selectDateFilter=function(a){_.each(b.availableHistoryDateFilters,function(a){a.selected=!1}),a.selected=!a.selected,b.historyFilterBeginDate=a.beginDate,b.historyFilterEndDate=a.endDate,b.showCustomDateHelper=!1,b.refreshHistory()},b.historyLogs=i.data}]),angular.module("ItemsEditModule",["ItemsEditControllerModule"]).config(["$stateProvider",function(a){a.state("items.show.edit",{url:"/category/{categoryId:[0-9]{1,9}}/edit",views:{"@":{templateUrl:"routes/items/edit/items-edit.template.html",controller:"ItemsEditController",controllerAs:"ctrl",resolve:{categoryResponse:["Restangular","$stateParams",function(a,b){return a.one("inventory").one("categories",b.categoryId).get({display_type:"full"})}]}}}}).state("items.add",{url:"/category/{categoryId:[0-9]{1,9}}/add",views:{"@":{templateUrl:"routes/items/edit/items-edit.template.html",controller:"ItemsEditController",controllerAs:"ctrl",resolve:{categoryResponse:["Restangular","$stateParams",function(a,b){return a.one("inventory").one("categories",b.categoryId).get({display_type:"full"})}],itemResponse:function(){return!1}}}}})}]),angular.module("ItemsEditControllerModule",["ItemsRestoreModalControllerModule","ItemsSelectAddressModalControllerModule","NgThumbComponentModule","TranslateErrorsHelperModule"]).controller("ItemsEditController",["$scope","Restangular","$q","$state","$modal","$rootScope","FileUploader","$localStorage","itemResponse","categoryResponse","$timeout","User",function(a,b,c,d,e,f,g,h,i,j,k,l){var m,n=a.updating=!1,o=j.data.id,p=a.itemData={},q=!1;if(a.uploaders={},i){var r=i.data.id;n=!0,a.updating=!0}a.storage=h,n?("undefined"==typeof a.storage.updating?(a.storage.updating={},a.storage.updating[o]={},a.storage.updating[o][r]=null):"undefined"==typeof a.storage.updating[o]?(a.storage.updating[o]={},a.storage.updating[o][r]=null):"undefined"==typeof a.storage.updating[o][r]&&(a.storage.updating[o][r]=null),null!==a.storage.updating[o][r]&&(m=angular.copy(a.storage.updating[o][r]),q=!0)):("undefined"==typeof a.storage.creating?(a.storage.creating={},a.storage.creating[o]=null):"undefined"==typeof a.storage.creating[o]&&(a.storage.creating[o]=null),null!==a.storage.creating[o]&&(m=angular.copy(a.storage.creating[o]),q=!0)),q===!0&&e.open({templateUrl:"modals/items/restore/items-restore.template.html",windowClass:"removeModal",resolve:{setItemData:function(){return function(){p=a.itemData=angular.copy(m)}},clearData:function(){return function(){n?a.storage.updating[o][r]=null:a.storage.creating[o]=null}}},controller:"ItemsRestoreModalController"}),a.hiddenFields=[];var s=a.locationFieldsIds=[];a.item={inventory_status_id:null},a.category=j.data;for(var t=a.category.sections.length-1;t>=0;t--)for(var u=a.category.sections[t].fields.length-1;u>=0;u--){var v=a.category.sections[t];if("undefined"!=typeof v){if(p[v.fields[u].id]=null,"checkbox"===v.fields[u].kind){var w={};if(null!==v.fields[u].field_options)for(var x=v.fields[u].field_options.length-1;x>=0;x--)w[v.fields[u].field_options[x].id]=!1;p[v.fields[u].id]=$.isEmptyObject(w)?null:w}if(v.location===!0&&("latitude"===v.fields[u].title&&(a.locationFieldsIds[0]=v.fields[u].id,a.hiddenFields.push(v.fields[u].id)),"longitude"===v.fields[u].title&&(a.locationFieldsIds[1]=v.fields[u].id,a.hiddenFields.push(v.fields[u].id)),"address"===v.fields[u].title&&(a.locationFieldsIds[2]=v.fields[u].id),"postal_code"===v.fields[u].title&&(a.locationFieldsIds[3]=v.fields[u].id),"district"===v.fields[u].title&&(a.locationFieldsIds[4]=v.fields[u].id),"city"===v.fields[u].title&&(a.locationFieldsIds[5]=v.fields[u].id),"state"===v.fields[u].title&&(a.locationFieldsIds[6]=v.fields[u].id)),"images"===v.fields[u].kind){var y=new g;y.filters.push({name:"onlyImages",fn:function(a){var b=y.isHTML5?a.type:"/"+a.value.slice(a.value.lastIndexOf(".")+1);return b="|"+b.toLowerCase().slice(b.lastIndexOf("/")+1)+"|",-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(b)}}),a.uploaders[v.fields[u].id]=y,p[v.fields[u].id]={areImages:!0}}}}if(n||a.$watch("itemData",function(b,c){angular.equals(b,c)||(a.storage.creating[o]=angular.copy(b))},!0),n){a.item=i.data,a.item.locked===!0&&a.item.locker_id!==l.id&&(a.locked=!0);var z=function(b){for(var c=a.item.data.length-1;c>=0;c--)if("undefined"!=typeof a.item.data[c].field&&null!==a.item.data[c].field&&a.item.data[c].field.id==b)return a.item.data[c]};for(var A in p){var B=z(A);if("undefined"!=typeof B)if("checkbox"===B.field.kind&&null!==B.content)for(var t=B.content.length-1;t>=0;t--)p[A][B.content[t]]=!0;else"images"===B.field.kind&&null!==B.content?p[A].existingImages=B.content:p[A]=B.content}a.$watch("itemData",function(b,c){angular.equals(b,c)||(a.storage.updating[o][r]=angular.copy(b))},!0);var C=!0,D=function(){b.all("inventory").one("categories",o).one("items",r).all("update_access").patch();k(function(){C&&D()},45e3)};(!a.item.locked||a.item.locked===!0&&a.item.locker_id==l.id)&&D(),a.$on("$destroy",function(){C=!1})}a.openMapModal=function(){var b=e.open({templateUrl:"modals/items/select-address/items-select-address.template.html",windowClass:"mapModal",resolve:{category:function(){return a.category},updating:function(){return n},itemData:function(){return p},locationFieldsIds:function(){return s}},controller:"ItemsSelectAddressModalController"});b.opened.then(function(){setTimeout(function(){f.selectLatLngMap.start()},80)})},a.send=function(){function e(a){var b=c.defer(),d=new FileReader;return d.addEventListener("load",function(a){var c=a.target;b.resolve(c.result.replace(/^data:image\/[^;]+;base64,/,""))}),d.readAsDataURL(a),b.promise}if(a.form.$invalid)return a.showValidationError=!0,!1;a.processingForm=!0;var f=[],g={inventory_status_id:a.item.inventory_status_id,data:{}},h=function(a,b){for(var d=c.defer(),f=[],h=a.queue.length-1;h>=0;h--)f.push(e(a.queue[h]._file));return c.all(f).then(function(a){for(var c=[],e=a.length-1;e>=0;e--)c.push({content:a[e]});if(0!==c.length)if("undefined"==typeof g.data[b])g.data[b]=c;else for(var e=c.length-1;e>=0;e--)g.data[b].push(c[e]);d.resolve()}),d.promise};for(var i in p)if(null!==p[i])if("object"==typeof p[i])if(p[i].areImages===!0){if(f.push(h(a.uploaders[i],i)),"undefined"!=typeof p[i].existingImages)for(var j=p[i].existingImages.length-1;j>=0;j--)p[i].existingImages[j].destroy===!0&&("undefined"==typeof g.data[i]?g.data[i]=[{id:p[i].existingImages[j].id,destroy:!0}]:g.data[i].push({id:p[i].existingImages[j].id,destroy:!0}))}else{var k=[];for(var l in p[i])p[i][l]===!0&&k.push(parseInt(l));0!==k.length&&(g.data[i]=k)}else g.data[i]=p[i];c.all(f).then(function(){if(n){var c=b.one("inventory").one("categories",o).one("items",r).customPUT(g);c.then(function(){a.storage.updating[o][r]=null,a.showMessage("ok","O item foi atualizado com sucesso!","success",!0),a.processingForm=!1},function(b){a.showMessage("exclamation-sign","O item não pode ser criado. Por favor, revise os erros.","error",!0),a.inputErrors=b.data.error,a.processingForm=!1})}else{var e=b.one("inventory").one("categories",o).post("items",g);e.then(function(b){a.storage.creating[o]=null,a.showMessage("ok","O item foi criado com sucesso","success",!0),d.go("items.show",{id:b.data.id})},function(b){a.showMessage("exclamation-sign","O item não pode ser criado. Por favor, revise os erros.","error",!0),a.inputErrors=b.data.error,a.processingForm=!1})}})}}]),angular.module("ItemsSelectCategoryControllerModule",[]).controller("ItemsSelectCategoryController",["$scope","categoriesResponse",function(a,b){a.categories=b.data}]),angular.module("ItemsSelectCategoryModule",["ItemsSelectCategoryControllerModule"]).config(["$stateProvider",function(a){a.state("items.select-category",{url:"/select-category",views:{"@":{templateUrl:"routes/items/select-category/items-select-category.template.html",controller:"ItemsSelectCategoryController",controllerAs:"ctrl",resolve:{categoriesResponse:["Restangular",function(a){return a.one("inventory").all("categories").getList()}]}}}})}]),angular.module("ItemsCategoriesIndexModule",["ItemsCategoriesIndexControllerModule"]).config(["$stateProvider",function(a){a.state("items.categories",{url:"/categories",views:{"":{templateUrl:"routes/items/categories/index/items-categories-index.template.html",controller:"ItemsCategoriesIndexController",controllerAs:"ctrl",resolve:{categoriesResponse:["Restangular",function(a){return a.one("inventory").all("categories").getList({display_type:"full",return_fields:["id","title"].join()})}]}}}})}]),angular.module("ItemsCategoriesIndexControllerModule",["ItemsCategoriesDestroyModalControllerModule"]).controller("ItemsCategoriesIndexController",["$scope","categoriesResponse","$modal",function(a,b,c){a.categories=b.data,a.deleteCategory=function(b){c.open({templateUrl:"modals/items/categories/destroy/items-categories-destroy.template.html",windowClass:"removeModal",resolve:{inventoriesCategoriesList:function(){return a.categories},category:function(){return b}},controller:"ItemsCategoriesDestroyModalController"})}}]),angular.module("ItemsCategoriesEditModule",["ItemsCategoriesEditControllerModule"]).config(["$stateProvider",function(a){a.state("items.categories.edit",{url:"/{id:[0-9]{1,4}}/edit",views:{"@":{templateUrl:"routes/items/categories/edit/items-categories-edit.template.html",controller:"ItemsCategoriesEditController",controllerAs:"ctrl",resolve:{categoryResponse:["Restangular","$stateParams",function(a,b){return a.one("inventory").one("categories",b.id).get({display_type:"full"})}],formulasResponse:["FullResponseRestangular","$stateParams","$q",function(a,b,c){var d=c.defer(),e=a.one("inventory").one("categories",b.id).all("formulas").customGET();return e.then(function(a){d.resolve(a)},function(){d.resolve(!1)}),d.promise}],groupsResponse:["Restangular",function(a){return a.all("groups").getList()}]}}}}).state("items.categories.add",{url:"/add",views:{"@":{templateUrl:"routes/items/categories/edit/items-categories-edit.template.html",controller:"ItemsCategoriesEditController",controllerAs:"ctrl",resolve:{categoryResponse:function(){return!1},formulasResponse:function(){return!1},groupsResponse:["Restangular",function(a){return a.all("groups").getList()}]}}}})}]),angular.module("ItemsCategoriesEditControllerModule",["ItemsCategoriesEditOptionsModalControllerModule","ItemsCategoriesEditFieldValuesModalControllerModule","ItemsCategoriesNewStatusModalControllerModule","ItemsCategoriesEditStatusModalControllerModule","InventorySortableSectionsComponentModule","InventoryPopoverComponentModule","InventoryPopoverLinkComponentModule","InventoryDroppableInputsAreaComponentModule","InventoryEditLabelComponentModule","InputsSidebarComponentModule","InventoryDraggableInputComponentModule","InventoryEditSectionComponentModule","InventoryTriggerComponentModule","InventoryTriggerConditionComponentModule"]).controller("ItemsCategoriesEditController",["$scope","$stateParams","categoryResponse","groupsResponse","Restangular","$localStorage","$q","$modal","$window","$state","FileUploader","formulasResponse",function(a,b,c,d,e,f,g,h,i,j,k,l){var m=a.updating=!1;if(c){m=!0,a.updating=!0,a.category=c.data;var n=a.category.id}a.groups=d.data,a.unsavedCategory=!1,a.showDisabledFields=f,a.currentTab="fields",a.availableInputs=[{kind:"text",name:"Campo de texto",multipleOptions:!1},{kind:"textarea",name:"Campo de parágrafo",multipleOptions:!1},{kind:"integer",name:"Campo numérico",multipleOptions:!1},{kind:"decimal",name:"Campo decimal",multipleOptions:!1},{kind:"checkbox",name:"Campo de múltipla escolha",multipleOptions:!0},{kind:"radio",name:"Campo de escolha única",multipleOptions:!0},{kind:"select",name:"Campo de lista",multipleOptions:!0},{kind:"meters",name:"Campo em metros",multipleOptions:!1},{kind:"centimeters",name:"Campo em centímetros",multipleOptions:!1},{kind:"kilometers",name:"Campo em quilômetros",multipleOptions:!1},{kind:"years",name:"Campo em anos",multipleOptions:!1},{kind:"months",name:"Campo em meses",multipleOptions:!1},{kind:"days",name:"Campo em dias",multipleOptions:!1},{kind:"hours",name:"Campo em horas",multipleOptions:!1},{kind:"seconds",name:"Campo em segundos",multipleOptions:!1},{kind:"angle",name:"Campo de ângulo",multipleOptions:!1},{kind:"date",name:"Campo de data",multipleOptions:!1},{kind:"time",name:"Campo de tempo",multipleOptions:!1},{kind:"cpf",name:"Campo de CPF",multipleOptions:!1},{kind:"cnpj",name:"Campo de CNPJ",multipleOptions:!1},{kind:"url",name:"Campo de URL",multipleOptions:!1},{kind:"email",name:"Campo de e-mail",multipleOptions:!1},{kind:"images",name:"Campo de imagens",multipleOptions:!1}],a.kindHasMultipleOptions=function(b){for(var c=a.availableInputs.length-1;c>=0;c--)if(a.availableInputs[c].kind===b)return a.availableInputs[c].multipleOptions===!0;return!1};var o=function(b){for(var c=a.groups.length-1;c>=0;c--)if(a.groups[c].id==b)return a.groups[c]};if(m){a.category.plot_format="pin"===a.category.plot_format?!1:!0;for(var p=a.category.permissions.groups_can_edit.length-1;p>=0;p--)a.category.permissions.groups_can_edit[p]=o(a.category.permissions.groups_can_edit[p]);for(var p=a.category.permissions.groups_can_view.length-1;p>=0;p--)a.category.permissions.groups_can_view[p]=o(a.category.permissions.groups_can_view[p])}else{a.category={},a.category.title="Nova categoria sem título",a.category.color="#2AB4DC",a.category.icon="R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",a.category.marker="R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",a.category.pin="R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",a.category.plot_format=!1,a.category.statuses=[],a.category.permissions={groups_can_edit:[],groups_can_view:[]};for(var p=a.me.groups.length-1;p>=0;p--)a.category.permissions.groups_can_edit.push(a.me.groups[p]);a.category.sections=[{title:"Localização",required:!0,location:!0,permissions:{groups_can_view:[],groups_can_edit:[]},fields:[{title:"longitude",kind:"text",size:null,inventory_section_id:14,available_values:null,position:1,label:"Longitude",maximum:null,minimum:null,required:!0,location:!0,permissions:{groups_can_view:[],groups_can_edit:[]}},{title:"postal_code",kind:"text",size:null,inventory_section_id:14,available_values:null,position:3,label:"CEP",maximum:null,minimum:null,required:!1,location:!0,permissions:{groups_can_view:[],groups_can_edit:[]}},{title:"road_classification",kind:"text",size:null,inventory_section_id:14,available_values:null,position:8,label:"Classificação Viária",maximum:null,minimum:null,required:!1,location:!0,permissions:{groups_can_view:[],groups_can_edit:[]}},{title:"city",kind:"text",size:null,inventory_section_id:14,available_values:null,position:5,label:"Cidade",maximum:null,minimum:null,required:!1,location:!0,permissions:{groups_can_view:[],groups_can_edit:[]}},{title:"latitude",kind:"text",size:null,inventory_section_id:14,available_values:null,position:0,label:"Latitude",maximum:null,minimum:null,required:!0,location:!0,permissions:{groups_can_view:[],groups_can_edit:[]}},{title:"address",kind:"text",size:null,inventory_section_id:14,available_values:null,position:2,label:"Endereço",maximum:null,minimum:null,required:!1,location:!0,permissions:{groups_can_view:[],groups_can_edit:[]}},{title:"district",kind:"text",size:null,inventory_section_id:14,available_values:null,position:4,label:"Bairro",maximum:null,minimum:null,required:!1,location:!0,permissions:{groups_can_view:[],groups_can_edit:[]}},{title:"state",kind:"text",size:null,inventory_section_id:14,available_values:null,position:6,label:"Estado",maximum:null,minimum:null,required:!1,location:!0,permissions:{groups_can_view:[],groups_can_edit:[]}},{title:"codlog",kind:"text",size:null,inventory_section_id:14,available_values:null,position:7,label:"Codlog",maximum:null,minimum:null,required:!1,location:!0,permissions:{groups_can_view:[],groups_can_edit:[]}}]}]}a.$watch("category",function(b,c){b!==c&&(a.unsavedCategory=!0)},!0),a.groupsCanEditAutocomplete={options:{onlySelect:!0,source:function(a,b){var c=e.all("groups").getList({name:a.term});c.then(function(a){b($.map(a.data,function(a){return{label:a.name,value:a.name,group:{id:a.id,name:a.name}}}))})},messages:{noResults:"",results:function(){}}}},a.groupsCanViewAutocomplete={options:{onlySelect:!0,source:function(a,b){var c=e.all("groups").getList({name:a.term});c.then(function(a){b($.map(a.data,function(a){return{label:a.name,value:a.name,group:{id:a.id,name:a.name}}}))})},messages:{noResults:"",results:function(){}}}},a.groupsCanEditAutocomplete.events={select:function(b,c){for(var d=!1,e=a.category.permissions.groups_can_edit.length-1;e>=0;e--)a.category.permissions.groups_can_edit[e].id===c.item.group.id&&(d=!0);d||a.category.permissions.groups_can_edit.push(c.item.group)},change:function(){a.groupCanEdit=""}},a.groupsCanViewAutocomplete.events={select:function(b,c){for(var d=!1,e=a.category.permissions.groups_can_view.length-1;e>=0;e--)a.category.permissions.groups_can_view[e].id===c.item.group.id&&(d=!0);d||a.category.permissions.groups_can_view.push(c.item.group)},change:function(){a.groupCanView=""}},a.removeGroupCanView=function(b){a.category.permissions.groups_can_view.splice(a.category.permissions.groups_can_view.indexOf(b),1)},a.removeGroupCanEdit=function(b){a.category.permissions.groups_can_edit.splice(a.category.permissions.groups_can_edit.indexOf(b),1)},a.editFieldOptions=function(a){h.open({templateUrl:"modals/items/categories/edit-field-values/items-categories-edit-field-values.template.html",windowClass:"editFieldOptions",controller:"ItemsCategoriesEditFieldValuesModalController",resolve:{field:function(){return a},setFieldOptions:function(){return function(b){a.field_options=b}}}})},i.onbeforeunload=function(){return a.unsavedCategory===!0?"Você tem certeza que deseja sair? Há alterações que não foram salvas.":null},a.goBack=function(){a.unsavedCategory===!0?window.confirm("Você tem certeza que deseja sair? Há alterações que não foram salvas.")&&(a.unsavedCategory=!1,a.loading=!0,j.transitionTo("items.categories",null,{reload:!0})):(a.loading=!0,j.transitionTo("items.categories",null,{reload:!0}))},a.newSection=function(){var b={title:"Nova seção sem título",required:!1,location:!1,fields:[]};a.category.sections.push(b),$("html, body").animate({scrollTop:$(document).height()},"slow")},a.newStatus=function(){h.open({templateUrl:"modals/items/categories/new-status/items-categories-new-status.template.html",windowClass:"editInventoryStatusesModal",resolve:{statuses:function(){return a.category.statuses},updating:function(){return m},categoryId:function(){return n}},controller:"ItemsCategoriesNewStatusModalController"})},a.editStatus=function(a){h.open({templateUrl:"modals/items/categories/edit-status/items-categories-edit-status.template.html",windowClass:"editInventoryStatusesModal",resolve:{status:function(){return a},updating:function(){return m},categoryId:function(){return n}},controller:"ItemsCategoriesEditStatusModalController"})},a.removeStatus=function(b){if("undefined"!=typeof b.id){var c=e.one("inventory").one("categories",n).one("statuses",b.id).remove();c.then(function(){a.category.statuses.splice(a.category.statuses.indexOf(b),1)})}else a.category.statuses.splice(a.category.statuses.indexOf(b),1)},a.$on("hidePopovers",function(b,c){a.$broadcast("hideOpenPopovers",c)}),a.uploaderQueue={items:[]},a.editCategoryOptions=function(){h.open({templateUrl:"modals/items/categories/edit-options/items-categories-edit-options.template.html",windowClass:"editCategory",resolve:{category:function(){return a.category},uploaderQueue:function(){return a.uploaderQueue}},controller:"ItemsCategoriesEditOptionsModalController"})},a.send=function(){function b(a){var b=g.defer(),d=new FileReader;return d.addEventListener("load",function(a){var d=a.target;c=d.result.replace(/^data:image\/[^;]+;base64,/,""),b.resolve()}),d.readAsDataURL(a),b.promise}a.processingForm=!0;for(var c,d=[],f=a.uploaderQueue.items.length-1;f>=0;f--)d.push(b(a.uploaderQueue.items[f]._file));g.all(d).then(function(){for(var b={groups_can_edit:[],groups_can_view:[]},d=a.category.permissions.groups_can_edit.length-1;d>=0;d--)b.groups_can_edit.push(a.category.permissions.groups_can_edit[d].id);for(var d=a.category.permissions.groups_can_view.length-1;d>=0;d--)b.groups_can_view.push(a.category.permissions.groups_can_view[d].id);var f={title:a.category.title,require_item_status:a.category.require_item_status,statuses:a.category.statuses,color:a.category.color,plot_format:a.category.plot_format,permissions:b},h={sections:a.category.sections};if(_.each(h.sections,function(a){_.each(a.fields,function(a){if(_.isUndefined(a.id)&&_.isArray(a.field_options)&&!_.isEmpty(a.field_options)){var b=[];_.each(a.field_options,function(a){b.push(a.value)}),a.field_options=b}})}),f.plot_format=a.category.plot_format===!1?"pin":"marker",m){delete f.statuses,c&&(f.icon=c);var i=e.one("inventory").one("categories",n).customPUT(f),k=e.one("inventory").one("categories",n).one("form").customPUT(h);k.then(function(b){a.category.sections=b.data.sections}),g.all([i,k]).then(function(){a.showMessage("ok","A categoria de inventário foi atualizada com sucesso!","success",!0),a.unsavedCategory=!1,a.processingForm=!1},function(){a.showMessage("exclamation-sign","O inventário não pode ser atualizado.","error",!0),a.processingForm=!1})}else{f.icon=c?c:a.category.icon;var l=e.one("inventory").post("categories",f);l.then(function(b){for(var c,d=b.data,f={},g=d.sections.length-1;g>=0;g--)if(d.sections[g].location===!0){c=d.sections[g].id;for(var i=d.sections[g].fields.length-1;i>=0;i--)f[d.sections[g].fields[i].title]=d.sections[g].fields[i].id}for(var k=a.category.sections.length-1;k>=0;k--){var l=a.category.sections[k];if(l.location===!0){l.id=c;for(var m=l.fields.length-1;m>=0;m--)l.fields[m].id=f[l.fields[m].title]}}var n=e.one("inventory").one("categories",d.id).one("form").customPUT(h);n.then(function(){j.go("items.categories.edit",{id:d.id})})})}})},a.triggers=l?l.data:[],a.onlyActiveTriggers=function(a){return _.isUndefined(a._destroy)||1!=a._destroy?!0:!1},a.newTrigger=function(){var b={conditions:[{inventory_field_id:null,operator:"equal_to",content:null}],inventory_status_id:null,isNew:!0};a.triggers.push(b)}}]),angular.module("UsersModule",["UsersIndexModule","UsersShowModule","UsersEditModule"]).config(["$stateProvider",function(a){a.state("users",{"abstract":!0,url:"/users",templateUrl:"routes/users/users.template.html",resolve:{User:["User",function(a){return a({permissions:["isLogged"]})}]}})}]),angular.module("UsersIndexModule",["UsersIndexControllerModule"]).config(["$stateProvider",function(a){a.state("users.list",{url:"",views:{"":{templateUrl:"routes/users/index/users-index.template.html",controller:"UsersIndexController",controllerAs:"ctrl"}}}).state("users.list.groups",{url:"/group/{groupId:[0-9]{1,4}}",views:{"@users":{templateUrl:"routes/users/index/users-index.template.html",controller:"UsersIndexController",controllerAs:"ctrl"}}})}]),angular.module("UsersIndexControllerModule",["KeyboardPosterComponentModule","GenericInputComponentModule","UsersDestroyModalControllerModule"]).controller("UsersIndexController",["$scope","$q","$stateParams","$modal","Restangular",function(a,b,c,d,e){a.loading=!0,a.loadingPagination=!1,a.sort={column:"",descending:!1},a.changeSorting=function(b){var c=a.sort;c.column===b?c.descending=!c.descending:(c.column=b,c.descending=!1)},a.selectedCls=function(b){return b===a.sort.column&&"sort-"+a.sort.descending};var f,g=c.groupId,h=1,i=30,j="",k=function(b,c){return"undefined"!=typeof b?(a.groupId=b,""!==c?e.one("search").one("groups",b).all("users").getList({name:c,email:c,page:h,per_page:i}):e.one("groups",b).all("users").getList({page:h,per_page:i})):(b=a.groupId=null,""!==c?e.one("search").all("users").getList({name:c,email:c,page:h,per_page:i}):e.all("users").getList({page:h,per_page:i}))},l=e.all("groups").getList(),m=a.getData=function(c){if(a.loadingPagination===!1){a.loadingPagination=!0;var d=k(g,j);return b.all([d,l]).then(function(b){if(a.groups=b[1].data,c!==!0)a.users=b[0].data;else{"undefined"==typeof a.users&&(a.users=[]);for(var d=0;d<b[0].data.length;d++)a.users.push(b[0].data[d]);h++}f=parseInt(b[0].headers().total);var e=Math.ceil(f/i);a.loadingPagination=h===e+1?null:!1,a.loading=!1}),d}};a.search=function(b){j=b,h=1,a.loadingPagination=!1,a.loadingContent=!0,m(!1).then(function(){a.loadingContent=!1,h++})},a.deleteUser=function(b){d.open({templateUrl:"modals/users/destroy/users-destroy.template.html",windowClass:"removeModal",resolve:{usersList:function(){return a.users},user:function(){return b}},controller:"UsersDestroyModalController"})}}]),angular.module("UsersShowModule",["UsersShowControllerModule"]).config(["$stateProvider",function(a){a.state("users.show",{url:"/{id:[0-9]{1,4}}",views:{"":{templateUrl:"routes/users/show/users-show.template.html",controller:"UsersShowController",controllerAs:"ctrl",resolve:{userResponse:["Restangular","$stateParams",function(a,b){return a.one("users",b.id).get()}]}}}})}]),angular.module("UsersShowControllerModule",[]).controller("UsersShowController",["$scope","userResponse","$modal","$location",function(a,b,c,d){a.user=b.data,a.deleteUser=function(a){c.open({templateUrl:"views/users/removeUser.html",windowClass:"removeModal",controller:["$scope","$modalInstance","Users",function(b,c,e){b.user=a,b.confirm=function(){var a=e.get({id:b.user.id},function(){a.$delete({id:b.user.id},function(){c.close(),d.path("/users")})})},b.close=function(){c.close()}}]})}}]),angular.module("UsersEditModule",["UsersEditControllerModule"]).config(["$stateProvider",function(a){a.state("users.show.edit",{url:"/edit",views:{"@users":{templateUrl:"routes/users/edit/users-edit.template.html",controller:"UsersEditController",controllerAs:"ctrl",resolve:{groupsResponse:["Restangular",function(a){return a.all("groups").getList()}]}}}}).state("users.add",{url:"/add",views:{"":{templateUrl:"routes/users/edit/users-edit.template.html",controller:"UsersEditController",controllerAs:"ctrl",resolve:{groupsResponse:["Restangular",function(a){return a.all("groups").getList()}]}}}})}]),angular.module("UsersEditControllerModule",["ngCpfCnpj","EqualsComponentModule"]).controller("UsersEditController",["$scope","$rootScope","Restangular","$stateParams","$location","groupsResponse",function(a,b,c,d,e,f){var g=a.updating=!1,h=d.id;if("undefined"!=typeof h&&(g=!0,a.updating=!0),a.loading=!0,g)c.one("users",h).get().then(function(b){a.user=b.data,a.loading=!1});else{var i=c.stripRestangular(f.data);a.loading=!1,a.user={groups:[]};for(var j=i.length-1;j>=0;j--)"Público"===i[j].name&&a.user.groups.push(i[j])}a.groupsAutocomplete={options:{onlySelect:!0,source:function(a,b){var d=c.all("groups").getList({name:a.term});d.then(function(a){b($.map(a.data,function(a){return{label:a.name,value:a.name,group:{id:a.id,name:a.name}}}))})},messages:{noResults:"",results:function(){}}}},a.groupsAutocomplete.events={select:function(b,c){for(var d=!1,e=a.user.groups.length-1;e>=0;e--)a.user.groups[e].id===c.item.group.id&&(d=!0);d||a.user.groups.push(c.item.group)},change:function(){a.group=""}},a.removeGroup=function(b){a.user.groups.splice(a.user.groups.indexOf(b),1)},a.send=function(){a.inputErrors=null,a.processingForm=!0,b.resolvingRequest=!0;var d=angular.copy(a.user);if(g){var f=c.one("users",h).withHttpConfig({treatingErrors:!0}).customPUT(d);f.then(function(){a.showMessage("ok","O usuário foi atualizado com sucesso","success",!0),a.processingForm=!1,b.resolvingRequest=!1},function(c){a.showMessage("exclamation-sign","O usuário não pode ser salvo","error",!0),"object"!=typeof c.data.error?Error.show(c):a.inputErrors=c.data.error,a.processingForm=!1,b.resolvingRequest=!1})}else{if(0!==d.groups.length){d.groups_ids=[];for(var i=d.groups.length-1;i>=0;i--)d.groups_ids.push(d.groups[i].id)}delete d.groups;var j=c.one("users").withHttpConfig({treatingErrors:!0}).post(null,d);j.then(function(){a.showMessage("ok","O usuário foi criado com sucesso","success",!0),e.path("/users"),a.processingForm=!1,b.resolvingRequest=!1},function(c){a.showMessage("exclamation-sign","O usuário não pode ser criado","error",!0),"object"!=typeof c.data.error?Error.show(c):a.inputErrors=c.data.error,a.processingForm=!1,b.resolvingRequest=!1})}}}]),angular.module("GroupsModule",["GroupsIndexModule","GroupsShowModule","GroupsEditModule"]).config(["$stateProvider",function(a){a.state("groups",{"abstract":!0,url:"/groups",templateUrl:"routes/groups/groups.template.html",resolve:{User:["User",function(a){return a({permissions:["isLogged"]})}]}})}]),angular.module("GroupsIndexModule",["GroupsIndexControllerModule"]).config(["$stateProvider",function(a){a.state("groups.list",{url:"",views:{"":{templateUrl:"routes/groups/index/groups-index.template.html",controller:"GroupsIndexController",controllerAs:"ctrl"}}})}]),angular.module("GroupsIndexControllerModule",["GroupsEditModalControllerModule"]).controller("GroupsIndexController",["$scope","$modal","Restangular",function(a,b,c){a.loading=!0;var d=c.all("groups").getList();d.then(function(b){a.groups=b.data,a.loading=!1}),a.addGroup=function(){b.open({templateUrl:"modals/groups/edit/groups-edit.template.html",windowClass:"editStatusModal",resolve:{group:function(){return null}},controller:"GroupsEditModalController"})},a.deleteGroup=function(d){b.open({templateUrl:"modals/groups/destroy/groups-destroy.template.html",windowClass:"removeModal",resolve:{groupsList:function(){return a.groups}},controller:["$scope","$modalInstance","groupsList",function(a,b,e){a.group=d,a.confirm=function(){var d=c.one("groups",a.group.id).remove();d.then(function(){b.close(),e.splice(e.indexOf(a.group),1)})},a.close=function(){b.close()}}]})}}]),angular.module("GroupsShowModule",["GroupsShowControllerModule"]).config(["$stateProvider",function(a){a.state("groups.show",{url:"/{id:[0-9]{1,4}}",views:{"":{templateUrl:"routes/groups/show/groups-show.template.html",controller:"GroupsShowController",controllerAs:"ctrl"}}})}]),angular.module("GroupsShowControllerModule",["GroupsEditModalControllerModule","GroupsAddUsersModalControllerModule","GroupsRemoveUserModalControllerModule"]).controller("GroupsShowController",["$scope","Restangular","$stateParams","$q","$modal",function(a,b,c,d,e){var f=c.id,g=1,h=15;a.loading=!0,a.loadingPagination=!1,a.total=0,a.sort={column:"",descending:!1},a.changeSorting=function(b){var c=a.sort;c.column===b?c.descending=!c.descending:(c.column=b,c.descending=!1)},a.selectedCls=function(b){return b===a.sort.column&&"sort-"+a.sort.descending},a.removeUserFromGroup=function(b){e.open({templateUrl:"modals/groups/remove-user/groups-remove-user.template.html",windowClass:"removeModal",resolve:{group:function(){return a.group},user:function(){return b},removeUserFromList:function(){return function(b){a.users.splice(a.users.indexOf(b),1)}}},controller:"GroupsRemoveUserModalController"})};var i=b.one("groups",f).get();i.then(function(b){a.group=b.data,a.loading=!1});var j=a.getData=function(c){if(a.loadingPagination===!1){a.loadingPagination=!0;var d=b.all("search").one("groups",f).one("users").getList(null,{page:g,per_page:h,name:a.searchText});return d.then(function(b){if(c!==!0)a.users=b.data;else{"undefined"==typeof a.users&&(a.users=[]);for(var d=0;d<b.data.length;d++)a.users.push(b.data[d]);g++}a.total=parseInt(b.headers().total);var e=Math.ceil(a.total/h);a.loadingPagination=g===e+1&&c===!0?null:!1,a.loading=!1}),d}};j(!0),a.search=function(b){a.searchText=b,a.loadingPagination=!1,a.users=[],g=1,
j(!0)},a.editGroup=function(){e.open({templateUrl:"modals/groups/edit/groups-edit.template.html",windowClass:"editStatusModal",resolve:{group:function(){return a.group}},controller:"GroupsEditModalController"})},a.addUsers=function(){e.open({templateUrl:"modals/groups/add-users/groups-add-users.template.html",windowClass:"modal-groups-select-user",resolve:{group:function(){return a.group}},controller:"GroupsAddUsersModalController"})}}]),angular.module("GroupsEditModule",["GroupsEditControllerModule"]).config(["$stateProvider",function(a){a.state("groups.show.edit",{url:"/edit",views:{"@groups":{templateUrl:"routes/groups/edit/groups-edit.template.html",controller:"GroupsEditController",controllerAs:"ctrl",resolve:{groupResponse:["Restangular","$stateParams",function(a,b){return a.one("groups",b.id).get()}],groupsPermissionsResponse:["FullResponseRestangular","$stateParams",function(a,b){return a.one("groups",b.id).all("permissions").customGET()}],groupsResponse:["Restangular",function(a){return a.all("groups").getList()}],flowsResponse:["Restangular",function(a){return a.all("flows").getList()}],inventoriesCategoriesResponse:["Restangular",function(a){return a.one("inventory").all("categories").getList()}],reportsCategoriesResponse:["Restangular",function(a){return a.one("reports").all("categories").getList({display_type:"full"})}]}}}})}]),angular.module("GroupsEditControllerModule",["DiacriticsInsensitiveFilterHelperModule"]).controller("GroupsEditController",["$scope","$rootScope","Restangular","$stateParams","$location","$timeout","groupResponse","groupsPermissionsResponse","groupsResponse","flowsResponse","inventoriesCategoriesResponse","reportsCategoriesResponse",function(a,b,c,d,e,f,g,h,i,j,k,l){if(a.group=g.data,a.permissions=h.data,a.groups=i.data,a.flows=j.data,a.inventoriesCategories=k.data,a.reportsCategories=l.data,a.newPermission={type:null,objects:[],slugs:[]},a.isString=function(a){return"string"==typeof a},a.availablePermissionTypes=[{type:"user",name:"Usuários",permissionsNames:[{slug:"users_full_access",name:"Gerenciar todos os usuários",needsObject:!1,tooltip:"Ao ativar essa opção, será permitido que este grupo possa ver, adicionar e remover todos os usuários dos grupos às quais tem permissão de visualizar."}]},{type:"group",name:"Grupos",permissionsNames:[{slug:"groups_full_access",name:"Gerenciar todos os grupos",needsObject:!1,tooltip:"Selecionada esta opção, o grupo obtém todas as permissões de edições sobre todos os grupos existentes, sobre novos grupos adicionados no futuro, e sobre todos os usuários pertencentes a todos os grupos. Também permite a visualização e edição de dados dos usuários, buscar, deletar e adicionar usuários."},{slug:"group_edit",name:"Editar e visualizar o grupo",needsObject:!0,tooltip:"Permite sobre os grupos selecionados: a visualização e edição de dados dos usuários, buscar, deletar e adicionar usuários. Permite a edição das permissões dos grupos selecionados."},{slug:"group_read_only",name:"Visualizar o grupo",needsObject:!0,tooltip:"Permite acessar a listagem de grupos selecionados, visualizar quais os usuários estão dentro do grupo. Nesta permissão o usuário não tem permissão de adicionar, deletar ou editar os grupos, usuários e permissões."}]},{type:"other",name:"Configurações",permissionsNames:[{slug:"panel_access",name:"Acesso ao painel permitido",needsObject:!1},{slug:"manage_config",name:"Gerenciar configurações do sistema",needsObject:!1}]},{type:"inventory",name:"Inventário",permissionsNames:[{slug:"inventories_full_access",name:"Gerenciar todas as categorias",needsObject:!1,tooltip:"Ativada esta opção, o grupo obtém todas as permissões de edição sobre todas as categorias de inventário existentes, sobre novas categorias adicionados no futuro, e sobre todos os formulários pertencentes a todas as categorias. Também permite a visualização e edição de dados dos itens de inventário, buscar, deletar e adicionar itens de inventário."},{slug:"inventories_formulas_full_access",name:"Gerenciar fórmulas",needsObject:!1,needsPermission:"inventories_full_access"},{slug:"inventories_items_create",name:"Criar novos itens",needsObject:!0,tooltip:"Ao selecionar quais categorias de inventário o grupo terá acesso, os usuários poderão apenas adicionar itens de inventário sobre as categorias selecionadas, além de poder visualizar os itens que o próprio usuário criou."},{slug:"inventories_items_edit",name:"Editar itens",needsObject:!0,needsPermission:"inventories_items_read_only",tooltip:'Ao selecionar quais categorias de inventário o grupo terá acesso, os usuários poderão visualizar e editar os itens de inventário das categorias selecionadas. Essa opção automaticamente ativará a permissão "Visualizar itens".'},{slug:"inventories_items_delete",name:"Remover itens",needsObject:!0,tooltip:'Ao selecionar quais categorias de inventário o grupo terá acesso, os usuários poderão visualizar e excluir os itens de inventário das categorias selecionadas. Essa opção automaticamente ativará a permissão "Visualizar itens".'},{slug:"inventories_categories_edit",name:"Editar a categoria",needsObject:!0,disableFields:["inventories_items_edit","inventories_items_create","inventories_items_delete","inventories_items_create","inventories_items_read_only"],tooltip:"Permite sobre as categorias selecionadas: a visualização e edição de dados dos itens de inventário, buscar, deletar e adicionar itens de inventário. Permite a edição dos campos de formulários das categorias selecionadas."},{slug:"inventories_items_read_only",name:"Visualizar itens",needsObject:!0,tooltip:"Essa opção permitirá que os usuários deste grupo possam visualizar os itens de inventário de categorias de inventário selecionadas."}]},{type:"report",name:"Relatos",permissionsNames:[{slug:"reports_full_access",name:"Gerenciar todas as categorias",needsObject:!1,tooltip:"Selecionada esta opção, o grupo obtém todas as permissões de edição sobre todas as categorias de relato existentes, sobre novas categorias adicionados no futuro, e sobre todos os relatos criados pertencentes a todas as categorias. Também permite a visualização e edição de dados dos relatos, buscar, deletar e adicionar relatos."},{slug:"reports_items_create",name:"Criar novos relatos",needsObject:!0,tooltip:"Permite que os usuários do painel possam adicionar novos relatos às categorias selecionadas."},{slug:"reports_items_delete",name:"Remover relatos",needsObject:!0,needsPermission:"reports_items_read_private",tooltip:"Permite visualizar e deletar os relatos das categorias selecionadas."},{slug:"reports_items_edit",name:"Editar relatos",needsObject:!0,needsPermission:"reports_items_read_private",tooltip:"Permite visualizar e editar os relatos das categorias selecionadas.",disableFields:["reports_items_forward","reports_items_create_internal_comment","reports_items_alter_status","reports_items_create_comment"]},{slug:"reports_categories_edit",name:"Editar as categorias",disableFields:["reports_items_create","reports_items_delete","reports_items_edit","reports_items_read_public","reports_items_read_private"],needsObject:!0,tooltip:"Permite sobre as categorias selecionadas: a visualização e edição de dados dos relatos, buscar, deletar e adicionar relatos. Permite a edição dos parâmetros das categorias selecionadas."},{slug:"reports_items_read_public",name:"Visualizar relatos parcial",needsObject:!0,tooltip:"A visualização de relato parcial é uma permissão que restringe o acesso as informações do relato, isto é, os usuários do grupo não poderão visualizar as observações internas, as respostas enviadas ao munícipe no modo privado e o protocolo. Os usuário exergarão todas as demais informações da tela."},{slug:"reports_items_read_private",name:"Visualizar relatos completo",needsObject:!0,tooltip:"Permite a visualização completa de todos os campos disponíveis nos relatos das categorias selecionadas."},{slug:"reports_items_forward",name:"Encaminhar relatos",needsObject:!0,tooltip:"Grupo pode encaminhar item de relato da categoria atribuída."},{slug:"reports_items_create_internal_comment",name:"Inserir observações internas",needsObject:!0,tooltip:"Grupo pode inserir uma observação interna nos relatos da categoria atribuída."},{slug:"reports_items_alter_status",name:"Alterar o estado do relato",needsObject:!0,tooltip:"Grupo pode alterar o estado de releato da categoria atribuída."},{slug:"reports_items_create_comment",name:"Adicionar comentários",needsObject:!0,tooltip:"Grupo pode adicionar comentário público ou privado nos relatos da categoria atribuída."}]}],b.flowsEnabled){var m={type:"flow",name:"Fluxos",permissionsNames:[{slug:"flow_can_delete_own_cases",name:"flow_can_delete_own_cases",needsObject:!0},{slug:"flow_can_execute_all_steps",name:"flow_can_execute_all_steps",needsObject:!0},{slug:"flow_can_view_all_steps",name:"flow_can_view_all_steps",needsObject:!0},{slug:"can_execute_step",name:"can_execute_step",needsObject:!0},{slug:"can_view_step",name:"can_view_step",needsObject:!0},{slug:"manage_flows",name:"manage_flows",needsObject:!1},{slug:"flow_can_delete_all_cases",name:"flow_can_delete_all_cases",needsObject:!1}]};a.availablePermissionTypes.push(m)}var n=function(b){for(var c=a.availablePermissionTypes.length-1;c>=0;c--)if(a.availablePermissionTypes[c].type===b)return a.availablePermissionTypes[c];return null};a.getTypeName=function(a){return n(a)?n(a).name:a},a.getTypePermissions=function(a){return n(a)?n(a).permissionsNames:null};var o=function(a,b){var a=n(a);if(!a)return null;for(var c=a.permissionsNames.length-1;c>=0;c--)if(a.permissionsNames[c].slug===b)return a.permissionsNames[c];return null};a.getPermissionsExcerpt=function(){switch(a.newPermission.slugs.length){case 0:return"Selecione a permissão";case 1:return a.getPermissionName(a.newPermission.type,a.newPermission.slugs[0]);default:return a.newPermission.slugs.length+" permissões selecionadas"}},a.isPermissionSelected=function(b){var c=a.newPermission.slugs.indexOf(b);return-1!==c};var p=[];a.togglePermission=function(b){var c=a.newPermission.slugs.indexOf(b.slug);-1===c?(a.newPermission.slugs.push(b.slug),_.isUndefined(b.needsPermission)||-1!==a.newPermission.slugs.indexOf(b.needsPermission)||a.togglePermission(o(a.newPermission.type,b.needsPermission)),_.isUndefined(b.disableFields)||p.push(b)):(a.newPermission.slugs.splice(c,1),_.isUndefined(b.disableFields)||p.splice(p.indexOf(b),1))},a.getObjectsExcerpt=function(){switch(a.newPermission.objects.length){case 0:return"Selecione uma categoria";case 1:return a.newPermission.objects[0].name||a.newPermission.objects[0].title;default:return a.newPermission.objects.length+" categorias selecionadas"}},a.isObjectSelected=function(b){for(var c=a.newPermission.objects.length-1;c>=0;c--)if(a.newPermission.objects[c].id===b)return!0;return!1},a.toggleObject=function(b){for(var c=!1,d=0;d<a.newPermission.objects.length;d++)a.newPermission.objects[d].id==b.id&&(c=d);c!==!1?a.newPermission.objects.splice(c,1):a.newPermission.objects.push(b)},a.selectAllObjects=function(b){for(var c=b.length-1;c>=0;c--){for(var d=!1,e=0;e<a.newPermission.objects.length;e++)a.newPermission.objects[e].id==b[c].id&&(d=!0);d||a.newPermission.objects.push(b[c]),_.isUndefined(b[c].subcategories)||a.selectAllObjects(b[c].subcategories)}},a.isObjectNeeded=function(){if(0===a.newPermission.slugs.length)return null;for(var b=a.newPermission.slugs.length-1;b>=0;b--)if(o(a.newPermission.type,a.newPermission.slugs[b]).needsObject)return!0;return!1},a.isPermissionDisabled=function(b){for(var c=a.newPermission.slugs.length-1;c>=0;c--)if(o(a.newPermission.type,a.newPermission.slugs[c]).needsPermission===b)return!0;for(var c=p.length-1;c>=0;c--)if(-1!==p[c].disableFields.indexOf(b))return!0;return!1},a.getPermissionName=function(a,b){return a&&b?o(a,b)?o(a,b).name:b:!1},a.setNewPermissionType=function(b){f(function(){a.newPermission.objects=[],a.newPermission.slugs=[],p=[],a.showPermissionsMenu=!1,a.showObjectsMenu=!1,a.newPermission.type=b})},a.createPermission=function(){a.creatingPermission=!0;var b=a.newPermission.type,d=a.newPermission.slugs;if(0!==a.newPermission.objects.length)for(var e=[],f=a.newPermission.objects.length-1;f>=0;f--)e.push(a.newPermission.objects[f].id);var g=c.one("groups",a.group.id).one("permissions",b).customPOST({permissions:d,objects_ids:e});g.then(function(){if(a.creatingPermission=!1,0===a.newPermission.objects.length)a.permissions.push({permission_type:b,permission_names:d,object:null});else for(var c=a.newPermission.objects.length-1;c>=0;c--){for(var e=!1,f=a.permissions.length-1;f>=0;f--)_.isUndefined(a.permissions[f].object)||a.permissions[f].permission_type!=b||a.permissions[f].object.id!=a.newPermission.objects[c].id||(e=!0,a.permissions[f].permission_names=_.union(a.permissions[f].permission_names,angular.copy(d)));e||a.permissions.push({permission_type:b,permission_names:angular.copy(d),object:a.newPermission.objects[c]})}a.setNewPermissionType(null)})},a.removePermission=function(b,d){b.removingPermission=!0;var e=b.object?b.object.id:void 0,f=c.one("groups",a.group.id).one("permissions",b.permission_type).customDELETE(null,{permission:d,object_id:e});f.then(function(){"string"==typeof b.permission_names||"object"==typeof b.permission_names&&1===b.permission_names.length?a.permissions.splice(a.permissions.indexOf(b),1):b.permission_names.splice(b.permission_names.indexOf(d),1),b.removingPermission=!1})}}]),angular.module("ConfigModule",["ConfigControllerModule"]).config(["$stateProvider",function(a){a.state("config",{url:"/config",templateUrl:"routes/config/config.template.html",controller:"ConfigController",resolve:{User:["User",function(a){return a({permissions:["isLogged"]})}],flagsResponse:["Restangular",function(a){return a.all("feature_flags").getList()}]}})}]),angular.module("ConfigControllerModule",["FeatureFlagComponentModule"]).controller("ConfigController",["$scope","flagsResponse",function(a,b){for(var c={explore:{name:"Explorar o mapa",desc:"Permite visualizar os relatos publicados por outros usuário em um mapa. As informações pessoais destes usuários não são exibidas nos relatos.",mobileConfig:!0},create_report_clients:{name:"Criar relatos",desc:"Permite que cidadãos possam criar os relatos.",mobileConfig:!0},create_report_panel:{name:"Criar relato pelo painel administrativo",desc:"Permite que usuários do painel administrativo possam criar relatos dos usuários. Ideal para atendimento ao munícipe (156) e prestadora de serviços.",mobileConfig:!1},stats:{name:"Estatísticas",desc:"Permite que os usuários visualizem estatísticas globais dos status dos relatos. As informações detalhadas não é exibida nesta interface, apenas a somatória de todos os relatos dentro daquele status específicos.",mobileConfig:!0},social_networks_facebook:{name:"Compartilhamento do relato no Facebook",desc:"Permite que o usuário, ao publicar um novo relato, compartilhe no Facebook. Se desativado o usuário não pode conectar sua conta do Facebook no aplicativo e também não é exibido o botão de compartilhamento.",mobileConfig:!0},social_networks_twitter:{name:"Compartilhamento do relato no Twitter",desc:"Permite que o usuário, ao publicar um novo relato, compartilhe no Twitter. Se desativado o usuário não pode conectar sua conta do Twitter no aplicativo e também não é exibido o botão de compartilhamento.",mobileConfig:!0},social_networks_gplus:{name:"Compartilhamento do relato no Google Plus",desc:"Permite que o usuário, ao publicar um novo relato, compartilhe no Google Plus. Se desativado o usuário não pode conectar sua conta do Google Plus no aplicativo e também não é exibido o botão de compartilhamento.",mobileConfig:!0},allow_photo_album_access:{name:"Permitir acesso ao album de fotos",desc:"Permite que o usuário, ao publicar um novo relato, selecione uma foto do próprio album para inserir no relato. Se desativado o usuário só poderá fazer uma fotografia ou continuar sem enviar nenhuma foto.",mobileConfig:!0},cases:{name:"Casos",desc:"Aenean eu leo quam. Pellentesque ornare sem lacinia quam venenatis vestibulum. Cras justo odio, dapibus ac facilisis in, egestas eget quam.",mobileConfig:!1},inventory:{name:"Inventário",desc:"O sistema ZUP permite que instituições e empresas criem qualquer tipo de inventário georeferenciado. O usuário com permissão de acesso às categorias de inventário tem a liberdade de criar campos diretamente pelo painel, para que outros usuários possam criar os itens de inventário relacionado a categoria e fazer a gestão deste itens de inventário utilizando diversas ferramentas disponíveis.",mobileConfig:!1},reports:{name:"Relatos",desc:"A categoria de relato permite que empresas e instituições criem um canal de comunicação com os seus clientes e usuários, permitindo que os usuários relatem problemas. É possível criar ilimitadas categorias de relatos, é permitido que estas categorias possam ser disponibilizadas aos usuários nos aplicativos ou privado, isto é, só será permitido que usuários com acesso ao Painel ZUP possa criar os relatos.",mobileConfig:!1},show_resolution_time_to_clients:{name:"Exibir o tempo de resolução do relato para os usuários",desc:"Quando o usuário cria um relato, é exibido uma mensagem de agradecimento e o tempo de resolução do relato. Se desativado, esta mensagem do tempo é ocultada.",mobileConfig:!0}},d=angular.copy(b.data),e=d.length-1;e>=0;e--){var f=d[e].name;"undefined"!=typeof c[f]&&(d[e].name=c[f].name,d[e].desc=c[f].desc,d[e].mobileConfig=c[f].mobileConfig,d[e].enabled="disabled"===d[e].status?!1:!0)}a.flags=d}]),angular.module("HelpModule",["HelpControllerModule"]).config(["$stateProvider",function(a){a.state("help",{url:"/help",templateUrl:"routes/help/help.template.html",controller:"HelpController",resolve:{User:["User",function(a){return a({permissions:["isLogged"]})}]}})}]),angular.module("HelpControllerModule",["yaru22.md"]).controller("HelpController",["$scope",function(){}]),angular.module("FlowsModule",["FlowsIndexModule","FlowsShowModule","FlowsShowStepsEditModule"]).config(["$stateProvider",function(a){a.state("flows",{"abstract":!0,url:"/flows",templateUrl:"routes/flows/flows.template.html",resolve:{User:["User",function(a){return a({permissions:["isLogged"]})}]}})}]),angular.module("FlowsIndexModule",["FlowsIndexControllerModule"]).config(["$stateProvider",function(a){a.state("flows.list",{url:"",views:{"":{templateUrl:"routes/flows/index/flows-index.template.html",controller:"FlowsIndexController",controllerAs:"ctrl"}}})}]),angular.module("FlowsIndexControllerModule",["FlowsAddModalControllerModule","FlowsEditModalControllerModule","FlowsDestroyModalControllerModule"]).controller("FlowsIndexController",["$scope","Restangular","$modal",function(a,b,c){a.loading=!0;var d=b.all("flows").getList({display_type:"full",return_fields:["id","title","total_cases","created_by.id","created_by.name","updated_by.id","updated_by.name","steps.id"].join()});d.then(function(b){a.loading=!1,a.flows=b.data}),a.addFlow=function(){c.open({templateUrl:"modals/flows/add/flows-add.template.html",windowClass:"addFlowModal",resolve:{flows:function(){return a.flows}},controller:"FlowsAddModalController"})},a.editFlow=function(b){c.open({templateUrl:"modals/flows/edit/flows-edit.template.html",windowClass:"addFlowModal",resolve:{flows:function(){return a.flows},flow:function(){return b}},controller:"FlowsEditModalController"})},a.removeFlow=function(b){c.open({templateUrl:"modals/flows/destroy/flows-destroy.template.html",windowClass:"removeModal",resolve:{flows:function(){return a.flows},flow:function(){return b}},controller:"FlowsDestroyModalController"})}}]),angular.module("FlowsShowModule",["FlowsShowControllerModule"]).config(["$stateProvider",function(a){a.state("flows.show",{url:"/{id:[0-9]{1,4}}",views:{"":{templateUrl:"routes/flows/show/flows-show.template.html",controller:"FlowsShowController",controllerAs:"ctrl"}}})}]),angular.module("FlowsShowControllerModule",["FlowsStepsAddModalControllerModule","FlowsStepsDestroyModalControllerModule","FlowsStepsOrderComponentModule"]).controller("FlowsShowController",["$scope","Restangular","$stateParams","$modal","$q",function(a,b,c,d){var e=c.id;a.loading=!0,a.currentTab="steps";var f=b.one("flows",e).get({display_type:"full",return_fields:["id","title","my_steps_flows.id","my_steps_flows.title","my_steps_flows.step_type","my_steps_flows.my_child_flow.id","my_steps_flows.my_child_flow.title","my_steps_flows.my_child_flow.step_type"].join()});f.then(function(c){a.loading=!1,a.flow=c.data,console.log(b.stripRestangular(a.flow))}),a.getAncestor=function(b){for(var c=a.flow.steps.length-1;c>=0;c--)if(a.flow.steps[c].id===b)return a.flow.steps[c]},a.addStep=function(){d.open({templateUrl:"modals/flows/steps/add/flows-steps-add.template.html",windowClass:"editStepModal",resolve:{flow:function(){return a.flow}},controller:"FlowsStepsAddModalController"})},a.removeStep=function(b){d.open({templateUrl:"modals/flows/steps/destroy/flows-steps-destroy.template.html",windowClass:"removeModal",resolve:{flow:function(){return a.flow},step:function(){return b}},controller:"FlowsStepsDestroyModalController"})},a.editFlow=function(){d.open({templateUrl:"modals/flows/edit/flows-edit.template.html",windowClass:"addFlowModal",resolve:{flows:function(){return null},flow:function(){return a.flow}},controller:"FlowsEditModalController"})}}]),angular.module("FlowsShowStepsEditModule",["FlowsShowStepsEditControllerModule"]).config(["$stateProvider",function(a){a.state("flows.show.steps-edit",{url:"/steps/{stepId:[0-9]{1,4}}/edit",views:{"@":{templateUrl:"routes/flows/show/steps-edit/flows-show-steps-edit.template.html",controller:"FlowsShowStepsEditController",controllerAs:"ctrl"}}})}]),angular.module("FlowsShowStepsEditControllerModule",["FlowsStepsEditModalControllerModule","FlowsCreateValueComponentModule","FlowsDroppableInputsAreaComponentModule","FlowsSingleValueComponentModule","FlowsStepFieldComponentModule","FlowsTriggerComponentModule","InventoryPopoverComponentModule","InventoryPopoverLinkComponentModule","InputsSidebarComponentModule","FlowsDraggableInputComponentModule"]).controller("FlowsShowStepsEditController",["$scope","Restangular","$modal","$stateParams","$q",function(a,b,c,d,e){var f=d.id,g=d.stepId;a.loading=!0,a.currentTab="form";var h=b.one("flows",f).get({display_type:"full",return_fields:["id","title","draft","initial","status"].join()}),i=b.one("flows",f).one("steps",g).get(),j=b.one("flows",f).one("steps",g).all("fields").getList(),k=b.one("flows",f).one("steps",g).all("triggers").getList(),l=b.all("flows").getList({display_type:"full",return_fields:["id","title"].join()});e.all([h,i,j,k,l]).then(function(c){a.loading=!1,a.flow=c[0].data,a.step=c[1].data,a.fields=c[2].data,a.triggers=c[3].data,a.flows=c[4].data,console.log(b.stripRestangular(a.flow)),console.log(b.stripRestangular(a.step)),console.log(b.stripRestangular(a.fields)),console.log(b.stripRestangular(a.triggers))}),a.availableInputs={normal:[{kind:"text",name:"Campo de texto"},{kind:"integer",name:"Campo numérico"},{kind:"decimal",name:"Campo decimal"},{kind:"checkbox",name:"Campo de múltipla escolha",multipleOptions:!0},{kind:"select",name:"Campo de lista",multipleOptions:!0},{kind:"radio",name:"Campo de escolha única",multipleOptions:!0},{kind:"meter",name:"Campo em metros"},{kind:"centimeter",name:"Campo em centímetros"},{kind:"kilometer",name:"Campo em quilômetros"},{kind:"year",name:"Campo em anos"},{kind:"month",name:"Campo em meses"},{kind:"day",name:"Campo em dias"},{kind:"hour",name:"Campo em horas"},{kind:"minute",name:"Campo em minutos"},{kind:"second",name:"Campo em segundos"},{kind:"angle",name:"Campo de ângulo"},{kind:"date",name:"Campo de data"},{kind:"time",name:"Campo de tempo"},{kind:"cpf",name:"Campo de CPF"},{kind:"cnpj",name:"Campo de CNPJ"},{kind:"url",name:"Campo de URL"},{kind:"email",name:"Campo de e-mail"},{kind:"image",name:"Campo de imagem"},{kind:"attachment",name:"Campo de anexo"}],special:[{kind:"previous_field",name:"Etapa anterior"},{kind:"category_inventory",name:"Categoria de inventário"},{kind:"category_inventory_field",name:"Campo de inventário"},{kind:"category_report",name:"Categoria de relato"}]},a.kindHasMultipleOptions=function(b){for(var c=a.availableInputs.normal.length-1;c>=0;c--)if(a.availableInputs.normal[c].kind===b)return a.availableInputs.normal[c].multipleOptions===!0;return!1},a.action_types=[{action:"enable_steps",name:"Ativar etapa(s)"},{action:"disable_steps",name:"Desativar etapa(s)"},{action:"finish_flow",name:"Finalizar fluxo(s)"},{action:"transfer_flow",name:"Transferir fluxo(s)"}],a.newTrigger=function(){var b={title:"Novo gatilho",trigger_conditions:[],action_type:"disable_steps",action_values:[],description:"",isNew:!0};a.triggers.push(b)},a.$on("hidePopovers",function(b,c){a.$broadcast("hideOpenPopovers",c)}),a.editStep=function(){c.open({templateUrl:"modals/flows/steps/edit/flows-steps-edit.template.html",windowClass:"editStepModal",resolve:{flow:function(){return a.flow},step:function(){return a.step}},controller:"FlowsStepsEditModalController"})}}]),angular.module("CasesModule",["CasesIndexModule","CasesEditModule"]).config(["$stateProvider",function(a){a.state("cases",{"abstract":!0,url:"/cases",templateUrl:"routes/cases/cases.template.html",resolve:{User:["User",function(a){return a({permissions:["isLogged"]})}]}})}]),angular.module("CasesIndexModule",["CasesIndexControllerModule"]).config(["$stateProvider",function(a){a.state("cases.list",{url:"",views:{"":{templateUrl:"routes/cases/index/cases-index.template.html",controller:"CasesIndexController",controllerAs:"ctrl"}}})}]),angular.module("CasesIndexControllerModule",[]).controller("CasesIndexController",["$scope","Restangular","$modal","$q","$location",function(a,b,c,d,e){a.currentTab="progress";var f,g,h=1,i=30;a.selectedFlows=[],a.selectedSteps=[];var j=function(){var c=b.all("cases"),d={display_type:"full",page:h,per_page:i};return 0!==a.selectedFlows.length&&(d.initial_flow_id=a.selectedFlows.join()),0!==a.selectedSteps.length&&(d.step_id=a.selectedSteps.join()),"finished"===a.currentTab&&(d.completed=!0),c.getList(d)},k=function(){var c=b.all("flows").getList({display_type:"full",initial:"true"}),e=j(),k=d.all([e,c]);return k.then(function(b){a.flows=b[1].data,a.cases=b[0].data,f=parseInt(b[0].headers().total),g=Math.ceil(f/i),a.steps=[];for(var c=a.flows.length-1;c>=0;c--)for(var d=a.flows[c].steps.length-1;d>=0;d--)a.steps.push(a.flows[c].steps[d]);console.log(a.steps),h++}),k};a.paginate=function(){if(h!==g+1&&a.loadingPagination===!1){a.loadingPagination=!0;var b=j();return b.then(function(b){for(var c=0;c<b.data.length;c++)a.cases.push(b.data[c]);h++,a.loadingPagination=!1}),b}a.loadingPagination=null},a.reload=function(){a.cases=[],a.loadingPagination=!1,a.loadingContent=!0,h=1,a.paginate().then(function(){a.loadingContent=!1})},a.$watchCollection("[currentTab, selectedFlows, selectedSteps]",function(b,c){angular.equals(b,c)===!1&&a.reload()}),a.loading=!0,a.loadingPagination=!1,k().then(function(){a.loading=!1}),a.createCase=function(a){var c=b.all("cases").post({initial_flow_id:a.id,step_id:a.steps[0].id});c.then(function(a){e.path("/cases/"+a.data.id)})}}]),angular.module("CasesEditModule",["CasesEditControllerModule"]).config(["$stateProvider",function(a){a.state("cases.edit",{url:"/{id:[0-9]{1,4}}",views:{"@":{templateUrl:"routes/cases/edit/cases-edit.template.html",controller:"CasesEditController",controllerAs:"ctrl"}}})}]),angular.module("CasesEditControllerModule",[]).controller("CasesEditController",["$scope","Restangular","$modal","$stateParams",function(a,b,c,d){var e=d.id;a.loading=!0,a.currentTab="steps";var f=b.one("cases",e).get({display_type:"full"});f.then(function(c){a["case"]=c.data,a.loading=!1,console.log(b.stripRestangular(a["case"]))}),a.toggleTree=function(){a.viewTree=a.viewTree===!0?!1:!0},a.selectConductor=function(){c.open({templateUrl:"views/cases/selectConductor.html",windowClass:"modalConductor"})},a.changeConductor=function(){c.open({templateUrl:"views/cases/changeConductor.html",windowClass:"modalConductor"})}}]),angular.module("EqualsComponentModule",[]).directive("equals",function(){return{restrict:"A",require:"?ngModel",link:function(a,b,c,d){if(d){a.$watch(c.ngModel,function(){e()}),c.$observe("equals",function(){e()});var e=function(){var a=d.$viewValue,b=c.equals;"undefined"!=typeof a&&"undefined"!=typeof b&&d.$setValidity("equals",a===b)}}}}}),angular.module("NavItemComponentModule",[]).directive("navItem",["$location",function(a){return{restrict:"A",link:function(b,c){var d=c.find("a")[0].href;b.location=a,b.$watch("location.absUrl()",function(a){a.indexOf(d)?c.removeClass("active"):c.addClass("active")})}}}]),angular.module("MapComponentModule",["GoogleMapServiceModule","ReportsItemsServiceModule","InventoriesItemsServiceModule"]).directive("map",["$rootScope","GoogleMapService","ReportsItemsService","InventoriesItemsService","ENV",function(a,b,c,d,e){return{restrict:"A",scope:{getCategory:"&",getData:"&",getFiltersOptions:"&",filterSelectedAreas:"="},link:function(f,g,h){var i="reports"===h.mapCategory?!0:!1,j=new b(i,parseFloat(e.mapLat),parseFloat(e.mapLng),parseInt(e.mapZoom,10),g[0]),k=i?c.fetchClustered:d.fetchClustered,l=null,m=function(){var b=j.getCenter(),e={zoom:j.getZoom(),clusterize:!0},g=f.getFiltersOptions()||{},h={latitude:b.lat(),longitude:b.lng(),distance:j.getDistance()};a.mapDebug=_.extend({zoom:e.zoom},h),_.isUndefined(g["position[0][latitude]"])&&(e["position[latitude]"]=h.latitude,e["position[longitude]"]=h.longitude,e["position[distance]"]=h.distance),e=_.extend(e,g),l=e,i?c.resetCache():d.resetCache(),k(e).then(function(a){if(l===e){var b=a.clusters,c=i?a.reports:a.items;j.processMarkers(b,c)}})},n=null,o=null,p=function(){n&&clearTimeout(n),n=setTimeout(function(){m()},300),o&&clearTimeout(o),o=setTimeout(function(){j.hideOutOfBoundsMarkers()},100)},q=j.getZoom();google.maps.event.addListener(j.getMap(),"bounds_changed",function(){q!==j.getZoom()&&(j.changeFilterOuterCircles(),q=j.getZoom()),p()}),f.$on("mapRefreshRequested",function(){p(),f.$watch("filterSelectedAreas",function(){j.processAreaFilters(f.filterSelectedAreas)})})}}}]),angular.module("StyleMapComponentModule",[]).directive("styleMap",["$window",function(a){return{restrict:"A",link:function(b,c){var d=function(){c.find(".mapItems").css({"margin-top":c.find(".advancedSearch").height()})},e=function(){var b=$(a).height()-60-71-56-c.find(".advancedSearch").height()-2;c.find(".mapItems").height(b)};d(),e(),$(a).resize(function(){e()}),b.$watch("activeAdvancedFilters",function(){d(),e()},!0)}}}]),angular.module("StyleResultsTableComponentModule",[]).directive("styleResultsTable",function(){return{restrict:"A",link:function(a,b){var c=function(){b.find(".custom_table").css({"margin-top":b.find(".advancedSearch").height()})};c(),a.$watch("activeAdvancedFilters",function(){c()},!0)}}}),angular.module("OnBlurComponentModule",[]).directive("onBlur",function(){return{restrict:"A",link:function(a,b,c){b.bind("blur",function(){"undefined"!=typeof c.onBlurDelay?setTimeout(function(){a.$apply(c.onBlur)},c.onBlurDelay):a.$apply(c.onBlur)})}}}),angular.module("OnFocusComponentModule",[]).directive("onFocus",function(){return{restrict:"A",link:function(a,b,c){b.bind("focus",function(){a.$apply(c.onFocus)})}}}),angular.module("FocusOnEventComponentModule",[]).directive("focusOnEvent",function(){return{restrict:"A",link:function(a,b,c){a.$on(c.focusOnEvent,function(){b.focus()})}}}),angular.module("AddAreaCircleFormComponentModule",[]).directive("addAreaCircleForm",function(){return{restrict:"A",link:function(a,b){var c={types:["geocode"],componentRestrictions:{country:"br"}},d=new google.maps.places.Autocomplete(b.find(".address")[0],c);d.bindTo("bounds",a.map),google.maps.event.addListener(d,"place_changed",function(){var a=d.getPlace();a.geometry&&(b.find(".lat").val(a.geometry.location.lat()),b.find(".lng").val(a.geometry.location.lng()))}),a.addCircle=function(){
var c=b.find(".lat"),d=b.find(".lng"),e=!1;c.removeClass("form-error"),d.removeClass("form-error"),""===c.val()&&(c.addClass("form-error"),e=!0),""===d.val()&&(d.addClass("form-error"),e=!0),e||a.addCircleByLatLng(c.val(),d.val())}}}}),angular.module("AreaMapComponentModule",[]).directive("areaMap",["ENV",function(a){return{restrict:"A",link:function(b,c){var d={options:{styles:[{},{featureType:"poi.business",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.government",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.medical",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.school",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.sports_complex",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"off"},{saturation:-100},{lightness:42}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{saturation:-100},{lightness:47}]},{featureType:"landscape",stylers:[{lightness:82},{saturation:-100}]},{featureType:"water",stylers:[{hue:"#00b2ff"},{saturation:-21},{lightness:-4}]},{featureType:"poi",stylers:[{lightness:19},{weight:.1},{saturation:-22}]},{elementType:"geometry.fill",stylers:[{visibility:"on"},{lightness:18}]},{elementType:"labels.text",stylers:[{saturation:-100},{lightness:28}]},{featureType:"poi.attraction",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{saturation:12},{lightness:25}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.text",stylers:[{lightness:30}]},{featureType:"landscape.man_made",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{saturation:-100},{lightness:56}]},{featureType:"road.local",elementType:"geometry.fill",stylers:[{lightness:62}]},{featureType:"landscape.man_made",elementType:"geometry",stylers:[{visibility:"off"}]}],homeLatlng:new google.maps.LatLng(a.mapLat,a.mapLng),map:{zoom:parseInt(a.mapZoom),mapTypeControl:!1,panControl:!0,panControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT},zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT},scaleControl:!0,scaleControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT},streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT}}},map:null,circles:[],lastListenerDistance:null,lastListenerPosition:null,DistanceWidget:function(a,b){this.set("map",a),this.set("position",b);var c=new google.maps.Marker({draggable:!0,title:"Me mova!",icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAAA0CAYAAADBjcvWAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAG2YAABzjgAA+YsAAIR4AAB8wwAA95IAAC/yAAARoZE2jZ4AAAzVSURBVHjaxFprbGXXVf7WPq/7cG1fv+5NJ74eexIzGZgJaUd9qg+ESqREpa3oj6pIqOIPRVQgBD+CQEjwo6qEkChCQkgEqrbqQ6oaNVIpRWpaCKlSmsbDlITJTCYZxx3PMzPj6/s8Z++9+HH2vnd7+1zbk7jCoz3n+Fzfc86311rfWuvbm5gZh/RDY87dHx5zfug/4SGAIe/cv+YC8QcKjv9vwHwgwhnkHKnAWgxAO0ft/H6olgzfoIVcMIEZwjmKMcBcMMoM7Rz1YQEM7xIQOQBC5xg6vwcFVmMPmDRgpDOUM960e4Z3aSX74pEzYnN0AfpWY89SEkA2ZtAebnpowMhzudAAiQEk3jG6S2CpATIw5wPzDAtQFpDOoQBzySA0L544o2SGD8yNv6IY8y02MCMC0Dfn9tnWRe867sJ93M+1kgum7JzHAOKf3OzO/ufm1vKPbvZOXe7rpS2pZzPmEgDEgtKJQNxuJLTxtpnST3/lyPT5dy1UbxhgsTcxRTGq7hYYFSRo1/1sDFkQFTMssHgrlZUvv3TjxJObnV+90stWe4qnJFMpfy0a5QcGAuK0LMTWXCm89Gv10g8+9Qvza41KvG1csQ+gZ0bXHK0FpcOc/EaA+ZaybmcBVQ2oMoDkb89cfuhrr7U+ttFXp4gIRGJnkiMazrl9DAPQ5pd6TK98+J7KE396evGZgKjvgOsYcBagjUd10HjzgQknpmLHSlVnlC+3B1OfeWb9k89vpQ9LIApAyDEIkHADdASTifM3YvtmDMUAoPFLE9F//OUvN770jsbkFcdiHWf0HXB+vtsXmEvpNqYsmAl7vnajXf/dp9f/YH2gTwmRAwqIQIYriMwA5RYz5mIiAAztAMvPNZiBuRDrf/Fg428+ujL7sgOsbUbXAScP4pJiHze0RFEBUP7x1Vb9t//91ccu9fQpGlPpDqPKuCERQIJAzO6nsFNh73M946XH1q489q2LN4857j50exPvwZiqZiwwF1TgUXsZQOlOqqq//8z6710e8P1k3dwc9C43yK+TGw1EADOEM9HsTchtifqf//eVP3zuRqfusW/ipRPaD5woYEM3CQ/z1KefuvDxlzv8NuKCulbv06M432EGxrVKAsDVDEt/8uz6b3n50s2VB7JakcUiz2LxV168cv/TN/oftrxtYn7HlDDnFzTnrMdagzmPI22YkMHDrzHzkEj85uVsR73/s/916Z0F4A5sNVFAHIGTv2IA0eMv3Xikz6Ji32TIbMNih6E1Q0oJrTWYABYEBYZiCaU1JCtI1tCckxqxhiANwYAAIyAgICA0eeLJy9u/3k5lySGypCCRjwUnClqR0LFa+MT5q82X2uo0vBlmBljn15TWyKRGphiZVEiVRKYUpNKQzJBaQisNrRnaEhoxCDm40cMZBCAC42cp3f/4/2w+6AFzAe4JbpzFhpX6Uxt3HmhrngLrnJq1oW+Th6RkKMl53HDuikoCmdJQzNCKoRRDaoZmBoHAmqE0Q2lAaiDVjJQZmQYyDaQa6DHiH17bPlVQzvluWRhzodcRC7+vev713oOkOf+UCSANZmGT4Ij0LB2yzm+jCVrr3HWJQAFBMxkrk/mevS+GR4X8FgyN873wgY077YnF6QlpAMkx7YztBIbXw4L60KV9cW2glhgEZgZR/kLE9oV9tjPloSGSUb8hEJi/zysTHj1Vj47a4VMCcE3yPXeubEwuTj/Q9SqOIlqVLgWFBTrGDv1iS6LGFoSxhqZRYbuL4o01GdohOg2lRJ6seVQ/mmka/Z2wr567dY/FxFa7MwngltP2+AKQP7S91TjJjAAgU5S4RaxLIuxYyg6NnPmURk4W2nzXCXEe/sPO//VoQhgA6Yz+99zZRqfTiW/fvl1J07TiVEIVryrZkQb2lQaIcoZmkRODIBNKTv5xawm2MTWMO+N+1gVpVFox3PPcF5nsRGiQFrh67Xrp3LlzU0KIbHZ2Npifn0e5XGZPEJKeOLSj0SzU/WKobpdFInT+wpo4dx6dAx0Gv2NnskmczCwAyLMaGVfdrbaxbd/YiUtAS0n9zc3NMhGVer1eqLVGvV7X5XLZ7cStvLDLYkV+qgHo6RDXOinXmCl/YRNgbP3LuOYImDBEY+MyPxeGaWyFQu6E0M4H5/MWYEL2tpIwkp1OJ9ZaQylFRKSTJJFxHGdBEKRuznVpXxTIYzu0vuVqeCH/IC+PhjHGZHIXj4iEAWgFaA2tNFip/O8VQWlAmZjTnOcxV4qyOdAGK4cB5to3rk9PVAe9Xi9M0zTodDrx1tZW0mq1kjRNI0/221FmiSIruT773nrljHniKIZ4VN3n7uXTfm4CVoZIydAq046gzOvFHJHmUa2mAYi4gvprZ9YnJ6qDfr8fZlkWWHCdTidSSvki7Q4VushirogpP7J6z4VGjFe0ctiM2WMO9pjfxBWR00V7OZVNwudRzZmzKoNFiFLrens1URvb29txlmWUpqnIsixQSgkp5X7rBLss5gZkCiA7VZ+6/a650tOAtYALzi0bDDy3exaUG0nz0G2H5/aRxrW1nTQNUJTgnovPXTw2O3Wz1WrFWZYFUkqhlCIAiONYB0Ggxyxu7OrHfDHTipjp5z5w33cXguxSXvgaWh7+I2MLHtG3MF3zUKgiQOcxyaYUg7Z5C8MalBmAECi3Xu++J9t8vr29HaVpKtI0FVJKwcxcKpWyarWaBUHg6/7uggeLPcRMK2QOFicrrc88tPiFiPQgT6QaGFrPsJxp9i2RWAuxtZCtOkzBZNOy7ctsfFEQ8y++8K8/WiiFrV6vF0opAymlkFIiSRI5Ozvbq9VqgyAIZEH+GlpwXIxZa1lJrP/Hp5trH1msfs2KMZp13kzmJcbQRTUXD9Y6dzfTu2lDHKzNBAgCl9+Co2e+/cLbo+65brcbSSmDLMuElJKSJFFzc3Pder3enZyc7Buqd+XwHSKPGCNBZw4wK2L2vvjoySceqUdfz99HOCWVBrPatUjETmYc9W8jQKMyTADxBN76kyfPv7vz6o8Hg0FgmFBorZEkiZyfn+80m82tRqPRiePY1fsHjua4yxXHxVnf0fm6AHrf/I23f/UTRyv/mJDqWnAm7MCszDCWUgxWuYXYDFci0CCoKIEgoZd++JWfvufWi8+qNMVgMAiVUoKIuFKppEeOHGmtrq7eWlpa2p6YmOg679V3qg7pLkEVKcHCkQdc+a3qFJ+lzz936eTfn73ym5f6dAIiBDhv90fkK3be1X1MIIAoAUCoXruwdf/Z75y9j7rrIAIRcRRFqlqtDmZnZ7eXl5dvHz9+/NbKykqrVqt1giAo0hx7vqBapN3bJOeusLgV9VC7V8ylT3/v/MPf/1nrg1dRXpFaBxh0TRll2xExwkUAylUIOUB548Wt2UtrmyuvX7hYicKuEAJRFMlSqZROTk727r333q2VlZVbx48fv7O4uLg9OTlpFWEXmAU18CXwcYsSviocOxrf0Gp2XL52feKvvvj10/92C+9/pfnOh0AE6GxU3gOACIEoxNTad6/PXDqzOd+99Xo1DtoAKIoiWalU+lNTU92FhYXto0eP3lldXb29srLSmpmZ6ZbL5Z4Dquto+30H1A7yoDEaHxW4ZewtI5W95aTk+bW1mT96/Bsfe/bkRx/WDILOzDJLDBICc0/980bztbWXy6VSXwihoyjKKpVKr1ardRqNxnaz2byzsrKytby83FpYWOiVy+VBEAT9olj3QO1aw6Y99nkUrTm7QqovQ5fSNC13u93y7/z1Pzz8neUPfbzfHyQUhBAy44Xv/dP6W6+88Gq1Wu3UarXtWq3Wnpub69Tr9Vaz2dw+cuRIu9Fo9KanpwfVajU1dG5Zr+eNsWx4EGD+orqrXrlC5o7YU0qVgiCIP/XZz3/oG/X3fTLLVNL4l7+7uNJaP99cWrp64sSJa8eOHbszPz/fnZub609PT6eVSiU11YQMgiBzSjo3l/pWGgvqIMD22jHgLwhWHZIpAYg+8Wefe/TcxuZ970j6Z0+fPn355MmTt5rNZmdmZmYQBIEyQ3q7CDKnpOu7FZBzXe0F6qDA9nPNpCAllNI0LbXb7eTmzZslZha1Wi2dnp5Ox4CR3rp06tWrmZOrpAeID7pUe7euGRekhDKARCmVSClFGIZkqnHlWaboKD0gmbcXRB9kVfNud+bwjj6leF/UsCwLgmAQBEHgpOgi60gnXoosWeR2+1rjjW4SczU+WXDdlmSRV2hLpxaVBTtzirYisdelHsjF3szutyJw7Lx46rTt7mfKs4q/l2pXb/VGth+92W19Pjj2YkgUANNjNoftteXv7rfoHdJGTCrYnkRjth3xHmAObc9ieEj3YU+x0QXrVlyg6hwqmJ8HsCLGpD0m4Oe6bRYA/m8A8FVIJHb+8hMAAAAASUVORK5CYII="});c.bindTo("map",this),c.bindTo("position",this);var e=new d.RadiusWidget(a);e.bindTo("map",this),e.bindTo("center",this,"position"),this.bindTo("distance",e),this.bindTo("bounds",e)},RadiusWidget:function(a){var b=new google.maps.Circle({strokeWeight:1,strokeColor:"#37A6CF",fillColor:"#37A6CF"}),c=a.getBounds().getCenter(),d=a.getBounds().getNorthEast(),e=google.maps.geometry.spherical.computeDistanceBetween(c,d)/1e3;this.set("distance",e/3),this.bindTo("bounds",b),b.bindTo("center",this),b.bindTo("map",this),b.bindTo("radius",this),this.addSizer_()},setHelpers:function(){d.DistanceWidget.prototype=new google.maps.MVCObject,d.RadiusWidget.prototype=new google.maps.MVCObject,d.RadiusWidget.prototype.distance_changed=function(){this.set("radius",1e3*this.get("distance"))},d.RadiusWidget.prototype.addSizer_=function(){var a=new google.maps.Marker({draggable:!0,title:"Me mova!",icon:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABoAAAAaCAYAAACpSkzOAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAIGNIUk0AAG2YAABzjgAA+YsAAIR4AAB8wwAA95IAAC/yAAARoZE2jZ4AAALBSURBVHjarJbvS5NRFMc/PtMpUQoDM6jMqBylRprhJoUQlEbRu4jo16LUBkXRC3vTfxAUhRX9gMrsdRBaVhBE0i9oy1qRsCkEWmQKkQpW27cXbXPN51mb+n04cLnPPfd7zzn3nHuyJGGF1bffxIZOoA4oBgqjc5+AfuARMGSm/3b3mvg425rEbwMOAieiRKnwBDgNdFotMMwmK9r9dRLvJS5LOCX4j9RJdEg8lVgem09JVNHu9wIP07DCDOuBl1E3WxOVt/uPCC4K7AKmKQ7BQ8HGxL2zYpeh/JavAegAbMwOhoDawN6qYNyislu+AsE1gW0GliRLoeD6P7dO4gSwMPE4OUYWPXsqpxzzauALZ32DacdsVZtv64d9VZ3GqjafDfAmr/gV0UxJYjgGkC3JnZCElhj/HeFOcJhUCW6BjStvvnYYEpus8iOGiXCEOdkG1zeXUpKfRxp5lSg2ifWGoMIqoAAXej6z614vP36GKZqTw436UkoK8jK9GE5DUqEkzOS8f5BzvgEC38bY3zVJdrN+BSX5uVjpmYjDSOXc1jeTgQ8MjyeQ2WlrKGVJfm78/05nyjDbDElD6Z7s3bcxPA8mydq3OCmeZ+dgeREt1YtS6Q4ZiA+ZOPvt1zE8CZbd2V7GyXWL/57bWq/XkNSVga+RRM/XUTz3PzIRjjDPPlmxLNaHJXVnIz0HRgBHJslROX8uubakEJvn2ONgY82IEWysCSNaM3Gfp2wBp9xLpm5pvr41Xr2XXXnhAD6mUyEyRHeoybUhXr1DTa4RxAFEmNkr36OIQ1MevlCzq1OoRczKFxbaHWp29Zq+sH3N7jOIozO07DtiG+Juyp6h77C7FbEFEZwGyStENaILpdEF9Xndj0BloOOg/jQYXoN2gGpAwX/LclLPYIall54lN5BrE36PAu+iDeSAmX6/tzY+/jMApcCWpTVr3IcAAAAASUVORK5CYII="});a.bindTo("map",this),a.bindTo("position",this,"sizer_position");var b=this;google.maps.event.addListener(a,"drag",function(){b.setDistance()})},d.RadiusWidget.prototype.center_changed=function(){var a=this.get("bounds");if(a){var b=a.getNorthEast().lng(),c=new google.maps.LatLng(this.get("center").lat(),b);this.set("sizer_position",c)}},d.RadiusWidget.prototype.distanceBetweenPoints_=function(a,b){if(!a||!b)return 0;var c=6371,d=(b.lat()-a.lat())*Math.PI/180,e=(b.lng()-a.lng())*Math.PI/180,f=Math.sin(d/2)*Math.sin(d/2)+Math.cos(a.lat()*Math.PI/180)*Math.cos(b.lat()*Math.PI/180)*Math.sin(e/2)*Math.sin(e/2),g=2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f)),h=c*g;return h},d.RadiusWidget.prototype.setDistance=function(){var a=this.get("sizer_position"),b=this.get("center"),c=this.distanceBetweenPoints_(b,a);this.set("distance",c)}},createMap:function(){var a=new google.maps.StyledMapType(this.options.styles,{name:"zup"});this.map=new google.maps.Map(c[0],this.options.map),this.map.mapTypes.set("zup",a),this.map.setMapTypeId("zup"),this.map.setCenter(this.options.homeLatlng),setTimeout(function(){google.maps.event.trigger(d.map,"resize"),google.maps.event.trigger(d.map,"bounds_changed"),d.map.setCenter(d.options.homeLatlng)},80),this.setHelpers(),google.maps.event.addListener(d.map,"click",function(a){d.addCircle(a.latLng)})},setLastCircleInfo:function(a){b.lastCirclePosition=a.get("position"),b.lastCircleDistance=a.get("distance"),b.lastCircleArea=a.get("distance")*a.get("distance")*Math.PI},addCircle:function(a){var b=new d.DistanceWidget(d.map,a);d.circles.push(b),d.setLastCircleInfo(b),google.maps.event.removeListener(d.lastListenerDistance),google.maps.event.removeListener(d.lastListenerPosition),d.lastListenerDistance=google.maps.event.addListener(b,"distance_changed",function(){d.setLastCircleInfo(b)}),d.lastListenerPosition=google.maps.event.addListener(b,"position_changed",function(){d.setLastCircleInfo(b)})}};d.createMap(),b.$parent.circles=d.circles,b.map=d.map,b.eraseAllCircles=function(){for(var a=d.circles.length-1;a>=0;a--)d.circles[a].set("map",null);d.circles=[]},b.eraseLastCircle=function(){d.circles[d.circles.length-1].set("map",null),d.circles.splice(d.circles.length-1,1)},b.fitCirclesBounds=function(){if(0!==d.circles.length){for(var a=new google.maps.LatLngBounds,b=d.circles.length-1;b>=0;b--)a.extend(d.circles[b].get("bounds").getNorthEast()),a.extend(d.circles[b].get("bounds").getSouthWest());d.map.fitBounds(a)}},b.addCircleByLatLng=function(a,c){d.addCircle(new google.maps.LatLng(a,c)),b.fitCirclesBounds()}}}}]),angular.module("FieldsFilterItemComponentModule",[]).directive("fieldsFilterItem",function(){return{restrict:"A",link:function(a){a.changeCondition=function(b){a.item.condition=b},a.$watch("item.fieldId",function(){if(null!==a.item.fieldId)for(var b=a.item.category.fields.length-1;b>=0;b--)a.item.category.fields[b].id==a.item.fieldId&&(a.item.field=a.item.category.fields[b])}),a.changeField=function(b){a.item.field=b},a["delete"]=function(){a.$parent.items.splice(a.$parent.items.indexOf(a.item),1)}}}}),angular.module("MapShowItemComponentModule",[]).directive("mapShowItem",["$timeout","$q","$rootScope","$compile",function(a,b,c,d){return{restrict:"A",link:function(a,b){var c={options:{styles:[{},{featureType:"poi.business",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.government",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.medical",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.school",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.sports_complex",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"off"},{saturation:-100},{lightness:42}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{saturation:-100},{lightness:47}]},{featureType:"landscape",stylers:[{lightness:82},{saturation:-100}]},{featureType:"water",stylers:[{hue:"#00b2ff"},{saturation:-21},{lightness:-4}]},{featureType:"poi",stylers:[{lightness:19},{weight:.1},{saturation:-22}]},{elementType:"geometry.fill",stylers:[{visibility:"on"},{lightness:18}]},{elementType:"labels.text",stylers:[{saturation:-100},{lightness:28}]},{featureType:"poi.attraction",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{saturation:12},{lightness:25}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.text",stylers:[{lightness:30}]},{featureType:"landscape.man_made",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{saturation:-100},{lightness:56}]},{featureType:"road.local",elementType:"geometry.fill",stylers:[{lightness:62}]},{featureType:"landscape.man_made",elementType:"geometry",stylers:[{visibility:"off"}]}],homeLatlng:new google.maps.LatLng(-23.549671,-46.6321713),map:{zoom:15,scrollwheel:!1,mapTypeControl:!1,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"zup"]}}},map:null,start:function(){var d=new google.maps.StyledMapType(this.options.styles,{name:"zup"});this.map=new google.maps.Map(b[0],this.options.map),this.map.mapTypes.set("zup",d),this.map.setMapTypeId("zup"),a.$watch("loading",function(){"undefined"!=typeof a.item&&setTimeout(function(){google.maps.event.trigger(c.map,"resize"),google.maps.event.trigger(c.map,"bounds_changed"),c.map.setCenter(c.options.homeLatlng),c.addMarker(a.item,a.category)},80)})},addMarker:function(b,e){var f,g,h=new google.maps.LatLng(b.position.latitude,b.position.longitude),i=c.infoWindow;"marker"===e.plot_format?(f=new google.maps.Size(54,51),g=e.marker.retina.web):(f=new google.maps.Size(15,15),g=e.pin.retina.web);var j=new google.maps.MarkerImage(g,null,null,null,f),k={position:h,map:this.map,icon:j,category:e,item:b},l=new google.maps.Marker(k);this.map.setCenter(h),google.maps.event.addListener(l,"click",function(){var b="<div class=\"pinTooltip\"><h1>{{category.title}}</h1><p>Enviada {{ item.created_at | date: 'dd/MM/yy HH:mm'}}</p></div>",e=a.$new(!0);e.category=this.category,e.item=this.item;var f=d(b)(e);e.$apply(),i.setContent(f[0]),i.open(c.map,this)})}};c.start()}}}]),angular.module("MapShowReportComponentModule",[]).directive("mapShowReport",["$timeout","$q","$rootScope","$compile",function(a,b,c,d){return{restrict:"A",link:function(a,b){var c={options:{styles:[{},{featureType:"poi.business",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.government",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.medical",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.school",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.sports_complex",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"off"},{saturation:-100},{lightness:42}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{saturation:-100},{lightness:47}]},{featureType:"landscape",stylers:[{lightness:82},{saturation:-100}]},{featureType:"water",stylers:[{hue:"#00b2ff"},{saturation:-21},{lightness:-4}]},{featureType:"poi",stylers:[{lightness:19},{weight:.1},{saturation:-22}]},{elementType:"geometry.fill",stylers:[{visibility:"on"},{lightness:18}]},{elementType:"labels.text",stylers:[{saturation:-100},{lightness:28}]},{featureType:"poi.attraction",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{saturation:12},{lightness:25}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.text",stylers:[{lightness:30}]},{featureType:"landscape.man_made",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{saturation:-100},{lightness:56}]},{featureType:"road.local",elementType:"geometry.fill",stylers:[{lightness:62}]},{featureType:"landscape.man_made",elementType:"geometry",stylers:[{visibility:"off"}]}],homeLatlng:new google.maps.LatLng(-23.549671,-46.6321713),map:{zoom:15,scrollwheel:!1,mapTypeControl:!1,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"zup"]}}},infoWindow:new google.maps.InfoWindow,map:null,start:function(){var d=new google.maps.StyledMapType(this.options.styles,{name:"zup"});this.map=new google.maps.Map(b[0],this.options.map),this.map.mapTypes.set("zup",d),this.map.setMapTypeId("zup"),a.$watch("loading",function(){"undefined"!=typeof a.report&&setTimeout(function(){google.maps.event.trigger(c.map,"resize"),google.maps.event.trigger(c.map,"bounds_changed"),c.map.setCenter(c.options.homeLatlng),c.addMarker(a.report,a.category)},80)})},addMarker:function(b,e){var f=new google.maps.LatLng(b.position.latitude,b.position.longitude),g=c.infoWindow,h=new google.maps.Size(54,51),i=new google.maps.MarkerImage(e.marker.retina.web,null,null,null,h),j={position:f,map:this.map,icon:i,category:e,report:b},k=new google.maps.Marker(j);this.map.setCenter(f),google.maps.event.addListener(k,"click",function(){var b="<div class=\"pinTooltip\"><h1>{{category.title}}</h1><p>Enviada {{ report.created_at | date: 'dd/MM/yy HH:mm'}}</p></div>",e=a.$new(!0);e.category=this.category,e.report=this.report;var f=d(b)(e);e.$apply(),g.setContent(f[0]),g.open(c.map,this)})}};c.start()}}}]),angular.module("MapViewStreetviewComponentModule",[]).directive("mapViewStreetview",function(){return{restrict:"A",scope:{latitude:"=",longitude:"="},link:function(a,b){function c(b,c){if(c!=google.maps.StreetViewStatus.OK)return a.$parent.hideStreetview=!0,void a.$apply();var e=d(g,b.location.latLng),h={position:g,addressControl:!0,linksControl:!0,panControl:!1,zoomControlOptions:{style:google.maps.ZoomControlStyle.SMALL},pov:{heading:e,pitch:10,zoom:1},enableCloseButton:!1,visible:!0};f.setOptions(h)}function d(a,b){var c=57.2957795,d=.017453,f=a.lat()-b.lat(),g=a.lng()-b.lng(),h=Math.atan2(g*Math.cos(a.lat()*d),f)*c;return e(h)}function e(a){return a>=360?a-=360:0>a&&(a+=360),a}var f=new google.maps.StreetViewPanorama(b.find(".roundedMap").get(0)),g=new google.maps.LatLng(a.latitude,a.longitude),h=new google.maps.StreetViewService;h.getPanoramaByLocation(g,50,c);var i=function(a,b){var c,d,e=new google.maps.LatLng(a.position.latitude,a.position.longitude);"marker"===b.plot_format?(c=new google.maps.Size(54,51),d=b.marker.retina.web):(c=new google.maps.Size(15,15),d=b.pin.retina.web);{var g=new google.maps.MarkerImage(d,null,null,null,c),h={position:e,map:f,icon:g,category:b,item:a};new google.maps.Marker(h)}};i(a.$parent.item,a.$parent.category)}}}),angular.module("SelectLatLngMapComponent",[]).directive("selectLatLngMap",["$rootScope","ENV",function(a,b){return{restrict:"A",link:function(c,d){var e={options:{styles:[{},{featureType:"poi.business",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.government",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.medical",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.school",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.sports_complex",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"off"},{saturation:-100},{lightness:42}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{saturation:-100},{lightness:47}]},{featureType:"landscape",stylers:[{lightness:82},{saturation:-100}]},{featureType:"water",stylers:[{hue:"#00b2ff"},{saturation:-21},{lightness:-4}]},{featureType:"poi",stylers:[{lightness:19},{weight:.1},{saturation:-22}]},{elementType:"geometry.fill",stylers:[{visibility:"on"},{lightness:18}]},{elementType:"labels.text",stylers:[{saturation:-100},{lightness:28}]},{featureType:"poi.attraction",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{saturation:12},{lightness:25}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.text",stylers:[{lightness:30}]},{featureType:"landscape.man_made",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{saturation:-100},{lightness:56}]},{featureType:"road.local",elementType:"geometry.fill",stylers:[{lightness:62}]},{featureType:"landscape.man_made",elementType:"geometry",stylers:[{visibility:"off"}]}],homeLatlng:new google.maps.LatLng(b.mapLat,b.mapLng),map:{zoom:parseInt(b.mapZoom),scrollwheel:!1,mapTypeControl:!1,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,"zup"]}}},map:null,mainMarker:null,start:function(){var a=new google.maps.StyledMapType(this.options.styles,{name:"zup"});this.map=new google.maps.Map(d[0],this.options.map),this.map.mapTypes.set("zup",a),this.map.setMapTypeId("zup");var b;null===c.$parent.latLng[0]&&null===c.$parent.latLng[1]?b=e.options.homeLatlng:(b=new google.maps.LatLng(c.$parent.latLng[0],c.$parent.latLng[1]),e.changedMarkerPosition(c.$parent.latLng[0],c.$parent.latLng[1]));var f=new google.maps.MarkerImage(c.$parent.category.marker.retina.web,null,null,null,new google.maps.Size(54,51)),g=new google.maps.Marker({map:e.map,draggable:!0,animation:google.maps.Animation.DROP,position:b,icon:f});e.mainMarker=g,e.map.setCenter(b),google.maps.event.addListener(g,"dragend",function(){c.$parent.latLng[0]=e.mainMarker.getPosition().lat(),c.$parent.latLng[1]=e.mainMarker.getPosition().lng(),e.changedMarkerPosition(e.mainMarker.getPosition().lat(),e.mainMarker.getPosition().lng())})},changedMarkerPosition:function(a,b,d,e){var f=new google.maps.Geocoder;c.$parent.latLng=[a,b],c.$parent.addressComponents=null,c.$parent.formattedAddress=null,"undefined"!=typeof d&&(c.$parent.addressComponents=d),"undefined"!=typeof e&&(c.$parent.formattedAddress=e),f.geocode({latLng:new google.maps.LatLng(a,b)},function(a,b){b===google.maps.GeocoderStatus.OK&&("undefined"==typeof d&&(c.$parent&&(c.$parent.addressComponents=a[0].address_components,c.$parent.formattedAddress=a[0].formatted_address),c.formattedAddress=a[0].formatted_address),c.$apply())})}};e.start(),a.selectLatLngMap=e}}}]),angular.module("SearchLatLngMapComponent",[]).directive("searchLatLngMap",["$rootScope",function(a){return{restrict:"A",link:function(b,c){a.$watch("selectLatLngMap",function(){if("undefined"!=typeof a.selectLatLngMap){google.maps.event.clearListeners(a.selectLatLngMap.map);var b={types:["geocode"],componentRestrictions:{country:"br"}},d=new google.maps.places.Autocomplete(c[0],b);d.bindTo("bounds",a.selectLatLngMap.map),google.maps.event.addListener(d,"place_changed",function(){var b=d.getPlace();b.geometry&&(b.geometry.viewport?a.selectLatLngMap.map.fitBounds(b.geometry.viewport):(a.selectLatLngMap.map.setCenter(b.geometry.location),a.selectLatLngMap.map.setZoom(17)),a.selectLatLngMap.mainMarker.setPosition(b.geometry.location),a.selectLatLngMap.changedMarkerPosition(b.geometry.location.lat(),b.geometry.location.lng(),b.address_components,b.formatted_address))})}})}}}]),angular.module("NgThumbComponentModule",[]).directive("ngThumb",["$window",function(a){var b={support:!(!a.FileReader||!a.CanvasRenderingContext2D),isFile:function(b){return angular.isObject(b)&&b instanceof a.File},isImage:function(a){var b="|"+a.type.slice(a.type.lastIndexOf("/")+1)+"|";return-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(b)}};return{restrict:"A",template:"<canvas/>",link:function(a,c,d){function e(a){var b=new Image;b.onload=f,b.src=a.target.result}function f(){var a=g.width||this.width/this.height*g.height,b=g.height||this.height/this.width*g.width;h.attr({width:a,height:b}),h[0].getContext("2d").drawImage(this,0,0,a,b)}if(b.support){var g=a.$eval(d.ngThumb);if(b.isFile(g.file)&&b.isImage(g.file)){var h=c.find("canvas"),i=new FileReader;i.onload=e,i.readAsDataURL(g.file)}}}}}]),angular.module("InputsSidebarComponentModule",[]).directive("inputsSidebar",function(){return{restrict:"A",link:function(a,b){b.affix({offset:{top:75}})}}}),angular.module("InventoryDraggableInputComponentModule",[]).directive("inventoryDraggableInput",function(){return{restrict:"A",link:function(a,b){b.draggable({connectToSortable:".droppableInputsArea",revert:"invalid",helper:function(){return $('<div class="customDraggableHelper">'+b.find("p").html()+"</div>")},start:function(a,b){$(b.helper).css("width","auto").css("height","auto")}})}}}),angular.module("InventoryDroppableInputsAreaComponentModule",[]).directive("inventoryDroppableInputsArea",function(){return{restrict:"A",link:function(a,b){var c=null,d=function(){b.find(".input").each(function(){$(this).scope().field.position=$(this).index()}),a.$apply()};b.sortable({revert:!0,handle:".handle",forcePlaceholderSize:!1,placeholder:{element:function(){return $('<div class="customSortablePlaceholder"><p>Solte para adicionar</p></div>')},update:function(){}},receive:function(a,b){var d=b.item.attr("name"),e=b.item.find("p").html(),f={kind:d,label:'Novo "'+e+'"',title:null,location:!1,maximum:null,minimum:null,required:!1,size:"M",inventory_fields_can_view:[],inventory_fields_can_edit:[],field_options:[],position:null};c=f},update:function(b,d){var e=$(d.item).index();if(null!==c){$(this).find(".item").remove(),c.position=e;for(var f=a.section.fields.length-1;f>=0;f--)a.section.fields[f].position===e&&(a.section.fields[f].position=a.section.fields[f].position+.5);a.section.fields.push(c),a.$apply(),c=null}},start:function(a,b){$(b.helper).addClass("helper"),d()},stop:function(a,b){$(b.item).removeClass("helper"),d()}})}}}),angular.module("InventoryEditLabelComponentModule",[]).directive("inventoryEditLabel",["$timeout","$rootScope",function(a,b){return{restrict:"A",link:function(c,d,e){c.editLabel=function(){"section"===e.inventoryEditLabel?(c.label=angular.copy(c.section.title),c.editingSectionLabel=!0):(c.label=angular.copy(c.field.label),c.editingLabel=!0),a(function(){d.find(".editLabelField").focus()})},c.saveLabel=function(){return 0===c.label.length?void b.showMessage("exclamation-sign","Você não pode deixar o título do campo em branco.","error"):void("section"===e.inventoryEditLabel?(c.section.title=c.label,c.editingSectionLabel=!1):(c.field.label=c.label,c.editingLabel=!1))},d.find(".editLabelField").keyup(function(a){13===a.keyCode&&(c.saveLabel(),c.$apply()),27===a.keyCode&&("section"===e.inventoryEditLabel?c.editingSectionLabel=!1:c.editingLabel=!1,c.$apply())})}}}]),angular.module("InventoryEditSectionComponentModule",[]).directive("inventoryEditSection",function(){return{restrict:"A",link:function(a){a.$watch("section.permissions",function(b,c){if(b!==c)for(var d=_.difference(c.groups_can_edit,b.groups_can_edit),e=_.difference(b.groups_can_edit,c.groups_can_edit),f=_.difference(c.groups_can_view,b.groups_can_view),g=_.difference(b.groups_can_view,c.groups_can_view),h=a.section.fields.length-1;h>=0;h--)e&&(a.section.fields[h].permissions.groups_can_edit=_.union(a.section.fields[h].permissions.groups_can_edit,e)),g&&(a.section.fields[h].permissions.groups_can_view=_.union(a.section.fields[h].permissions.groups_can_view,g)),d&&(a.section.fields[h].permissions.groups_can_edit=_.difference(a.section.fields[h].permissions.groups_can_edit,d)),f&&(a.section.fields[h].permissions.groups_can_view=_.difference(a.section.fields[h].permissions.groups_can_view,f))},!0)}}}),angular.module("InventoryCreateValueComponentModule",[]).directive("InventoryCreateValue",function(){return{restrict:"A",link:function(a){var b=1;a.newValue=function(){a.field.available_values.push("Nova opção "+b),b++}}}}),angular.module("InventoryPopoverComponentModule",[]).directive("inventoryPopover",function(){return{restrict:"A",link:function(a){a.popover={permissions:!1,options:!1,remove:!1},a.$on("hideOpenPopovers",function(){for(var b in a.popover)a.popover[b]===!0&&(a.popover[b]=!1)})}}}),angular.module("InventoryPopoverLinkComponentModule",[]).directive("inventoryPopoverLink",function(){return{restrict:"A",link:function(a){a.openPopover=function(b){a.$emit("hidePopovers",!0),a.popover[b]=!0}}}}),angular.module("InventoryTriggerConditionComponentModule",[]).directive("inventoryTriggerCondition",["Restangular",function(){return{restrict:"A",scope:{category:"="},link:function(a){a.$parent.$watch("condition.inventory_field_id",function(){_.each(a.category.sections,function(b){var c=_.findWhere(b.fields,{id:parseInt(a.$parent.condition.inventory_field_id,10)});return _.isUndefined(c)?void 0:void(a.$parent.condition.field=c)})})}}}]),angular.module("InventoryTriggerComponentModule",[]).directive("inventoryTrigger",["Restangular",function(a){return{restrict:"A",link:function(b){b.trigger.isNew===!0&&(b.editing=!0),b.types=[{id:"equal_to",name:"Igual"},{id:"different",name:"Diferente"},{id:"greater_than",name:"Maior"},{id:"lesser_than",name:"Menor"},{id:"includes",name:"Inclui"},{id:"between",name:"Entre"}],b.removeTrigger=function(){if(b.trigger.isNew!==!0){b.processingForm=!0;var c=a.one("inventory").one("categories",b.$parent.category.id).one("formulas",b.trigger.id).remove();c.then(function(){b.$parent.triggers.splice(b.$parent.triggers.indexOf(b.trigger),1),b.processingForm=!1})}else b.$parent.triggers.splice(b.$parent.triggers.indexOf(b.trigger),1)},b.newCondition=function(){b.trigger.conditions.push({inventory_field_id:null,operator:"equal_to",content:null})},b.removeCondition=function(a){a._destroy=!0},b.saveTrigger=function(){b.processingForm=!0;for(var c=[],d=b.trigger.conditions.length-1;d>=0;d--){var e=b.trigger.conditions[d],f={inventory_field_id:e.inventory_field_id,operator:e.operator,content:e.content};_.isUndefined(e.id)||(f.id=e.id),_.isUndefined(e._destroy)||1!=e._destroy||(f._destroy=!0),c.push(f)}var g,h={inventory_status_id:b.trigger.inventory_status_id,conditions:c,groups_to_alert:[],run_formula:b.trigger.run_formula},i=a.one("inventory").one("categories",b.$parent.category.id);g=b.trigger.isNew===!0?i.post("formulas",h):i.one("formulas",b.trigger.id).customPUT(h),g.then(function(){b.showMessage("ok","O gatilho foi atualizado com sucesso!","success"),b.processingForm=!1})}}}}]),angular.module("InventorySortableSectionsComponentModule",[]).directive("inventorySortableSections",function(){return{restrict:"A",link:function(a,b){var c=function(){b.find(".section").each(function(){
$(this).scope().section.position=$(this).index()}),a.$apply()};b.sortable({revert:!0,handle:".handle",forcePlaceholderSize:!1,placeholder:{element:function(){return $('<div class="customSortablePlaceholder"><p>Solte para re-ordenar</p></div>')},update:function(){}},start:function(a,b){$(b.helper).addClass("helper"),c()},stop:function(a,b){$(b.item).removeClass("helper"),c()}})}}}),angular.module("InventorySingleValueComponentModule",[]).directive("inventorySingleValue",["Restangular",function(a){return{restrict:"A",link:function(b){b.newValue=angular.copy(b.option.value),b.saveOption=function(){if(b.editingValue=!1,b.isExistingField){b.updating=!0;var c=a.all("inventory").one("fields",b.field.id).one("options",b.option.id).customPUT({value:b.newValue});c.then(function(){b.updating=!1})}b.option.value=b.newValue},b.removeOption=function(){var c=b.$parent.field.field_options.indexOf(b.option);if(b.isExistingField){b.updating=!0;var d=a.all("inventory").one("fields",b.field.id).one("options",b.option.id).remove();d.then(function(){b.updating=!1})}-1!==c&&(b.option.disabled=!0)}}}}]),angular.module("GalleryComponentModule",["GalleryModalControllerModule"]).directive("gallery",function(){return{restrict:"E",templateUrl:"components/gallery/gallery.template.html",scope:{images:"="},replace:!0,controller:["$scope","$modal",function(a,b){a.show=function(a){b.open({templateUrl:"modals/gallery/gallery.template.html",windowClass:"gallery-modal",controller:"GalleryModalController",resolve:{image:function(){return a}}})}}]}}),angular.module("FeatureFlagComponentModule",[]).directive("featureFlag",["Restangular",function(a){return{restrict:"A",link:function(b){b.$watch("flag.enabled",function(c,d){if(c!==d){b.loading=!0;var e=a.one("feature_flags",b.flag.id).customPUT({status:b.flag.enabled===!0?1:0});e.then(function(){b.loading=!1})}})}}}]),angular.module("GenericInputComponentModule",[]).directive("genericInput",function(){return{restrict:"A",link:function(a,b){a.$watch("inputErrors",function(){var c=a.inputErrors,d=$(b).closest(".form-group");if(b.removeClass("has-error"),d.removeClass("has-error"),"undefined"!=typeof c)for(var e in c)e===b.attr("name")&&(b.addClass("has-error"),d.addClass("has-error"))}),a.$parent.$watch("processingForm",function(){a.$parent.processingForm===!0?b.attr("disabled",!0):b.attr("disabled",!1)})}}}),angular.module("KeyboardPosterComponentModule",[]).directive("keyboardPoster",["$parse","$timeout",function(a,b){var c=700;return function(d,e,f){var g=angular.element(e)[0],h=null;g.onkeydown=function(){var g=a(f.keyboardPoster),i=g(d);h&&b.cancel(h),h=b(function(){i(e.val())},c)}}}]),angular.module("DetectScrollTopComponentModule",[]).directive("detectScrollTop",function(){return{restrict:"A",link:function(a,b){a.$watch("scrollTop",function(){a.scrollTop===!0&&(b.animate({scrollTop:0},900),a.scrollTop=!1)})}}}),angular.module("MapNewReportComponentModule",[]).directive("mapNewReport",["$compile","$timeout","Restangular","ENV",function(a,b,c,d){return{restrict:"A",link:function(a,e){var f={options:{styles:[{},{featureType:"poi.business",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.government",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.medical",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.place_of_worship",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.school",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.sports_complex",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels",stylers:[{visibility:"off"},{saturation:-100},{lightness:42}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{saturation:-100},{lightness:47}]},{featureType:"landscape",stylers:[{lightness:82},{saturation:-100}]},{featureType:"water",stylers:[{hue:"#00b2ff"},{saturation:-21},{lightness:-4}]},{featureType:"poi",stylers:[{lightness:19},{weight:.1},{saturation:-22}]},{elementType:"geometry.fill",stylers:[{visibility:"on"},{lightness:18}]},{elementType:"labels.text",stylers:[{saturation:-100},{lightness:28}]},{featureType:"poi.attraction",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{saturation:12},{lightness:25}]},{featureType:"road",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road",elementType:"labels.text",stylers:[{lightness:30}]},{featureType:"landscape.man_made",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{saturation:-100},{lightness:56}]},{featureType:"road.local",elementType:"geometry.fill",stylers:[{lightness:62}]},{featureType:"landscape.man_made",elementType:"geometry",stylers:[{visibility:"off"}]}],homeLatlng:new google.maps.LatLng(d.mapLat,d.mapLng),map:{zoom:parseInt(d.mapZoom),mapTypeControl:!1,panControl:!0,panControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT},zoomControl:!0,zoomControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT},scaleControl:!0,scaleControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT},streetViewControl:!0,streetViewControlOptions:{position:google.maps.ControlPosition.TOP_RIGHT}}},zoomLevels:{},currentZoom:parseInt(d.mapZoom),map:null,getNewItemsTimeout:null,hideNotVisibleMarkersTimeout:null,doAnimation:!0,activeMethod:"reports",activeInventoryFilters:[],hiddenReportsCategories:[],hiddenInventoryCategories:[],mainMarker:null,allows_arbitrary_position:!0,start:function(){this.createMap(),this.setListeners()},createMap:function(){this.zoomLevels={},this.currentZoom=11;var a=new google.maps.StyledMapType(this.options.styles,{name:"zup"});this.map=new google.maps.Map(e[0],this.options.map),this.map.mapTypes.set("zup",a),this.map.setMapTypeId("zup"),this.map.setCenter(this.options.homeLatlng),setTimeout(function(){google.maps.event.trigger(f.map,"resize"),google.maps.event.trigger(f.map,"bounds_changed"),f.map.setCenter(f.options.homeLatlng)},80)},setListeners:function(){a.$watch("categoryData",function(){f.createMap(),setTimeout(function(){if(google.maps.event.trigger(f.map,"resize"),google.maps.event.trigger(f.map,"bounds_changed"),f.map.setCenter(f.options.homeLatlng),null!==a.categoryData)if(0==a.categoryData.inventory_categories.length){var b=new google.maps.MarkerImage(a.categoryData.marker.retina.web,null,null,null,new google.maps.Size(54,51)),c=new google.maps.Marker({map:f.map,draggable:!0,animation:google.maps.Animation.DROP,position:f.options.homeLatlng,icon:b});f.mainMarker=c,f.allows_arbitrary_position=!0,a.$apply(),google.maps.event.addListener(c,"dragend",function(){f.changedMarkerPosition(f.mainMarker.getPosition().lat(),f.mainMarker.getPosition().lng())})}else google.maps.event.addListener(f.map,"bounds_changed",function(){f.boundsChanged()}),google.maps.event.trigger(f.map,"bounds_changed"),f.allows_arbitrary_position=!1,f.mainMarker=null,a.$apply();a.lat=null,a.lng=null,a.itemId=null,a.formattedAddress=null,a.$apply()},80)})},changedMarkerPosition:function(b,c,d){var e=new google.maps.Geocoder;"undefined"==typeof d?(a.lat=b,a.lng=c):a.itemId=d,e.geocode({latLng:new google.maps.LatLng(b,c)},function(b,c){c===google.maps.GeocoderStatus.OK&&(a.formattedAddress=b[0].formatted_address,a.$apply())})},boundsChanged:function(d){var e=!1;"undefined"==typeof this.zoomLevels[this.map.getZoom()]&&(this.zoomLevels[this.map.getZoom()]={}),this.currentZoom!==this.map.getZoom()&&(e=!0,this.currentZoom=this.map.getZoom()),this.hideNotVisibleMarkersTimeout&&b.cancel(this.hideNotVisibleMarkersTimeout),this.hideNotVisibleMarkersTimeout=b(function(){f.hideNotVisibleMarkers()},200),this.getNewItemsTimeout&&b.cancel(this.getNewItemsTimeout),a.isLoadingItems=!0,this.getNewItemsTimeout=b(function(){for(var b=[],g=a.categoryData.inventory_categories.length-1;g>=0;g--)b.push(a.categoryData.inventory_categories[g].id);var h=c.all("inventory").all("items").getList({"position[latitude]":f.map.getCenter().lat(),"position[longitude]":f.map.getCenter().lng(),"position[distance]":f.getDistance(),zoom:f.map.getZoom(),limit:100,inventory_category_id:b.join()});h.then(function(b){a.isLoadingItems=!1,d===!0&&f.removeAllMarkers(),e&&f.hideAllMarkersFromInactiveLevels();for(var c=b.data.length-1;c>=0;c--)f.addMarker(b.data[c],f.doAnimation);f.doAnimation===!0&&(f.doAnimation=!1)})},1e3)},hideNotVisibleMarkers:function(){angular.forEach(this.zoomLevels[this.map.getZoom()],function(a){if(f.isMarkerInsideBounds(a)){var b;"report"===a.type&&(b=f.hiddenReportsCategories.indexOf(a.item.category_id)),"item"===a.type&&(b=f.hiddenInventoryCategories.indexOf(a.item.inventory_category_id)),~b||a.setVisible(!0)}else a.setVisible(!1)})},hideAllMarkersFromInactiveLevels:function(){angular.forEach(this.zoomLevels,function(a,b){console.log(b,f.currentZoom),b!=f.currentZoom&&angular.forEach(a,function(a){a.setVisible(!1)})})},isMarkerInsideBounds:function(a){return this.map.getBounds().contains(a.getPosition())},addMarker:function(b,c,d){if("undefined"==typeof this.zoomLevels[this.map.getZoom()][d+"_"+b.id]){var e=new google.maps.LatLng(b.position.latitude,b.position.longitude),g=(new google.maps.InfoWindow,a.getInventoryCategory(b.inventory_category_id)),h=new google.maps.Size(15,15),i=(a.viewItem,"item"),j=(f.hiddenInventoryCategories.indexOf(b.inventory_category_id),new google.maps.MarkerImage(g.pin.retina.web,null,null,null,h)),k={position:e,map:this.map,icon:j,category:g,item:b,type:i};"undefined"!=typeof c&&c===!0&&(k.animation=google.maps.Animation.DROP);var l=new google.maps.Marker(k);this.zoomLevels[this.map.getZoom()][d+"_"+b.id]=l,google.maps.event.addListener(l,"click",function(){var b=new google.maps.LatLng(this.item.position.latitude,this.item.position.longitude);if(f.changedMarkerPosition(this.item.position.latitude,this.item.position.longitude,this.item.id),null===f.mainMarker){var c=new google.maps.MarkerImage(a.categoryData.marker.retina.web,null,null,null,new google.maps.Size(54,51)),d=new google.maps.Marker({map:f.map,animation:google.maps.Animation.DROP,position:b,icon:c});f.mainMarker=d}else f.mainMarker.setPosition(b)})}},getDistance:function(){var a=this.map.getBounds(),b=a.getCenter(),c=a.getNorthEast(),d=google.maps.geometry.spherical.computeDistanceBetween(b,c);return d}};f.start(),a.mapProvider=f}}}]),angular.module("ReportStatusComponentModule",[]).directive("reportStatus",function(){return{restrict:"A",link:function(a){a.$parent.$parent.updating===!0&&a.$watch("status",function(b,c){b!==c&&(a.$parent.$parent.updateStatuses[c.id]=a.status)},!0)}}}),angular.module("ReportSearchMapComponentModule",[]).directive("reportSearchMap",["$timeout",function(a){return{restrict:"A",link:function(b,c){b.$watch("mapProvider",function(){if("undefined"!=typeof b.mapProvider){google.maps.event.clearListeners(b.mapProvider.map);var d={types:["geocode"],componentRestrictions:{country:"br"}},e=new google.maps.places.Autocomplete(c[0],d);e.bindTo("bounds",b.mapProvider.map);var f=function(c,d){return d!=google.maps.places.PlacesServiceStatus.OK?void a(function(){b.showLoadingForAutocompleteRequest=!1}):void 0};b.showLoading=function(){b.showLoadingForAutocompleteRequest=!0;var a=new google.maps.places.AutocompleteService;a.getQueryPredictions({input:c[0]},f)},google.maps.event.addListener(e,"place_changed",function(){var a=e.getPlace();if(a.geometry)if(a.geometry.viewport?b.mapProvider.map.fitBounds(a.geometry.viewport):(b.mapProvider.map.setCenter(a.geometry.location),b.mapProvider.map.setZoom(17)),1==b.mapProvider.allows_arbitrary_position)b.mapProvider.mainMarker.setPosition(a.geometry.location),b.mapProvider.changedMarkerPosition(a.geometry.location.lat(),a.geometry.location.lng());else{var c=new google.maps.Marker({map:b.mapProvider.map,position:a.geometry.location});c.setIcon({url:a.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(35,35)})}})}})}}}]),angular.module("GalleryImageOnLoadComponentModule",[]).directive("galleryImageOnLoad",["$window",function(){return{restrict:"A",link:function(a,b){b.bind("load",function(){a.$apply(function(){a.loading=!1,a.$parent.imageDimensions={width:b.width(),height:b.height()}})})}}}]),angular.module("CopyTextComponentModule",[]).directive("copyText",function(){return{link:function(a,b){b.find(".form-control").on("click",function(){this.select()});var c=new ZeroClipboard(b.find(".btn-custom"));c.on("ready",function(){c.on("aftercopy",function(){b.find(".form-control").select(),b.addClass("has-success"),a.copied=!0,a.$apply()})})}}}),angular.module("FlowsCreateValueComponentModule",[]).directive("flowsCreateValue",function(){return{restrict:"A",link:function(a){a.newValue=function(){a.field.values[0]="Nova opção"}}}}),angular.module("FlowsDroppableInputsAreaComponentModule",[]).directive("flowsDroppableInputsArea",["Restangular","$timeout",function(a){return{restrict:"A",link:function(b,c){var d=null;b.updateFieldsOrder=function(){for(var c=[],d=!1,e=b.fields.length-1;e>=0;e--)"undefined"!=typeof b.fields[e].id&&(c[b.fields[e].position]=b.fields[e].id);for(var e=c.length-1;e>=0;e--)"undefined"==typeof c[e]&&(d=!0);d||0!==c.length&&a.one("flows",b.flow.id).one("steps",b.step.id).all("fields").customPUT({ids:c})};var e=function(a){c.find(".input").each(function(){$(this).scope().field.position=$(this).index()}),b.$apply(),a===!0&&b.updateFieldsOrder()};c.sortable({revert:!0,handle:".handle",forcePlaceholderSize:!1,placeholder:{element:function(){return $('<div class="customSortablePlaceholder"><p>Solte para adicionar</p></div>')},update:function(){}},receive:function(a,c){var e=c.item.attr("name"),f={field_type:e,title:"Novo "+e,maximum:null,minimum:null,presence:!1,position:null};b.kindHasMultipleOptions(e)===!0&&(f.values={0:"Novo item"}),d=f},update:function(a,c){var e=$(c.item).index();if(null!==d){$(this).find(".item").remove(),d.position=e;for(var f=b.fields.length-1;f>=0;f--)b.fields[f].position===e&&(b.fields[f].position=b.fields[f].position+.5);b.fields.push(d),b.$apply(),d=null}},start:function(a,b){$(b.helper).addClass("helper"),e()},stop:function(a,b){$(b.item).removeClass("helper"),e(!0)}})}}}]),angular.module("FlowsResolutionStateComponentModule",[]).directive("flowsResolutionState",["Restangular",function(a){return{restrict:"A",link:function(b){b.saveTitle=function(){var c=a.one("flows",b.flow.id).one("resolution_states",b.state.id).customPUT({title:b.state.title});c.then(function(){b.editTitle=!1})},b.changeDefaultState=function(){var c=a.one("flows",b.flow.id).one("resolution_states",b.state.id).customPUT({title:b.state.title,"default":b.state["default"]});c.then(function(){})},b.removeState=function(){var c=a.one("flows",b.flow.id).one("resolution_states",b.state.id).remove();c.then(function(){b.$parent.$parent.flow.resolution_states.splice(b.$parent.$parent.flow.resolution_states.indexOf(b.state),1),b.showRemoveState=!1})}}}}]),angular.module("FlowsSingleValueComponentModule",[]).directive("flowsSingleValue",function(){return{restrict:"A",link:function(a){a.editValue=angular.copy(a.value),a.saveValue=function(){a.editingValue=!1;var b=a.$parent.field.available_values.indexOf(a.value);a.$parent.field.available_values[b]=a.editValue},a.removeValue=function(b){var c=a.$parent.field.available_values.indexOf(b);-1!==c&&a.$parent.field.available_values.splice(c,1)}}}}),angular.module("FlowsStepFieldComponentModule",[]).directive("flowsStepField",["Restangular",function(a){return{restrict:"A",link:function(b){if("undefined"!=typeof b.field.id)b.field.position=b.field.order_number-1;else{b.savingField=!0;var c=a.one("flows",b.flow.id).one("steps",b.step.id).post("fields",b.field);c.then(function(a){b.field.id=a.data.id,b.savingField=!1,b.updateFieldsOrder()})}var d=function(){return a.one("flows",b.flow.id).one("steps",b.step.id).one("fields",b.field.id).customPUT(b.field)};b.saveTitle=function(){d(),b.editingLabel=!1},b.saveField=function(){d(),b.popover.options=!1},b.removeField=function(){b.field.remove(),b.field.destroy=!0}}}}]),angular.module("FlowsStepsOrderComponentModule",[]).directive("flowsStepsOrder",["Restangular","$timeout",function(a){return{restrict:"A",link:function(b,c){b.updateFieldsOrder=function(){for(var c=[],d=!1,e=b.flow.steps.length-1;e>=0;e--)"undefined"!=typeof b.flow.steps[e].id&&(c[b.flow.steps[e].position]=b.flow.steps[e].id);for(var e=c.length-1;e>=0;e--)"undefined"==typeof c[e]&&(d=!0);d||a.one("flows",b.flow.id).all("steps").customPUT({ids:c})};var d=function(a){c.find("tbody").each(function(){"undefined"!=typeof $(this).scope().step&&($(this).scope().step.position=$(this).index())}),b.$apply(),a===!0&&b.updateFieldsOrder()};c.sortable({revert:!0,handle:".handle",forcePlaceholderSize:!1,placeholder:{element:function(){return $('<tbody><tr><td colspan="3">Solte para ordenar</td></tr></tbody>')},update:function(){}},start:function(a,b){$(b.helper).addClass("helper"),d()},stop:function(a,b){$(b.item).removeClass("helper"),d(!0)}})}}}]),angular.module("FlowsTriggerComponentModule",[]).directive("flowsTrigger",["Restangular",function(a){return{restrict:"A",link:function(b){b.trigger.isNew===!0&&(b.editing=!0),b.types=[{id:"==",name:"Igual"},{id:"!=",name:"Diferente"},{id:">",name:"Maior"},{id:"<",name:"Menor"},{id:"inc",name:"Entre valores"}],b.removeTrigger=function(){if(b.trigger.isNew!==!0){b.processingForm=!0;var c=a.one("flows",b.$parent.flow.id).one("steps",b.$parent.step.id).one("triggers",b.trigger.id).remove();c.then(function(){b.$parent.triggers.splice(b.$parent.triggers.indexOf(b.trigger),1),b.processingForm=!1})}else b.$parent.triggers.splice(b.$parent.triggers.indexOf(b.trigger),1)},b.newCondition=function(){b.trigger.trigger_conditions.push({field:{},condition_type:"==",values:[]})},b.removeCondition=function(c){if("number"==typeof c.id){b.processingForm=!0;var d=a.one("flows",b.$parent.flow.id).one("steps",b.$parent.step.id).one("triggers",b.trigger.id).one("trigger_conditions",c.id).remove();d.then(function(){b.trigger.trigger_conditions.splice(b.trigger.trigger_conditions.indexOf(c),1),b.processingForm=!1})}else b.trigger.trigger_conditions.splice(b.trigger.trigger_conditions.indexOf(c),1)},b.saveTrigger=function(){b.processingForm=!0;for(var c=[],d=b.trigger.trigger_conditions.length-1;d>=0;d--){var e={field_id:b.trigger.trigger_conditions[d].field.id,condition_type:b.trigger.trigger_conditions[d].condition_type,values:b.trigger.trigger_conditions[d].values};"undefined"!=typeof b.trigger.trigger_conditions[d].id&&(e.id=b.trigger.trigger_conditions[d].id),c.push(e)}var f,g={title:b.trigger.title,trigger_conditions_attributes:c,action_type:b.trigger.action_type,action_values:b.trigger.action_values,description:b.trigger.description},h=a.one("flows",b.$parent.flow.id).one("steps",b.$parent.step.id);f=b.trigger.isNew===!0?h.post("triggers",g):h.one("triggers",b.trigger.id).customPUT(g),f.then(function(){b.showMessage("ok","O gatilho foi atualizado com sucesso!","success"),b.processingForm=!1})}}}}]),angular.module("FlowsDraggableInputComponentModule",[]).directive("flowsDraggableInput",function(){return{restrict:"A",link:function(a,b){b.draggable({connectToSortable:".droppableInputsArea",revert:"invalid",helper:function(){return $('<div class="customDraggableHelper">'+b.find("p").html()+"</div>")},start:function(a,b){$(b.helper).css("width","auto").css("height","auto")}})}}}),angular.module("SlideComponent",[]).animation(".slide",function(){var a="ng-hide";return{beforeAddClass:function(b,c,d){c===a&&b.slideUp(d)},removeClass:function(b,c,d){c===a&&b.hide().slideDown(d)}}}),angular.module("ReportsDestroyModalControllerModule",["ReportsItemsServiceModule"]).controller("ReportsDestroyModalController",["$scope","Restangular","ReportsItemsService","$modalInstance","report",function(a,b,c,d,e){a.report=e,a.confirm=function(){var b=c.remove(a.report.id);b.then(function(){d.close(),a.showMessage("ok","O Relato "+a.report.protocol+" foi removido com sucesso","success",!0)})},a.close=function(){d.close()}}]),angular.module("ReportsEditStatusModalControllerModule",[]).controller("ReportsEditStatusModalController",["Restangular","$scope","$state","$modalInstance","category","report",function(a,b,c,d,e,f){b.category=e,b.report=angular.copy(f),b.changeStatus=function(a){b.report.status_id=a},b.save=function(){b.processing=!0;var e=0;b.report.privateComment&&(e=1);var g=a.one("reports",b.category.id).one("items",b.report.id).one("update_status").customPUT({status_id:b.report.status_id,comment:b.report.comment,comment_visibility:e});g.then(function(){f.status_id=b.report.status_id,b.processing=!1,d.close(),b.showMessage("ok","O estado do relato foi alterado com sucesso.","success",!0),c.go(c.current,{},{reload:!0})})},b.close=function(){d.close()}}]),angular.module("ReportsEditCategoryModalControllerModule",[]).controller("ReportsEditCategoryModalController",["Restangular","$scope","$modalInstance","category","report","categories","$rootScope","$state",function(a,b,c,d,e,f,g,h){var f=f.data;b.categories=[];for(var i=f.length-1;i>=0;i--)if(b.categories.push(f[i]),0!==f[i].subcategories.length)for(var j=f[i].subcategories.length-1;j>=0;j--)b.categories.push(f[i].subcategories[j]);g.resolvingRequest=!1,b.report=angular.copy(e),b.category=d,b.transfer={toCategory:null,toStatus:null},b.subCategories=function(a){return null==a.parent_id?"Categorias principais":null!==a.parent_id?"Subcategorias":void 0},b.$watch("transfer.toCategory",function(a,c){if(a!==c)for(var d=b.categories.length-1;d>=0;d--){if(b.categories[d].id===parseInt(b.transfer.toCategory))return b.categoryData=b.categories[d];if(0!==b.categories[d].subcategories.length)for(var e=b.categories[d].subcategories.length-1;e>=0;e--)if(b.categories[d].subcategories[e].id===parseInt(b.transfer.toCategory))return b.categoryData=b.categories[d].subcategories[e]}}),b.confirm=function(){c.close(),g.resolvingRequest=!0;var d=a.one("reports",b.category.id).one("items",b.report.id).customPUT({new_category_id:b.transfer.toCategory,new_status_id:b.transfer.toStatus},"change_category");d.then(function(){b.showMessage("ok","A categoria do relato foi alterada com sucesso!","success",!0),h.go(h.current,{},{reload:!0})})},b.close=function(){c.close()}}]),angular.module("ReportsSelectAddressModalControllerModule",["SelectLatLngMapComponent","SearchLatLngMapComponent"]).controller("ReportsSelectAddressModalController",["$scope","$modalInstance","$state","$rootScope","Restangular","category","report",function(a,b,c,d,e,f,g){a.updating=!0,a.category=f,a.latLng=[g.position.latitude,g.position.longitude],a.report={reference:angular.copy(g.reference)},a.close=function(){b.close()},a.save=function(){b.close(),d.resolvingRequest=!0;var f={latitude:a.latLng[0],longitude:a.latLng[1],address:a.formattedAddress,reference:a.report.reference},h=e.one("reports",g.category.id).one("items",g.id).customPUT(f);h.then(function(){a.showMessage("ok","O endereço do relato foi alterado com sucesso.","success",!0),c.go(c.current,{},{reload:!0})})}}]),angular.module("ReportsForwardModalControllerModule",[]).controller("ReportsForwardModalController",["Restangular","$rootScope","$scope","$state","$modalInstance","category","report","groupsResponse",function(a,b,c,d,e,f,g,h){b.resolvingRequest=!1,c.category=f,c.report=angular.copy(g),c.groups=h.data,c.filterByIds=function(a){return~f.solver_groups_ids.indexOf(a.id)?!0:!1},c.save=function(){c.processing=!0;var b=a.one("reports",c.category.id).one("items",c.report.id).one("forward").customPUT({group_id:c.report.group_id,comment:c.report.comment});b.then(function(){c.processing=!1,e.close(),c.showMessage("ok","O grupo responsável foi alterado com sucesso.","success",!0),d.go(d.current,{},{reload:!0})})},c.close=function(){e.close()}}]),angular.module("AdvancedFiltersAreaModalControllerModule",["AreaMapComponentModule","AddAreaCircleFormComponentModule","ReplaceDotWithCommaHelperModule"]).controller("AdvancedFiltersAreaModalController",["$scope","$modalInstance","activeAdvancedFilters",function(a,b,c){a.activeAdvancedFilters=c,a.save=function(){for(var c=a.circles.length-1;c>=0;c--){var d={title:"Perímetro",type:"area",desc:a.circles[c].get("distance").toFixed(2).replace(".",",")+"km de "+a.circles[c].get("position").lat().toFixed(4)+", "+a.circles[c].get("position").lng().toFixed(4),value:{latitude:a.circles[c].get("position").lat(),longitude:a.circles[c].get("position").lng(),distance:1e3*a.circles[c].get("distance")}};a.activeAdvancedFilters.push(d)}b.close()},a.close=function(){b.close()}}]),angular.module("AdvancedFiltersAuthorModalControllerModule",["FocusOnEventComponentModule"]).controller("AdvancedFiltersAuthorModalController",["Restangular","$scope","$modalInstance","activeAdvancedFilters",function(a,b,c,d){b.activeAdvancedFilters=d,b.users=[],b.field={},b.usersAutocomplete={options:{onlySelect:!0,source:function(b,c){var d=a.one("search").all("users").getList({name:b.term});d.then(function(a){c($.map(a.data,function(a){return{label:a.name,value:a.name,user:{id:a.id,name:a.name}}}))})},messages:{noResults:"",results:function(){}}}},b.usersAutocomplete.events={select:function(a,c){for(var d=!1,e=b.users.length-1;e>=0;e--)b.users[e].id===c.item.user.id&&(d=!0);d||b.users.push(c.item.user)},change:function(){b.field.text="",b.$broadcast("focusField",!0)}},b.removeUser=function(a){b.users.splice(b.users.indexOf(a),1)},b.save=function(){for(var a=b.users.length-1;a>=0;a--){var d={title:"Usuário",type:"authors",desc:b.users[a].name,value:b.users[a].id};b.activeAdvancedFilters.push(d)}c.close()},b.close=function(){c.close()}}]),angular.module("AdvancedFiltersCategoryModalControllerModule",[]).controller("AdvancedFiltersCategoryModalController",["$scope","$rootScope","$modalInstance","activeAdvancedFilters","categoriesResponse",function(a,b,c,d,e){b.resolvingRequest=!1,a.categories=[],a.activeAdvancedFilters=d;for(var f=[],g="undefined"!=typeof e.data?e.data:e,h=g.length-1;h>=0;h--)if(a.categories.push(g[h]),"undefined"!=typeof g[h].subcategories&&0!==g[h].subcategories.length)for(var i=g[h].subcategories.length-1;i>=0;i--)a.categories.push(g[h].subcategories[i]);a.categories=_.uniq(a.categories),_.each(a.activeAdvancedFilters,function(a){"categories"==a.type&&-1===f.indexOf(a.value)&&f.push(a.value)}),a.isActive=function(a){return-1!==f.indexOf(a.id)},a.updateCategory=function(a){var b=f.indexOf(a.id);-1===b?f.push(a.id):f.splice(b,1)},a.save=function(){_.each(f,function(b){var c=_.where(a.categories,{id:b})[0];if(!_.any(a.activeAdvancedFilters,function(a){return"categories"==a.type&&a.value==c.id})){var d={title:"Categoria",type:"categories",desc:c.title,value:c.id};a.activeAdvancedFilters.push(d)}}),_.each(a.activeAdvancedFilters,function(b,c){b&&"categories"==b.type&&-1===f.indexOf(b.value)&&a.activeAdvancedFilters.splice(c,1)}),c.close()},a.close=function(){c.close()}}]),angular.module("AdvancedFiltersFieldsModalControllerModule",["FieldsFilterItemComponentModule"]).controller("AdvancedFiltersFieldsModalController",["$scope","$rootScope","$modalInstance","activeAdvancedFilters","categoriesResponse",function(a,b,c,d,e){b.resolvingRequest=!1,a.categories=e.data,a.activeAdvancedFilters=d,a.items=[],a.methods=[{condition:"greater_than",canSelectMultiple:!1,text:"Maior que",availableKinds:["text","integer","decimal","meters","centimeters","kilometers","years","months","days","hours","seconds","angle"]},{condition:"lesser_than",canSelectMultiple:!1,text:"Menor que",availableKinds:["text","integer","decimal","meters","centimeters","kilometers","years","months","days","hours","seconds","angle"]},{condition:"equal_to",canSelectMultiple:!1,text:"Igual a",availableKinds:["text","integer","decimal","checkbox","radio","select","meters","centimeters","kilometers","years","months","days","hours","seconds","angle","date","time","cpf","cnpj","url","email"]},{condition:"different",canSelectMultiple:!1,text:"Diferente de",availableKinds:["text","integer","decimal","checkbox","radio","select","meters","centimeters","kilometers","years","months","days","hours","seconds","angle","date","time","cpf","cnpj","url","email"]},{condition:"like",canSelectMultiple:!1,text:"Parecido com",availableKinds:["text","integer","decimal","meters","centimeters","kilometers","years","months","days","hours","seconds","angle","date","time","cpf","cnpj","url","email"]},{condition:"includes",canSelectMultiple:!0,text:"Inclui",availableKinds:["checkbox","radio","select"]},{condition:"excludes",canSelectMultiple:!0,text:"Não inclui",availableKinds:["checkbox","radio","select"]}],a.newField={category:null,condition:null,field:null,value:null},a.selectCategory=function(b){a.newField.category=b,a.newField.condition=null,a.newField.field=null,a.newField.value=null,a.newField.fieldId=null},a.selectCondition=function(b){a.newField.condition=b},a.$watch("newField.fieldId",function(){if(null!==a.newField.category&&null!==a.newField.fieldId)for(var b=a.newField.category.sections.length-1;b>=0;b--)for(var c=a.newField.category.sections[b],d=c.fields.length-1;d>=0;d--)c.fields[d].id==a.newField.fieldId&&(a.newField.field=c.fields[d],a.selectCondition(null))}),a.selectField=function(b){a.newField.field=b},a.addItem=function(){a.items.push(angular.copy(a.newField)),a.newField.condition=null,a.newField.field=null,a.newField.value=null,a.newField.fieldId=null},a.save=function(){for(var b=a.items.length-1;b>=0;b--){var d={title:"Campo",type:"fields",desc:a.items[b].field.label+": "+a.items[b].condition.text+" "+a.items[b].value,value:{id:a.items[b].field.id,condition:a.items[b].condition.condition,value:a.items[b].value}};a.activeAdvancedFilters.push(d)}c.close()},a.close=function(){c.close()}}]),angular.module("AdvancedFiltersPeriodModalControllerModule",[]).controller("AdvancedFiltersPeriodModalController",["$scope","$modalInstance","activeAdvancedFilters",function(a,b,c){a.activeAdvancedFilters=c,a.period={beginDate:new Date,endDate:new Date,tab:"between"},a.save=function(){if("between"===a.period.tab||"from"===a.period.tab){var c={title:"A partir da data",type:"beginDate",desc:a.period.beginDate.getDate()+"/"+(a.period.beginDate.getMonth()+1)+"/"+a.period.beginDate.getFullYear(),value:moment(a.period.beginDate).startOf("day").format()};a.activeAdvancedFilters.push(c)}if("between"===a.period.tab||"to"===a.period.tab){var d={title:"Até a data",type:"endDate",desc:a.period.endDate.getDate()+"/"+(a.period.endDate.getMonth()+1)+"/"+a.period.endDate.getFullYear(),value:moment(a.period.endDate).endOf("day").format()};a.activeAdvancedFilters.push(d)}b.close()},a.close=function(){b.close()}}]),angular.module("AdvancedFiltersQueryModalControllerModule",[]).controller("AdvancedFiltersQueryModalController",["$scope","$modalInstance","activeAdvancedFilters",function(a,b,c){a.input={},a.save=function(){var d={title:"Título ou endereço",desc:a.input.query,type:"query",value:a.input.query};c.push(d),b.close()},a.close=function(){b.close()}}]),angular.module("AdvancedFiltersShareModalControllerModule",["CopyTextComponentModule"]).controller("AdvancedFiltersShareModalController",["$scope","$modalInstance","$q","url",function(a,b,c,d){a.url=d,a.close=function(){b.close()}}]),angular.module("AdvancedFiltersStatusModalControllerModule",["SlideComponent"]).controller("AdvancedFiltersStatusModalController",["$scope","$rootScope","$modalInstance","activeAdvancedFilters","categoriesResponse",function(a,b,c,d,e){b.resolvingRequest=!1;var f="undefined"!=typeof e.data?e.data:e;a.statuses=[];for(var g=function(b){for(var c=b.statuses.length-1;c>=0;c--){for(var d=!1,e=a.statuses.length-1;e>=0;e--)a.statuses[e].id===b.statuses[c].id&&(d=!0);d||a.statuses.push(b.statuses[c])}},h=f.length-1;h>=0;h--)if(g(f[h]),"undefined"!=typeof f[h].subcategories&&0!==f[h].subcategories.length)for(var i=f[h].subcategories.length-1;i>=0;i--)g(f[h].subcategories[i]);a.categories=[],a.search={};for(var h=f.length-1;h>=0;h--)if(a.categories.push(f[h]),
"undefined"!=typeof f[h].subcategories&&0!==f[h].subcategories.length)for(var i=f[h].subcategories.length-1;i>=0;i--)a.categories.push(f[h].subcategories[i]);a.categories=_.uniq(a.categories),a.updateStatus=function(a){a.selected="undefined"==typeof a.selected||a.selected===!1?!0:!1},a.save=function(){for(var b={},e=[],f=a.categories.length-1;f>=0;f--)for(var g=a.categories[f].statuses.length-1;g>=0;g--)a.categories[f].statuses[g].selected===!0&&(b[a.categories[f].statuses[g].id]=a.categories[f].statuses[g],-1===e.indexOf(a.categories[f])&&e.push(a.categories[f])),a.categories[f].statuses[g].selected=!1;for(var h in b){var i={title:"Estado",type:"statuses",desc:b[h].title,value:b[h].id};d.push(i)}for(var f=e.length-1;f>=0;f--){var i={title:"Categoria",type:"categories",desc:e[f].title,value:e[f].id};d.push(i)}c.close()},a.close=function(){c.close()}}]),angular.module("ReportsCategoriesManageStatusesModalControllerModule",["ReportStatusComponentModule"]).controller("ReportsCategoriesManageStatusesModalController",["$scope","$modalInstance","category","updating","categoryId","Restangular",function(a,b,c,d,e,f){a.category=c,a.newStatus={},a.updating=d,a.categoryId=e,a.updateStatuses={},a.createStatus=function(){if(""!==a.newStatus.title){var b={title:a.newStatus.title,color:"#FFFFFF",initial:"false","final":"false",active:"true","private":"false"};if(d){var c=f.one("reports").one("categories",e).post("statuses",b);c.then(function(b){a.category.statuses.push(f.stripRestangular(b.data)),a.newStatus.title=""})}else a.category.statuses.push(b),a.newStatus.title=""}},a.changeInitial=function(b){for(var c=a.category.statuses.length-1;c>=0;c--)b!==a.category.statuses[c]&&(a.category.statuses[c].initial=!1);b.initial=!0},a.removeStatus=function(b){if("undefined"!=typeof b.id){var c=f.one("reports").one("categories",e).one("statuses",b.id).remove();c.then(function(){a.category.statuses.splice(a.category.statuses.indexOf(b),1)})}else a.category.statuses.splice(a.category.statuses.indexOf(b),1)},a.close=function(){if(d)for(var c in a.updateStatuses){var g=angular.copy(a.updateStatuses[c]);g.initial=g.initial.toString(),g["final"]=g["final"].toString(),g.active=g.active.toString(),g["private"]=g["private"].toString();var h=f.one("reports").one("categories",e).one("statuses",g.id).customPUT(g);h.then(function(){})}b.close()}}]),angular.module("ReportsCategoriesDestroyModalControllerModule",[]).controller("ReportsCategoriesDestroyModalController",["$scope","$modalInstance","Restangular","destroyCategory","category",function(a,b,c,d,e){a.category=e,a.confirm=function(){var e=c.one("reports").one("categories",a.category.id).remove();e.then(function(){b.close(),a.showMessage("ok","A categoria de relato foi removida com sucesso","success",!0),d(a.category)})},a.close=function(){b.close()}}]),angular.module("ItemsDestroyModalControllerModule",["InventoriesItemsServiceModule"]).controller("ItemsDestroyModalController",["$scope","Restangular","InventoriesItemsService","$modalInstance","item","category",function(a,b,c,d,e,f){a.item=e,a.confirm=function(){var b=c.remove(a.item.id,f.id);b.then(function(){d.close(),a.showMessage("ok","O item de inventário "+a.item.title+" foi removido com sucesso","success",!0)})},a.close=function(){d.close()}}]),angular.module("ItemsRestoreModalControllerModule",[]).controller("ItemsRestoreModalController",["$scope","$modalInstance","setItemData","clearData",function(a,b,c,d){a.restore=function(){c(),b.close()},a.close=function(){d(),b.close()}}]),angular.module("ItemsSelectAddressModalControllerModule",["SelectLatLngMapComponent","SearchLatLngMapComponent"]).controller("ItemsSelectAddressModalController",["$scope","$modalInstance","category","updating","itemData","locationFieldsIds",function(a,b,c,d,e,f){a.updating=d,a.category=c,a.latLng=[e[f[0]],e[f[1]]],a.close=function(){b.close()},a.save=function(){if(e[f[0]]=a.latLng[0],e[f[1]]=a.latLng[1],e[f[2]]=null,e[f[3]]=null,e[f[4]]=null,e[f[5]]=null,e[f[6]]=null,a.addressComponents)for(var c=a.addressComponents.length-1;c>=0;c--)"route"===a.addressComponents[c].types[0]&&(e[f[2]]=null!==e[f[2]]?a.addressComponents[c].long_name+", "+e[f[2]]:a.addressComponents[c].long_name),"street_number"===a.addressComponents[c].types[0]&&(e[f[2]]=null!==e[f[2]]?e[f[2]]+", "+a.addressComponents[c].long_name:a.addressComponents[c].long_name),"neighborhood"===a.addressComponents[c].types[0]&&(e[f[4]]=a.addressComponents[c].long_name),"locality"===a.addressComponents[c].types[0]&&(e[f[5]]=a.addressComponents[c].long_name),"administrative_area_level_1"===a.addressComponents[c].types[0]&&(e[f[6]]=a.addressComponents[c].long_name),("postal_code"===a.addressComponents[c].types[0]||"postal_code_prefix"===a.addressComponents[c].types[0])&&(e[f[3]]=a.addressComponents[c].long_name);b.close()}}]),angular.module("FieldHistoryModalControllerModule",[]).controller("FieldHistoryModalController",["$rootScope","$scope","$modalInstance","Restangular","itemHistoryResponse","itemId","field",function(a,b,c,d,e,f,g){var h=function(a){for(var b=[],c=0;c<a.length;c++){var d={},e=a[c];d.user=e.user,d.created_at=e.created_at,d.changes=_.filter(e.fields_changes,function(a){return a.field.id==g.id})[0],b.push(d)}return b};b.historyLogs=h(e.data),b.field=g,a.resolvingRequest=!1,b.isArray=_.isArray,b.refreshHistory=function(){var a={object_id:g.id};b.historyFilterBeginDate&&(a["created_at[begin]"]=b.historyFilterBeginDate),b.historyFilterEndDate&&(a["created_at[end]"]=b.historyFilterEndDate),b.loadingHistoryLogs=!0;var c=d.one("inventory").one("items",f).one("history").getList(null,a);c.then(function(a){b.historyLogs=h(a.data),b.loadingHistoryLogs=!1})},b.availableHistoryDateFilters=[{name:"Hoje",beginDate:moment().startOf("day").format(),endDate:moment().endOf("day").format(),selected:!1},{name:"Ontem",beginDate:moment().subtract(1,"days").startOf("day").format(),endDate:moment().subtract(1,"days").endOf("day").format(),selected:!1},{name:"Este mês",beginDate:moment().startOf("month").format(),endDate:moment().endOf("day").format(),selected:!1},{name:"Mês passado",beginDate:moment().subtract(1,"months").startOf("month").format(),endDate:moment().subtract(1,"months").subtract(1,"days").endOf("day").format(),selected:!1},{name:"Todos",beginDate:null,endDate:null,selected:!0}],b.showCustomDateFields=function(){_.each(b.availableHistoryDateFilters,function(a){a.selected=!1}),b.showCustomDateHelper=!0},b.selectDateFilter=function(a){_.each(b.availableHistoryDateFilters,function(a){a.selected=!1}),a.selected=!a.selected,b.historyFilterBeginDate=a.beginDate,b.historyFilterEndDate=a.endDate,b.showCustomDateHelper=!1,b.refreshHistory()},b.close=function(){c.close()}}]),angular.module("ItemsCategoriesDestroyModalControllerModule",[]).controller("ItemsCategoriesDestroyModalController",["Restangular","$scope","$modalInstance","inventoriesCategoriesList","category","$cookies",function(a,b,c,d,e,f){b.category=e,b.confirm=function(){var e=a.one("inventory").one("categories",b.category.id).remove();e.then(function(){delete f.inventoryFiltersHash,c.close(),d.splice(d.indexOf(b.category),1)})},b.close=function(){c.close()}}]),angular.module("ItemsCategoriesEditOptionsModalControllerModule",["NgThumbComponentModule"]).controller("ItemsCategoriesEditOptionsModalController",["$scope","$modalInstance","category","uploaderQueue","FileUploader",function(a,b,c,d,e){a.category=c,a.uploaderQueue=d,a.icon=c.original_icon;var f=a.uploader=new e;f.filters.push({name:"onlyImages",fn:function(a){var b=f.isHTML5?a.type:"/"+a.value.slice(a.value.lastIndexOf(".")+1);return b="|"+b.toLowerCase().slice(b.lastIndexOf("/")+1)+"|",-1!=="|jpg|png|jpeg|bmp|gif|".indexOf(b)}}),f.onAfterAddingFile=function(){a.$apply(function(){a.uploaderQueue.items=f.queue})},a.close=function(){b.close()}}]),angular.module("ItemsCategoriesEditFieldValuesModalControllerModule",["InventorySingleValueComponentModule"]).controller("ItemsCategoriesEditFieldValuesModalController",["$scope","$modalInstance","field","Restangular","setFieldOptions",function(a,b,c,d,e){a.field=angular.copy(c),a.value={importing:!1},a.isExistingField="undefined"!=typeof a.field.id&&a.field.id,null===a.field.field_options&&(a.field.field_options=[]),a.toggleImport=function(){a.value.importing=a.value.importing===!0?!1:!0};var f=function(b){var c=_.findWhere(a.field.field_options,{value:b});return _.isUndefined(c)?!1:!0},g=function(a){return d.all("inventory").one("fields",c.id).post("options",a)};a.newValue=function(){if(!a.loadingValue){if(a.loadingValue=!0,a.showErrors=!1,a.errors=[],a.value.importing===!0&&(!a.value.multipleOptionsText||0===a.value.multipleOptionsText.length))return a.errors.push("Você precisa de pelo menos um item para importar valores;"),a.showErrors=!0,void(a.loadingValue=!1);if(a.value.importing===!1&&(!a.value.text||0===a.value.text.length))return a.errors.push("O nome da opção não pode ficar em branco;"),a.showErrors=!0,void(a.loadingValue=!1);if(a.value.importing===!0){for(var b=a.value.multipleOptionsText.split(/\n/),c=[],d=b.length-1;d>=0;d--)f(b[d])&&a.errors.push("A opção "+b[d]+" já existe;"),c.push(b[d]);if(0!==a.errors.length)return a.showErrors=!0,void(a.loadingValue=!1);if(a.isExistingField)g({value:c}).then(function(b){a.loadingValue=!1,a.field.field_options.concat(b.data),e(a.field.field_options)});else{for(var d=c.length-1;d>=0;d--)a.field.field_options.push({value:c[d],disabled:!1});a.loadingValue=!1,e(a.field.field_options)}}else{if(f(a.value.text))return a.errors.push("A opção "+a.value.text+" já existe;"),a.showErrors=!0,void(a.loadingValue=!1);var h={value:a.value.text,disabled:!1};a.isExistingField?g(h).then(function(b){a.loadingValue=!1,a.field.field_options.push(b.data),e(a.field.field_options)}):(a.field.field_options.push(h),a.loadingValue=!1,e(a.field.field_options))}a.value.multipleOptionsText=null,a.value.text=null}},a.clear=function(){a.field.field_options=[],e([])},a.close=function(){b.close()},a.save=function(){e(a.field.field_options),b.close()}}]),angular.module("ItemsCategoriesNewStatusModalControllerModule",[]).controller("ItemsCategoriesNewStatusModalController",["$scope","Restangular","$modalInstance","statuses","updating","categoryId",function(a,b,c,d,e,f){a.status={color:"#2FB4E6"},a.save=function(){if(e){var g=b.one("inventory").one("categories",f).post("statuses",{title:a.status.title,color:a.status.color});g.then(function(a){d.push(b.stripRestangular(a.data)),c.close()})}else d.push({title:a.status.title,color:a.status.color}),c.close()},a.close=function(){c.close()}}]),angular.module("ItemsCategoriesEditStatusModalControllerModule",[]).controller("ItemsCategoriesEditStatusModalController",["$scope","Restangular","$modalInstance","status","updating","categoryId",function(a,b,c,d,e,f){a.status=angular.copy(d),a.save=function(){if(e){var g=b.one("inventory").one("categories",f).one("statuses",d.id).customPUT(a.status);g.then(function(){d.title=a.status.title,d.color=a.status.color,c.close()})}else d.title=a.status.title,d.color=a.status.color,c.close()},a.close=function(){c.close()}}]),angular.module("UsersDestroyModalControllerModule",[]).controller("UsersDestroyModalController",["Restangular","$scope","$modalInstance","user","usersList",function(a,b,c,d,e){b.user=d,b.confirm=function(){e.splice(e.indexOf(b.user),1)},b.confirm=function(){var d=a.one("users",b.user.id).remove();d.then(function(){c.close(),b.showMessage("ok","O Usuário "+b.user.name+" foi removido com sucesso.","success",!0),e.splice(e.indexOf(b.user),1)})},b.close=function(){c.close()}}]),angular.module("GalleryModalControllerModule",["panzoom","panzoomwidget","GalleryImageOnLoadComponentModule"]).controller("GalleryModalController",["$scope","$modalInstance","$window","image",function(a,b,c,d){a.loading=!0,a.image=d,"undefined"==typeof d.url&&(a.image.url=d.versions.original),a.$watch("imageDimensions",function(b,d){b!==d&&(a.panzoomConfig={zoomLevels:12,neutralZoomLevel:5,scalePerZoomLevel:1.5,initialPanX:$(c).width()/2-a.imageDimensions.width/2,initialPanY:$(c).height()/2-a.imageDimensions.height/2})}),a.panzoomModel={},a.close=function(){b.close()}}]),angular.module("ReportsSelectUserModalControllerModule",[]).controller("ReportsSelectUserModalController",["Restangular","$scope","$modalInstance","$q","setUser","filterByGroup",function(a,b,c,d,e,f){b.loadingPagination=!1,f&&(b.resultsFiltered=!0),b.sort={column:"",descending:!1},b.changeSorting=function(a){var c=b.sort;c.column===a?c.descending=!c.descending:(c.column=a,c.descending=!1)},b.selectedCls=function(a){return a===b.sort.column&&"sort-"+b.sort.descending},b.setUser=function(a){e(a),c.close()};var g,h=1,i=30,j="",k=function(){if(b.groupId)return""!==j?a.one("search").one("groups",b.groupId).all("users").getList({name:j,email:j,page:h,per_page:i}):a.one("groups",b.groupId).all("users").getList({page:h,per_page:i});if(b.groupId=null,""!==j){var c={name:j,email:j,page:h,per_page:i};return f&&(c.groups=f),a.one("search").all("users").getList(c)}var c={page:h,per_page:i};return f&&(c.groups=f),a.all("users").getList(c)},l=a.all("groups").getList(),m=b.getData=function(a){if(b.loadingPagination===!1){b.loadingPagination=!0;var c=k();return d.all([c,l]).then(function(c){if(b.groups=c[1].data,a!==!0)b.users=c[0].data;else{"undefined"==typeof b.users&&(b.users=[]);for(var d=0;d<c[0].data.length;d++)b.users.push(c[0].data[d]);h++}g=parseInt(c[0].headers().total);var e=Math.ceil(g/i);b.loadingPagination=h===e+1?null:!1}),c}};b.search=function(a){j=a,h=1,b.loadingPagination=!1,b.loadingContent=!0,m().then(function(){b.loadingContent=!1,h++})},b.selectGroup=function(a){b.groupId=a,h=1,b.loadingPagination=!1,b.loadingContent=!0,m().then(function(){b.loadingContent=!1,h++})},b.close=function(){c.close()}}]),angular.module("ReportsCreateUserModalControllerModule",["ngCpfCnpj"]).controller("ReportsCreateUserModalController",["Restangular","$scope","$modalInstance","$q","setUser",function(a,b,c,d,e){b.user={},b.inputErrors=null,b.create=function(){b.inputErrors=null,b.processingForm=!0;var d=a.one("users").withHttpConfig({treatingErrors:!0}).post(null,b.user);d.then(function(d){e(a.stripRestangular(d.data)),c.close(),b.processingForm=!1},function(a){b.inputErrors=a.data.error,b.processingForm=!1})},b.close=function(){c.close()}}]),angular.module("ReportsEditDescriptionModalControllerModule",[]).controller("ReportsEditDescriptionModalController",["Restangular","$scope","$modalInstance","report",function(a,b,c,d){b.report=angular.copy(d),b.save=function(){b.processingForm=!0;var e=a.one("reports",d.category.id).one("items",d.id).customPUT({description:b.report.description});e.then(function(){c.close(),b.processingForm=!1,d.description=b.report.description},function(){b.processingForm=!1})},b.close=function(){c.close()}}]),angular.module("ErrorModalControllerModule",[]).controller("ErrorModalController",["$scope","$modalInstance","response","Raven",function(a,b,c,d){a.response=c,d.captureMessage(JSON.stringify(c)),a.ok=function(){b.close()}}]),angular.module("FlowsAddModalControllerModule",[]).controller("FlowsAddModalController",["$scope","$modalInstance","Restangular","flows",function(a,b,c,d){a.flow={},a.save=function(){var e=c.all("flows").post(a.flow);e.then(function(a){d.push(c.stripRestangular(a.data)),b.close()})},a.close=function(){b.close()}}]),angular.module("FlowsEditModalControllerModule",["FlowsResolutionStateComponentModule"]).controller("FlowsEditModalController",["$scope","$modalInstance","Restangular","flows","flow",function(a,b,c,d,e){a.flow=angular.copy(e),a.newResolutionState={"default":!1},a.createResolutionState=function(){var b=c.one("flows",e.id).post("resolution_states",a.newResolutionState);b.then(function(b){a.flow.resolution_states.push(c.stripRestangular(b.data))})},a.save=function(){var f=c.one("flows",e.id).customPUT(a.flow);f.then(function(){d&&(d[d.indexOf(e)]=a.flow),b.close()})},a.close=function(){b.close()}}]),angular.module("FlowsDestroyModalControllerModule",[]).controller("FlowsDestroyModalController",["$scope","$modalInstance","Restangular","flow","flows",function(a,b,c,d,e){a.flow=d,a.confirm=function(){var f=c.one("flows",d.id).remove();f.then(function(){b.close(),e.splice(e.indexOf(a.flow),1)})},a.close=function(){b.close()}}]),angular.module("FlowsStepsAddModalControllerModule",[]).controller("FlowsStepsAddModalController",["$scope","$modalInstance","$q","Restangular","flow",function(a,b,c,d,e){a.flow={stepType:"form"},a.selectedFlow=null,a.selectFlow=function(b){a.selectedFlow=b};var f=d.one("flows",e.id).all("ancestors").getList(),g=d.all("flows").getList({display_type:"full"});c.all([g,f]).then(function(b){a.flows=b[0].data;for(var c=b[1].data,d=a.flows.length-1;d>=0;d--)-1!==c.indexOf(a.flows[d].id)&&(a.flows[d].hidden=!0)}),a.save=function(){var c;c="form"===a.flow.stepType?{title:a.flow.title,step_type:"form"}:{title:a.selectedFlow.title,step_type:"flow",child_flow_id:a.selectedFlow.id};var f=d.one("flows",e.id).post("steps",c);f.then(function(a){e.steps.push(d.stripRestangular(a.data)),b.close()})},a.close=function(){b.close()}}]),angular.module("FlowsStepsDestroyModalControllerModule",[]).controller("FlowsStepsDestroyModalController",["$scope","$modalInstance","Restangular","step","flow",function(a,b,c,d,e){a.step=d,a.confirm=function(){var f=c.one("flows",e.id).one("steps",d.id).remove();f.then(function(){b.close(),e.steps.splice(e.steps.indexOf(a.step),1)})},a.close=function(){b.close()}}]),angular.module("FlowsStepsEditModalControllerModule",[]).controller("FlowsStepsEditModalController",["$scope","$modalInstance","Restangular","step","flow",function(a,b,c,d,e){a.step=angular.copy(d),a.save=function(){var f=c.one("flows",e.id).one("steps",d.id).customPUT({title:a.step.title});f.then(function(){d.title=a.step.title,b.close()})},a.close=function(){b.close()}}]),angular.module("GroupsEditModalControllerModule",[]).controller("GroupsEditModalController",["Restangular","$scope","$modalInstance","$state","group",function(a,b,c,d,e){b.group=angular.copy(e)||{name:"",permissions:{}},b.save=function(){b.processingForm=!0;var f=null===e?a.one("groups").post(null,b.group):a.one("groups",e.id).customPUT({name:b.group.name});f.then(function(a){b.processingForm=!1,e?(b.showMessage("ok","O grupo foi editado.","success",!0),e.name=b.group.name):(b.showMessage("ok","O grupo foi criado com sucesso.","success",!0),d.go("groups.show",{id:a.data.id})),c.close()},function(){b.processingForm=!1})},b.close=function(){c.close()}}]),angular.module("GroupsAddUsersModalControllerModule",[]).controller("GroupsAddUsersModalController",["Restangular","$scope","$modalInstance","$q","$state","group",function(a,b,c,d,e,f){b.loadingPagination=!1,b.sort={column:"",descending:!1},b.changeSorting=function(a){var c=b.sort;c.column===a?c.descending=!c.descending:(c.column=a,c.descending=!1)},b.selectedCls=function(a){return a===b.sort.column&&"sort-"+b.sort.descending};var g,h=1,i=30,j="",k=function(){return b.groupId?""!==j?a.one("search").one("groups",b.groupId).all("users").getList({name:j,email:j,page:h,per_page:i}):a.one("groups",b.groupId).all("users").getList({page:h,per_page:i}):(b.groupId=null,""!==j?a.one("search").all("users").getList({name:j,email:j,page:h,per_page:i}):a.all("users").getList({page:h,per_page:i}))},l=a.all("groups").getList(),m=b.getData=function(a){if(b.loadingPagination===!1){b.loadingPagination=!0;var c=k();return d.all([c,l]).then(function(c){if(b.groups=c[1].data,a!==!0)b.users=c[0].data;else{"undefined"==typeof b.users&&(b.users=[]);for(var d=0;d<c[0].data.length;d++)b.users.push(c[0].data[d]);h++}g=parseInt(c[0].headers().total);var e=Math.ceil(g/i);b.loadingPagination=h===e+1?null:!1}),c}};b.search=function(a){j=a,h=1,b.loadingPagination=!1,b.loadingContent=!0,m().then(function(){b.loadingContent=!1,h++})},b.selectGroup=function(a){b.groupId=a,h=1,b.loadingPagination=!1,b.loadingContent=!0,m().then(function(){b.loadingContent=!1,h++})},b.usersToAdd=[],b.isUserSelected=function(a){return-1!==b.usersToAdd.indexOf(a)},b.addUser=function(a){b.usersToAdd.push(a)},b.removeUser=function(a){b.usersToAdd.splice(b.usersToAdd.indexOf(a),1)},b.addUsers=function(){var d=a.one("groups",f.id).customPUT({users:b.usersToAdd});d.then(function(){b.showMessage("ok","Os usuários foram adicionados.","success",!0),e.go(e.current,{},{reload:!0}),c.close()})},b.close=function(){c.close()}}]),angular.module("GroupsRemoveUserModalControllerModule",[]).controller("GroupsRemoveUserModalController",["$scope","$modalInstance","removeUserFromList","user","group","Restangular",function(a,b,c,d,e,f){a.user=d,a.group=e,a.confirm=function(){var g=f.one("groups",e.id).all("users").remove({user_id:d.id});g.then(function(){b.close(),a.showMessage("ok","O Usuário "+a.user.name+" foi removido do grupo com sucesso","success",!0),c(a.user)})},a.close=function(){b.close()}}]),angular.module("UserPasswordRecoverModalControllerModule",[]).controller("UserPasswordRecoveryModalController",["Restangular","$scope","$modalInstance",function(a,b,c){b.user={email:null},b.confirm=function(){b.processingForm=!0;var c=a.one("recover_password").customPUT({email:b.user.email});c.then(function(){b.success=!0})},b.close=function(){c.close()}}]),angular.module("FormatErrorsHelperModule",[]).filter("formatErrors",["$sce","$filter",function(a,b){return function(c){var d=[];for(var e in c)for(var f=0;f<c[e].length;f++){var g=b("translateErrors")(e),h=g.charAt(0).toUpperCase()+g.slice(1);d.push(h+" "+b("translateErrors")(c[e][f]))}return a.trustAsHtml(d.join("<br>"))}}]),angular.module("ReplaceDotWithCommaHelperModule",[]).filter("replaceDotWithComma",function(){return function(a){return"undefined"!=typeof a?a.replace(".",","):void 0}}),angular.module("TranslateErrorsHelperModule",[]).filter("translateErrors",function(){return function(a){var b={"is missing":"não pode estar em branco",statuses:"status de relatos",title:"título",icon:"ícone",marker:"marcador",color:"Cor"};return"undefined"!=typeof b[a]?b[a]:a}}),angular.module("DiacriticsInsensitiveFilterHelperModule",[]).filter("diacriticsInsensitiveFilter",["$filter",function(){return function(a,b){function c(a){return _.isUndefined(a)?void 0:a.replace(/([àáâãäå])|([ç])|([èéêë])|([ìíîï])|([ñ])|([òóôõöø])|([ß])|([ùúûü])|([ÿ])|([æ])/g,function(a,b,c,d,e,f,g,h,i,j,k){return b?"a":c?"c":d?"e":e?"i":f?"n":g?"o":h?"s":i?"u":j?"y":k?"ae":void 0})}console.log("start");for(var d=0;d<a.length;d++)console.log(c(a[d]),b);return!1}}]);